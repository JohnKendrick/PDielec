<!doctype html>
<html class="no-js" lang="en" data-content_root="../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>PDielec.Utilities - PDielec: John Kendrick &amp; Andrew Burnett</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=2e0a580d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">PDielec: John Kendrick & Andrew Burnett</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">PDielec: John Kendrick & Andrew Burnett</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pdgui.html">PDGui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software.html">Other Software Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../theory_powder.html">Theory for Light Scattering from Powders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory_single_crystal.html">Theory for Single Crystal Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis.html">Phonon Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../application_notes_1.html">Applications of Effective Medium Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application_notes_2.html">Single Crystal Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../autoapi/PDielec/index.html">PDielec</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of PDielec</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/AbinitOutputReader/index.html">PDielec.AbinitOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Calculator/index.html">PDielec.Calculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/CastepOutputReader/index.html">PDielec.CastepOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Constants/index.html">PDielec.Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/CrystalOutputReader/index.html">PDielec.CrystalOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/DielectricFunction/index.html">PDielec.DielectricFunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/ExperimentOutputReader/index.html">PDielec.ExperimentOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/GTMcore/index.html">PDielec.GTMcore</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../autoapi/PDielec/GUI/index.html">PDielec.GUI</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of PDielec.GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/AnalysisTab/index.html">PDielec.GUI.AnalysisTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/App/index.html">PDielec.GUI.App</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/FitterTab/index.html">PDielec.GUI.FitterTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/MainTab/index.html">PDielec.GUI.MainTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/NoteBook/index.html">PDielec.GUI.NoteBook</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/OpenGLWidget/index.html">PDielec.GUI.OpenGLWidget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/PlottingTab/index.html">PDielec.GUI.PlottingTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/PowderScenarioTab/index.html">PDielec.GUI.PowderScenarioTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/ScenarioTab/index.html">PDielec.GUI.ScenarioTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SettingsTab/index.html">PDielec.GUI.SettingsTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SingleCrystalLayer/index.html">PDielec.GUI.SingleCrystalLayer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SingleCrystalScenarioTab/index.html">PDielec.GUI.SingleCrystalScenarioTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SpreadSheetManager/index.html">PDielec.GUI.SpreadSheetManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/ViewerTab/index.html">PDielec.GUI.ViewerTab</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/GenericOutputReader/index.html">PDielec.GenericOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/GulpOutputReader/index.html">PDielec.GulpOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/HelperRoutines/index.html">PDielec.HelperRoutines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/IO/index.html">PDielec.IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Materials/index.html">PDielec.Materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Mie/index.html">PDielec.Mie</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/PhonopyOutputReader/index.html">PDielec.PhonopyOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Plotter/index.html">PDielec.Plotter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/PrimitiveCell/index.html">PDielec.PrimitiveCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/QEOutputReader/index.html">PDielec.QEOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/SuperCell/index.html">PDielec.SuperCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/UnitCell/index.html">PDielec.UnitCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Utilities/index.html">PDielec.Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/VaspOutputReader/index.html">PDielec.VaspOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/checkcsv/index.html">PDielec.checkcsv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/checkexcel/index.html">PDielec.checkexcel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/graphdatagenerator/index.html">PDielec.graphdatagenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/p1reader/index.html">PDielec.p1reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/p2cif/index.html">PDielec.p2cif</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pdcompare/index.html">PDielec.pdcompare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pdgui/index.html">PDielec.pdgui</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pdmake/index.html">PDielec.pdmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pickled_reader/index.html">PDielec.pickled_reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/preader/index.html">PDielec.preader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/vibanalysis/index.html">PDielec.vibanalysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/PDielec/pdgui/index.html">PDielec.pdgui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/PDielec/preader/index.html">PDielec.preader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/PDielec/pdmake/index.html">PDielec.pdmake</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zreferences.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for PDielec.Utilities</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2024 John Kendrick &amp; Andrew Burnett</span>
<span class="c1">#</span>
<span class="c1"># This file is part of PDielec</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the MIT License</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the MIT License along with this program, if not see https://opensource.org/licenses/MIT</span>
<span class="c1">#</span>
<span class="sd">&quot;&quot;&quot;Utility Functions.</span>

<span class="sd">A set of utility functions that may be used anywhere in the package.</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">os</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.AbinitOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">AbinitOutputReader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.CastepOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">CastepOutputReader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.CrystalOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">CrystalOutputReader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.ExperimentOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">ExperimentOutputReader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.GulpOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">GulpOutputReader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.PhonopyOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">PhonopyOutputReader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.QEOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">QEOutputReader</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.VaspOutputReader</span><span class="w"> </span><span class="kn">import</span> <span class="n">VaspOutputReader</span>


<div class="viewcode-block" id="printsp">
<a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.printsp">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">printsp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">matrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Print 4x4 matrices or 4 vectors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : string</span>
<span class="sd">        The name of the matrix</span>
<span class="sd">    matrix : 4x4 or 4 array</span>
<span class="sd">        The matrix to be printed</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    None</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">+.5f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s2">+.5f</span><span class="si">}</span><span class="s2">&quot;</span> <span class="o">+</span> <span class="s2">&quot;   &quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">return</span></div>


<div class="viewcode-block" id="find_program_from_name">
<a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.find_program_from_name">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">find_program_from_name</span><span class="p">(</span> <span class="n">filename</span> <span class="p">):</span>
    <span class="c1"># Determine the program to use from the file name being used</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Determine the simulation program from a given filename.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The complete path (absolute or relative) to a file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    (str1,str2)</span>
<span class="sd">        A tuple of 2 strings, the first, str1, is the program name that was used to calculate the frequencies.</span>
<span class="sd">        In the case of phonopy, the second string is the QM program that calculates the forces</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function examines the file extension and, in some cases, the presence of specific files in the same directory, to determine the associated simulation program. It recognizes files from several popular materials simulation programs, such as &#39;phonopy&#39;, &#39;gulp&#39;, &#39;vasp&#39;, and others.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    ::</span>

<span class="sd">        program = find_program_from_name(&#39;./data/structure.castep&#39;)</span>
<span class="sd">        print(program)</span>
<span class="sd">        # Output: (&quot;castep&quot;,&quot;&quot;)</span>
<span class="sd">    </span>
<span class="sd">        program = find_program_from_name(&#39;path/to/simulation/OUTCAR&#39;)</span>
<span class="sd">        print(program)</span>
<span class="sd">        # Output: (&quot;phonopy&quot;,&quot;vasp&quot;)</span>
<span class="sd">        # Depends on the presence of &#39;phonopy.yaml&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">head</span><span class="p">,</span><span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">root</span><span class="p">,</span><span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
    <span class="n">head_root</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">root</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;pwscf.xml&quot;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">)):</span>
            <span class="c1"># It is a phonopy calculation because phonopy.yaml is present</span>
            <span class="c1"># It is a quantum espresso calculation because pwscf.xml is present </span>
            <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;quantum espresso&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># It is q-e but not Phonopy</span>
            <span class="k">return</span> <span class="s2">&quot;quantum espresso&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.dynG&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">)):</span>
            <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;quantum espresso&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># It is q-e but not Phonopy</span>
            <span class="k">return</span> <span class="s2">&quot;quantum espresso&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">tail</span> <span class="o">==</span> <span class="s2">&quot;OUTCAR&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;vasp&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;vasp&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;vasprun.xml&quot;</span><span class="p">)):</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;vasp&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;vasp&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.gout&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;gulp&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.born&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;vasp&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s2">&quot;.castep&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;castep&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;castep&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s2">&quot;.out&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head_root</span><span class="o">+</span><span class="s2">&quot;.files&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;abinit&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;abinit&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head_root</span><span class="o">+</span><span class="s2">&quot;.dynG&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;quantum espresso&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;quantum espresso&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;crystal&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;crystal&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s2">&quot;.log&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head_root</span><span class="o">+</span><span class="s2">&quot;.files&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;abinit&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;abinit&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head_root</span><span class="o">+</span><span class="s2">&quot;.dynG&quot;</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
                <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;quantum espresso&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">return</span> <span class="s2">&quot;quantum espresso&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;crystal&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;crystal&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s2">&quot;.abo&quot;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">,</span><span class="s2">&quot;abinit&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s2">&quot;abinit&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s2">&quot;.exp&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;experiment&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s2">&quot;.py&quot;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s2">&quot;pdgui&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span>
    <span class="k">return</span> <span class="s2">&quot;&quot;</span><span class="p">,</span><span class="s2">&quot;&quot;</span></div>


<div class="viewcode-block" id="get_reader">
<a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.get_reader">[docs]</a>
<span class="k">def</span><span class="w"> </span><span class="nf">get_reader</span><span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">program</span><span class="p">,</span> <span class="n">qmprogram</span><span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;Get the appropriate output reader based on the simulation program and, if specified, the quantum mechanical program.</span>

<span class="sd">    This function is designed to create an output reader object for various simulation programs (like CASTEP, VASP, etc.) and, for phonopy simulations, it can additionally create a quantum mechanical output reader based on the specified quantum mechanical program.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The primary filepath or name associated with the output file(s).</span>
<span class="sd">    program : str</span>
<span class="sd">        The name of the simulation program. Supported values are &#39;castep&#39;, &#39;vasp&#39;, &#39;gulp&#39;, &#39;crystal&#39;, &#39;abinit&#39;, &#39;qe&#39;, and &#39;phonopy&#39;.</span>
<span class="sd">    qmprogram : str</span>
<span class="sd">        The name of the quantum mechanical program used in conjunction with phonopy. Supported values are the same as for `program`, but its relevance is exclusive to when `program` is set to &#39;phonopy&#39;.</span>
<span class="sd">    debug : boolean</span>
<span class="sd">        Optional.  If true print debug information.  Default is false</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object</span>
<span class="sd">        An instance of the appropriate output reader class based on the input `program` and, if applicable, `qmprogram`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For phonopy simulations, both phonon and quantum mechanical output files are considered. If the `qmprogram` is not compatible or not specified, the function will exit.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; reader = get_reader(&quot;output.log&quot;, &quot;castep&quot;, &quot;&quot;)</span>
<span class="sd">    &gt;&gt;&gt; reader = get_reader(&quot;output&quot;, &quot;phonopy&quot;, &quot;vasp&quot;)</span>

<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">program</span> <span class="o">=</span> <span class="n">program</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">qmprogram</span> <span class="o">=</span> <span class="n">qmprogram</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">fulldirname</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">head</span><span class="p">,</span><span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fulldirname</span><span class="p">)</span>
    <span class="n">root</span><span class="p">,</span><span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  program = &quot;</span><span class="p">,</span><span class="n">program</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  qmprogram = &quot;</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  fulldirname = &quot;</span><span class="p">,</span><span class="n">fulldirname</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  head = &quot;</span><span class="p">,</span><span class="n">head</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  tail = &quot;</span><span class="p">,</span><span class="n">tail</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  root = &quot;</span><span class="p">,</span><span class="n">root</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  ext = &quot;</span><span class="p">,</span><span class="n">ext</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;castep&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">CastepOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;vasp&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="nb">list</span><span class="p">()</span>
        <span class="n">name1</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="s2">&quot;OUTCAR&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
            <span class="n">name2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;KPOINTS&quot;</span><span class="p">)</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name1</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">VaspOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;gulp&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">GulpOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;crystal&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">CrystalOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;abinit&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">AbinitOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;quantum espresso&quot;</span><span class="p">:</span>
        <span class="n">pwscf_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;pwscf.xml&quot;</span><span class="p">)</span>
        <span class="n">tensors_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;tensors.xml&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ext</span> <span class="ow">in</span> <span class="p">[</span><span class="s2">&quot;.xml&quot;</span><span class="p">,</span><span class="s2">&quot;.dynG&quot;</span><span class="p">]</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">pwscf_name</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">tensors_name</span><span class="p">):</span>
            <span class="c1"># Only handle xml but add the dynG file</span>
            <span class="n">tail3</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s2">&quot;.dynG&quot;</span>               <span class="c1"># The order is important</span>
            <span class="n">name1</span> <span class="o">=</span> <span class="n">pwscf_name</span>
            <span class="n">name2</span> <span class="o">=</span> <span class="n">tensors_name</span>
            <span class="n">name3</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail3</span><span class="p">)</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">,</span> <span class="n">name3</span> <span class="p">]:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># try and read the log file or out file based on the dynG file name</span>
            <span class="n">tail1</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s2">&quot;.log&quot;</span>
            <span class="n">tail2</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s2">&quot;.out&quot;</span>
            <span class="n">tail3</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s2">&quot;.dynG&quot;</span>               <span class="c1"># The order is important</span>
            <span class="n">name1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail1</span><span class="p">)</span>
            <span class="n">name2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail2</span><span class="p">)</span>
            <span class="n">name3</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail3</span><span class="p">)</span>
            <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">,</span> <span class="n">name3</span> <span class="p">]:</span>
                <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">debug</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;get_reader:  names = &quot;</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">QEOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">:</span>
        <span class="c1"># The order is important</span>
        <span class="n">pnames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">pnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;qpoints.yaml&quot;</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">pnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s2">&quot;phonopy.yaml&quot;</span><span class="p">)</span> <span class="p">)</span>
        <span class="c1"># Which QM program was used by PHONOPY?</span>
        <span class="n">qmreader</span> <span class="o">=</span> <span class="n">get_reader</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">debug</span><span class="o">=</span><span class="n">debug</span><span class="p">)</span>
        <span class="c1"># The QM reader is used to get info about the QM calculation</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">PhonopyOutputReader</span><span class="p">(</span><span class="n">pnames</span><span class="p">,</span><span class="n">qmreader</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;experiment&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">ExperimentOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Program name not recognized&quot;</span><span class="p">,</span><span class="n">program</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">reader</span></div>


<div class="viewcode-block" id="Debug">
<a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.Debug">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">Debug</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class aimed at providing a structured way to include debug messages in code.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    print(args, level=0)</span>
<span class="sd">        Prints debug messages based on the debug level provided as argument compared to the object&#39;s debug level.</span>
<span class="sd">    state()</span>
<span class="sd">        Returns the current state (enabled or disabled) of debugging.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `print` method provides a flexible way to include additional information along with the base debug message, allowing for a detailed and adjustable debugging output.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">debug</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize an instance with debug status, text, and optional level.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        debug : bool</span>
<span class="sd">            A boolean indicating whether debugging is enabled.</span>
<span class="sd">        text : str</span>
<span class="sd">            The text associated with the instance.</span>
<span class="sd">        level : int, optional</span>
<span class="sd">            The level of the instance, by default 0.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span>  <span class="o">=</span> <span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
        <span class="k">return</span>

<div class="viewcode-block" id="Debug.print">
<a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.Debug.print">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Print message if debugging level allows.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args</span>
<span class="sd">            Variable length argument list for the message to be printed.</span>
<span class="sd">        level : int, optional</span>
<span class="sd">            The level of the message that determines if it gets printed or not,</span>
<span class="sd">            based on the instance&#39;s `level`. Default value is 0.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method will only print the message if the instance&#39;s `debug` flag is True</span>
<span class="sd">        and the provided `level` is less than or equal to the instance&#39;s `level`.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="ow">and</span> <span class="n">level</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="Debug.state">
<a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.Debug.state">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Get the debug state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        The current debug state.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span></div>
</div>


</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, John Kendrick and Andrew Burnett
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../_static/documentation_options.js?v=15c97ff8"></script>
    <script src="../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>