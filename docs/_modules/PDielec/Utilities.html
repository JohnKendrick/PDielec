<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../genindex.html" /><link rel="search" title="Search" href="../../search.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>PDielec.Utilities - PDielec: John Kendrick &amp; Andrew Burnett</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css?v=2e0a580d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../index.html"><div class="brand">PDielec: John Kendrick & Andrew Burnett</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../index.html">
  
  
  <span class="sidebar-brand-text">PDielec: John Kendrick & Andrew Burnett</span>
  
</a><form class="sidebar-search-container" method="get" action="../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../pdgui.html">PDGui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../software.html">Other Software Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../theory_powder.html">Theory for Light Scattering from Powders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../theory_single_crystal.html">Theory for Single Crystal Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../analysis.html">Phonon Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../application_notes_1.html">Applications of Effective Medium Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../application_notes_2.html">Single Crystal Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../autoapi/PDielec/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of PDielec</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../autoapi/PDielec/GUI/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of PDielec.GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/AnalysisTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.AnalysisTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/App/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.App</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/FitterTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.FitterTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/MainTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.MainTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/NoteBook/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.NoteBook</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/OpenGLWidget/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.OpenGLWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/PlottingTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PlottingTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/PowderScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PowderScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/ScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SettingsTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SettingsTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SingleCrystalLayer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SingleCrystalScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/SpreadSheetManager/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SpreadSheetManager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../autoapi/PDielec/GUI/ViewerTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ViewerTab</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/AbinitOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.AbinitOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Calculator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Calculator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/CastepOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CastepOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Constants/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Constants</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/CrystalOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CrystalOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/DielectricFunction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.DielectricFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/ExperimentOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.ExperimentOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/GTMcore/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GTMcore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/GenericOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GenericOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/GulpOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GulpOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/HelperRoutines/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.HelperRoutines</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/IO/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.IO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Materials/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Materials</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Mie/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Mie</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/PhonopyOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.PhonopyOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Plotter/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Plotter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/QEOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.QEOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/SuperCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.SuperCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/UnitCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.UnitCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/Utilities/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Utilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/VaspOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.VaspOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/checkcsv/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkcsv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/checkexcel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkexcel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/graphdatagenerator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.graphdatagenerator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/p1reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p1reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/p2cif/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p2cif</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pdcompare/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/pickled_reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pickled_reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../autoapi/PDielec/vibanalysis/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.vibanalysis</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../zreferences.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for PDielec.Utilities</h1><div class="highlight"><pre>
<span></span><span class="ch">#!/usr/bin/python</span>
<span class="c1">#</span>
<span class="c1"># Copyright 2024 John Kendrick &amp; Andrew Burnett</span>
<span class="c1">#</span>
<span class="c1"># This file is part of PDielec</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the MIT License</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the MIT License along with this program, if not see https://opensource.org/licenses/MIT</span>
<span class="c1">#</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">Utility Functions</span>

<span class="sd">A set of utility functions that may be used anywhere in the package.</span>
<span class="sd">&#39;&#39;&#39;</span>

<span class="kn">from</span> <span class="nn">__future__</span> <span class="kn">import</span> <span class="n">print_function</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="kn">from</span> <span class="nn">PDielec.VaspOutputReader</span> <span class="kn">import</span> <span class="n">VaspOutputReader</span>
<span class="kn">from</span> <span class="nn">PDielec.PhonopyOutputReader</span> <span class="kn">import</span> <span class="n">PhonopyOutputReader</span>
<span class="kn">from</span> <span class="nn">PDielec.CastepOutputReader</span> <span class="kn">import</span> <span class="n">CastepOutputReader</span>
<span class="kn">from</span> <span class="nn">PDielec.GulpOutputReader</span> <span class="kn">import</span> <span class="n">GulpOutputReader</span>
<span class="kn">from</span> <span class="nn">PDielec.CrystalOutputReader</span> <span class="kn">import</span> <span class="n">CrystalOutputReader</span>
<span class="kn">from</span> <span class="nn">PDielec.AbinitOutputReader</span> <span class="kn">import</span> <span class="n">AbinitOutputReader</span>
<span class="kn">from</span> <span class="nn">PDielec.QEOutputReader</span> <span class="kn">import</span> <span class="n">QEOutputReader</span>
<span class="kn">from</span> <span class="nn">PDielec.ExperimentOutputReader</span> <span class="kn">import</span> <span class="n">ExperimentOutputReader</span>

<div class="viewcode-block" id="printsp"><a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.printsp">[docs]</a><span class="k">def</span> <span class="nf">printsp</span><span class="p">(</span><span class="n">name</span><span class="p">,</span><span class="n">matrix</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Utility routine for printing 4x4 matrices or 4 vectors.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    None</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    None</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    None</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrix</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">+.5f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">rows</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">matrix</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="n">string</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
                <span class="n">string</span> <span class="o">=</span> <span class="n">string</span> <span class="o">+</span> <span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">matrix</span><span class="p">[</span><span class="n">j</span><span class="p">,</span><span class="n">i</span><span class="p">]</span><span class="si">:</span><span class="s1">+.5f</span><span class="si">}</span><span class="s1">&#39;</span> <span class="o">+</span> <span class="s1">&#39;   &#39;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">string</span><span class="p">)</span>
    <span class="k">return</span></div>

<div class="viewcode-block" id="find_program_from_name"><a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.find_program_from_name">[docs]</a><span class="k">def</span> <span class="nf">find_program_from_name</span><span class="p">(</span> <span class="n">filename</span> <span class="p">):</span>
    <span class="c1"># Determine the program to use from the file name being used</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Determine the simulation program from a given filename.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    filename : str</span>
<span class="sd">        The complete path (absolute or relative) to a file.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    str</span>
<span class="sd">        A string representing the simulation program the file is associated with. Possible returns are &#39;phonopy&#39;, &#39;vasp&#39;, &#39;gulp&#39;, &#39;castep&#39;, &#39;abinit&#39;, &#39;qe&#39;, &#39;crystal&#39;, &#39;experiment&#39;, &#39;pdgui&#39;, or an empty string if the program cannot be determined.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    This function examines the file extension and, in some cases, the presence of specific files in the same directory, to determine the associated simulation program. It recognizes files from several popular materials simulation programs, such as &#39;phonopy&#39;, &#39;gulp&#39;, &#39;vasp&#39;, and others.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>

<span class="sd">    ::</span>

<span class="sd">        program = find_program_from_name(&#39;./data/structure.castep&#39;)</span>
<span class="sd">        print(program)</span>
<span class="sd">        # Output: &#39;castep&#39;</span>
<span class="sd">    </span>
<span class="sd">        program = find_program_from_name(&#39;path/to/simulation/OUTCAR&#39;)</span>
<span class="sd">        print(program)</span>
<span class="sd">        # Depends on the presence of &#39;phonopy.yaml&#39;, could be &#39;phonopy&#39; or &#39;vasp&#39;</span>

<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">head</span><span class="p">,</span><span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="n">root</span><span class="p">,</span><span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">head</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
        <span class="n">head</span> <span class="o">=</span> <span class="s1">&#39;./&#39;</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">head</span> <span class="o">=</span> <span class="n">head</span><span class="o">+</span><span class="s1">&#39;/&#39;</span>
    <span class="k">if</span> <span class="n">tail</span> <span class="o">==</span> <span class="s1">&#39;OUTCAR&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="s1">&#39;phonopy.yaml&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;phonopy&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;vasp&#39;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.gout&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;gulp&#39;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.born&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;phonopy&#39;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span> <span class="s1">&#39;.castep&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;castep&#39;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s1">&#39;.out&#39;</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;.files&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;abinit&#39;</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">head</span><span class="o">+</span><span class="n">root</span><span class="o">+</span><span class="s1">&#39;.dynG&#39;</span><span class="p">):</span>
            <span class="k">return</span> <span class="s1">&#39;qe&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="s1">&#39;crystal&#39;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s1">&#39;.dynG&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;qe&#39;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s1">&#39;.exp&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;experiment&#39;</span>
    <span class="k">if</span> <span class="n">ext</span> <span class="o">==</span>  <span class="s1">&#39;.py&#39;</span><span class="p">:</span>
        <span class="k">return</span> <span class="s1">&#39;pdgui&#39;</span>
    <span class="k">return</span> <span class="s1">&#39;&#39;</span></div>

<div class="viewcode-block" id="get_reader"><a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.get_reader">[docs]</a><span class="k">def</span> <span class="nf">get_reader</span><span class="p">(</span> <span class="n">name</span><span class="p">,</span> <span class="n">program</span><span class="p">,</span> <span class="n">qmprogram</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the appropriate output reader based on the simulation program and, if specified, the quantum mechanical program.</span>

<span class="sd">    This function is designed to create an output reader object for various simulation programs (like CASTEP, VASP, etc.) and, for phonopy simulations, it can additionally create a quantum mechanical output reader based on the specified quantum mechanical program.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    name : str</span>
<span class="sd">        The primary filepath or name associated with the output file(s).</span>
<span class="sd">    program : str</span>
<span class="sd">        The name of the simulation program. Supported values are &#39;castep&#39;, &#39;vasp&#39;, &#39;gulp&#39;, &#39;crystal&#39;, &#39;abinit&#39;, &#39;qe&#39;, and &#39;phonopy&#39;.</span>
<span class="sd">    qmprogram : str</span>
<span class="sd">        The name of the quantum mechanical program used in conjunction with phonopy. Supported values are the same as for `program`, but its relevance is exclusive to when `program` is set to &#39;phonopy&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object</span>
<span class="sd">        An instance of the appropriate output reader class based on the input `program` and, if applicable, `qmprogram`.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    For phonopy simulations, both phonon and quantum mechanical output files are considered. If the `qmprogram` is not compatible or not specified, the function will exit.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    &gt;&gt;&gt; reader = get_reader(&quot;output.log&quot;, &quot;castep&quot;, &quot;&quot;)</span>
<span class="sd">    &gt;&gt;&gt; reader = get_reader(&quot;output&quot;, &quot;phonopy&quot;, &quot;vasp&quot;)</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">fulldirname</span> <span class="o">=</span> <span class="n">name</span>
    <span class="n">head</span><span class="p">,</span><span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">fulldirname</span><span class="p">)</span>
    <span class="n">root</span><span class="p">,</span><span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">tail</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;castep&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">CastepOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;vasp&quot;</span><span class="p">:</span>
        <span class="n">name1</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">name2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s1">&#39;KPOINTS&#39;</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">VaspOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;gulp&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">GulpOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;crystal&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">CrystalOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;abinit&quot;</span><span class="p">:</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[</span> <span class="n">name</span> <span class="p">]</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">AbinitOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;qe&quot;</span><span class="p">:</span>
        <span class="n">tail1</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.dynG&#39;</span>
        <span class="n">tail2</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.log&#39;</span>
        <span class="n">tail3</span> <span class="o">=</span> <span class="n">root</span><span class="o">+</span><span class="s1">&#39;.out&#39;</span>
        <span class="n">name1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail2</span><span class="p">)</span>
        <span class="n">name2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail3</span><span class="p">)</span>
        <span class="n">name3</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail</span><span class="p">)</span>
        <span class="c1"># We want the dynG entry last rounding causes problems otherwise</span>
        <span class="n">name4</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="n">tail1</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="p">[</span> <span class="n">name1</span><span class="p">,</span> <span class="n">name2</span><span class="p">,</span> <span class="n">name3</span><span class="p">,</span> <span class="n">name4</span> <span class="p">]:</span>
            <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">n</span><span class="p">):</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">n</span> <span class="ow">in</span> <span class="n">names</span><span class="p">:</span>
                    <span class="n">names</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">QEOutputReader</span><span class="p">(</span> <span class="n">names</span> <span class="p">)</span>
    <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">:</span>
        <span class="c1"># The order is important</span>
        <span class="n">pname1</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s1">&#39;qpoints.yaml&#39;</span><span class="p">)</span>
        <span class="n">pname2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s1">&#39;phonopy.yaml&#39;</span><span class="p">)</span>
        <span class="c1"># Only works for VASP at the moment</span>
        <span class="n">vname1</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">vname2</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s1">&#39;KPOINTS&#39;</span><span class="p">)</span>
        <span class="n">pnames</span> <span class="o">=</span> <span class="p">[</span> <span class="n">pname1</span><span class="p">,</span> <span class="n">pname2</span> <span class="p">]</span>
        <span class="n">vnames</span> <span class="o">=</span> <span class="p">[</span> <span class="n">vname1</span><span class="p">,</span> <span class="n">vname2</span> <span class="p">]</span>
        <span class="n">pnames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
        <span class="n">names</span> <span class="o">=</span> <span class="n">pnames</span>
        <span class="c1"># Which QM program was used by PHONOPY?</span>
        <span class="k">if</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;castep&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in qmreader&quot;</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
            <span class="n">qmreader</span> <span class="o">=</span> <span class="n">CastepOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;vasp&quot;</span><span class="p">:</span>
            <span class="n">qmreader</span> <span class="o">=</span> <span class="n">VaspOutputReader</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;gulp&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in qmreader&quot;</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
            <span class="n">qmreader</span> <span class="o">=</span> <span class="n">GulpOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;crystal&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in qmreader&quot;</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
            <span class="n">qmreader</span> <span class="o">=</span> <span class="n">CrystalOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;abinit&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in qmreader&quot;</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
            <span class="n">qmreader</span> <span class="o">=</span> <span class="n">AbinitOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;qe&quot;</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error in qmreader&quot;</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">)</span>
            <span class="n">exit</span><span class="p">()</span>
            <span class="n">qmreader</span> <span class="o">=</span> <span class="n">QEOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="c1"># The QM reader is used to get info about the QM calculation</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="n">PhonopyOutputReader</span><span class="p">(</span><span class="n">pnames</span><span class="p">,</span><span class="n">qmreader</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Program name not recognized&#39;</span><span class="p">,</span><span class="n">program</span><span class="p">,</span><span class="n">file</span><span class="o">=</span><span class="n">sys</span><span class="o">.</span><span class="n">stderr</span><span class="p">)</span>
        <span class="n">exit</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">reader</span></div>


<div class="viewcode-block" id="pdgui_get_reader"><a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.pdgui_get_reader">[docs]</a><span class="k">def</span> <span class="nf">pdgui_get_reader</span><span class="p">(</span><span class="n">program</span><span class="p">,</span><span class="n">names</span><span class="p">,</span><span class="n">qmprogram</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Get the appropriate reader based on the provided program and file names.</span>

<span class="sd">    This function determines the correct output reader to use based on the program specified and the presence of certain files</span>
<span class="sd">    in the provided directory or file names list. It supports various quantum mechanics and molecular dynamics</span>
<span class="sd">    programs as well as experiment data.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    program : str</span>
<span class="sd">        The name of the program or an empty string to attempt automatic detection. Supported programs include &#39;vasp&#39;,</span>
<span class="sd">        &#39;castep&#39;, &#39;gulp&#39;, &#39;crystal&#39;, &#39;abinit&#39;, &#39;qe&#39;, &#39;phonopy&#39;, and &#39;experiment&#39;.</span>
<span class="sd">    names : list of str</span>
<span class="sd">        A list containing either directory names or file names to be read or analysed.</span>
<span class="sd">    qmprogram : str</span>
<span class="sd">        Specifies the quantum mechanics program used in conjunction with &#39;phonopy&#39;. It is only relevant if &#39;program&#39;</span>
<span class="sd">        is set to &#39;phonopy&#39;. Supported programs include &#39;castep&#39;, &#39;vasp&#39;, &#39;gulp&#39;, &#39;crystal&#39;, &#39;abinit&#39;, and &#39;qe&#39;.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    object</span>
<span class="sd">        Returns an instance of the correct output reader based on the specified program and available files. If the</span>
<span class="sd">        necessary files are not found or if the program is not recognized, it returns None.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    - The readers returned are capable of parsing output files from their respective programs and extracting relevant data.</span>
<span class="sd">    - For &#39;phonopy&#39;, additional handling is included to combine phonopy output with quantum mechanics results from another</span>
<span class="sd">      specified program.</span>
<span class="sd">    - This function also handles directory or file existence checks and will print errors if required files are missing.</span>

<span class="sd">    Examples</span>
<span class="sd">    --------</span>
<span class="sd">    To get a VASP output reader for a directory containing VASP output files:</span>

<span class="sd">    &gt;&gt;&gt; reader = pdgui_get_reader(&#39;&#39;, [&#39;path/to/vasp/output&#39;], &#39;&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(reader)</span>

<span class="sd">    For phonopy with VASP as the quantum mechanics program:</span>

<span class="sd">    &gt;&gt;&gt; qm_reader = pdgui_get_reader(&#39;phonopy&#39;, [&#39;path/to/phonopy/files&#39;], &#39;vasp&#39;)</span>
<span class="sd">    &gt;&gt;&gt; print(qm_reader)</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="n">reader</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">program</span> <span class="o">=</span> <span class="n">program</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">qmprogram</span> <span class="o">=</span> <span class="n">qmprogram</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="c1">#print(&quot;get_reader&quot;,names,program)</span>
    <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
        <span class="c1">#  This is the old behaviour.  It copes with VASP, CASTEP and Crystal</span>
        <span class="c1">#  If names[0] is a directory then we will use a vaspoutputreader</span>
        <span class="c1">#  Otherwise it is a seedname for castep, or a gulp output file, or a crystal output file</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Analysing VASP directory: </span><span class="si">{}</span><span class="s1"> &#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
            <span class="n">outcarfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;OUTCAR&quot;</span><span class="p">)</span>
            <span class="n">kpointsfile</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s2">&quot;KPOINTS&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">outcarfile</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: NO OUTCAR FILE IN DIRECTORY&quot;</span><span class="p">)</span>
                <span class="n">reader</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">VaspOutputReader</span><span class="p">(</span> <span class="p">[</span><span class="n">outcarfile</span><span class="p">,</span> <span class="n">kpointsfile</span><span class="p">]</span> <span class="p">)</span>
        <span class="k">elif</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;OUTCAR&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="s2">&quot;OUTCAR&quot;</span><span class="p">):</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">VaspOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.gout&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">GulpOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.out&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">CrystalOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.castep&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]):</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">CastepOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.castep&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.castep&quot;</span><span class="p">):</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">CastepOutputReader</span><span class="p">([</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;.castep&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No valid file name has been found on the command line&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Try using the -program option to specify the&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;files which will be read&#39;</span><span class="p">)</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># New Specification of Program used to define the input files</span>
        <span class="c1"># Abinit and QE need a couple of files to be specified</span>
        <span class="c1">#</span>
        <span class="c1"># First Check that the file(s) we requested are there</span>
        <span class="c1">#</span>
        <span class="n">checkfiles</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;castep&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;.castep&quot;</span><span class="p">)</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">seedname</span><span class="p">,</span> <span class="n">ext</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">splitext</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">seedname</span> <span class="o">=</span> <span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">checkfiles</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">seedname</span><span class="o">+</span><span class="s2">&quot;.castep&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">:</span>
            <span class="c1"># We only have a VASP / Phonopy interface</span>
            <span class="c1"># Creat a list of phonopy files</span>
            <span class="n">pnames</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">head</span><span class="p">,</span><span class="n">tail</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="n">names</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">pnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s1">&#39;qpoints.yaml&#39;</span><span class="p">))</span>
            <span class="n">pnames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">head</span><span class="p">,</span><span class="s1">&#39;phonopy.yaml&#39;</span><span class="p">))</span>
            <span class="c1"># Creat a list of VASP files NB.  They all have to be in the same directory</span>
            <span class="n">vnames</span> <span class="o">=</span> <span class="n">names</span>
            <span class="n">pnames</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
            <span class="n">checkfiles</span> <span class="o">=</span> <span class="n">pnames</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">checkfiles</span> <span class="o">=</span> <span class="n">names</span>
        <span class="c1">#jk print(&quot;&quot;)</span>
        <span class="c1">#jk print(&quot;Program used to perform the phonon calculation was: {}&quot;.format(program))</span>
        <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">checkfiles</span><span class="p">:</span>
            <span class="c1">#jk print(&quot;The file containing the output is: {}&quot;.format(f))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Output files created by program: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">program</span><span class="p">))</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: file not available: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">))</span>
                <span class="n">reader</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">return</span> <span class="n">reader</span>
        <span class="c1"># The files requested are available so read them</span>
        <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;castep&quot;</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">CastepOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;vasp&quot;</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">VaspOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;gulp&quot;</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">GulpOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;crystal&quot;</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">CrystalOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;abinit&quot;</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">AbinitOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;qe&quot;</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">QEOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;phonopy&quot;</span><span class="p">:</span>
            <span class="c1"># Which QM program was used by PHONOPY?</span>
            <span class="k">if</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;castep&quot;</span><span class="p">:</span>
                <span class="n">qmreader</span> <span class="o">=</span> <span class="n">CastepOutputReader</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;vasp&quot;</span><span class="p">:</span>
                <span class="n">qmreader</span> <span class="o">=</span> <span class="n">VaspOutputReader</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;gulp&quot;</span><span class="p">:</span>
                <span class="n">qmreader</span> <span class="o">=</span> <span class="n">GulpOutputReader</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;crystal&quot;</span><span class="p">:</span>
                <span class="n">qmreader</span> <span class="o">=</span> <span class="n">CrystalOutputReader</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;abinit&quot;</span><span class="p">:</span>
                <span class="n">qmreader</span> <span class="o">=</span> <span class="n">AbinitOutputReader</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">qmprogram</span> <span class="o">==</span> <span class="s2">&quot;qe&quot;</span><span class="p">:</span>
                <span class="n">qmreader</span> <span class="o">=</span> <span class="n">QEOutputReader</span><span class="p">(</span><span class="n">vnames</span><span class="p">)</span>
            <span class="c1"># The QM reader is used to get info about the QM calculation</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">PhonopyOutputReader</span><span class="p">(</span><span class="n">pnames</span><span class="p">,</span><span class="n">qmreader</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;experiment&quot;</span><span class="p">:</span>
            <span class="n">reader</span> <span class="o">=</span> <span class="n">ExperimentOutputReader</span><span class="p">(</span><span class="n">names</span><span class="p">)</span>
        <span class="c1"># endif</span>
    <span class="c1"># end if</span>
    <span class="k">return</span> <span class="n">reader</span></div>

<div class="viewcode-block" id="Debug"><a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.Debug">[docs]</a><span class="k">class</span> <span class="nc">Debug</span><span class="p">():</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class aimed at providing a structured way to include debug messages in code.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    print(args, level=0)</span>
<span class="sd">        Prints debug messages based on the debug level provided as argument compared to the object&#39;s debug level.</span>
<span class="sd">    state()</span>
<span class="sd">        Returns the current state (enabled or disabled) of debugging.</span>

<span class="sd">    Notes</span>
<span class="sd">    -----</span>
<span class="sd">    The `print` method provides a flexible way to include additional information along with the base debug message, allowing for a detailed and adjustable debugging output.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">debug</span><span class="p">,</span><span class="n">text</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize an instance with debug status, text, and optional level.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        debug : bool</span>
<span class="sd">            A boolean indicating whether debugging is enabled.</span>
<span class="sd">        text : str</span>
<span class="sd">            The text associated with the instance.</span>
<span class="sd">        level : int, optional</span>
<span class="sd">            The level of the instance, by default 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">debug</span> <span class="o">=</span> <span class="n">debug</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">text</span>  <span class="o">=</span> <span class="n">text</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">level</span> <span class="o">=</span> <span class="n">level</span>
        <span class="k">return</span>

<div class="viewcode-block" id="Debug.print"><a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.Debug.print">[docs]</a>    <span class="k">def</span> <span class="nf">print</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="n">level</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Prints message if debugging level allows.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args</span>
<span class="sd">            Variable length argument list for the message to be printed.</span>
<span class="sd">        level : int, optional</span>
<span class="sd">            The level of the message that determines if it gets printed or not,</span>
<span class="sd">            based on the instance&#39;s `level`. Default value is 0.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method will only print the message if the instance&#39;s `debug` flag is True</span>
<span class="sd">        and the provided `level` is less than or equal to the instance&#39;s `level`.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">level</span> <span class="o">&lt;=</span> <span class="bp">self</span><span class="o">.</span><span class="n">level</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">text</span><span class="p">,</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="Debug.state"><a class="viewcode-back" href="../../autoapi/PDielec/Utilities/index.html#PDielec.Utilities.Debug.state">[docs]</a>    <span class="k">def</span> <span class="nf">state</span><span class="p">(</span><span class="bp">self</span><span class="p">,):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Get the debug state.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        The current debug state.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">debug</span></div></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, John Kendrick and Andrew Burnett
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js?v=01b4f342"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>