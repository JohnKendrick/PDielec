<!doctype html>
<html class="no-js" lang="en" data-content_root="../../../">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2024.08.06 -->
        <title>PDielec.GUI.PowderScenarioTab - PDielec: John Kendrick &amp; Andrew Burnett</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=b86133f3" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=354aac6f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=302659d7" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2e0a580d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">PDielec: John Kendrick & Andrew Burnett</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">PDielec: John Kendrick & Andrew Burnett</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pdgui.html">PDGui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software.html">Other Software Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_powder.html">Theory for Light Scattering from Powders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_single_crystal.html">Theory for Single Crystal Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analysis.html">Phonon Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_1.html">Applications of Effective Medium Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_2.html">Single Crystal Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_3.html">Phonopy Examples</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../autoapi/PDielec/index.html">PDielec</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of PDielec</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/AbinitOutputReader/index.html">PDielec.AbinitOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Calculator/index.html">PDielec.Calculator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CastepOutputReader/index.html">PDielec.CastepOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Constants/index.html">PDielec.Constants</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CrystalOutputReader/index.html">PDielec.CrystalOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/DielectricFunction/index.html">PDielec.DielectricFunction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/ExperimentOutputReader/index.html">PDielec.ExperimentOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GTMcore/index.html">PDielec.GTMcore</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PDielec/GUI/index.html">PDielec.GUI</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of PDielec.GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html">PDielec.GUI.AnalysisTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/App/index.html">PDielec.GUI.App</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/FitterTab/index.html">PDielec.GUI.FitterTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/MainTab/index.html">PDielec.GUI.MainTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/NoteBook/index.html">PDielec.GUI.NoteBook</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/OpenGLWidget/index.html">PDielec.GUI.OpenGLWidget</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html">PDielec.GUI.PlottingTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html">PDielec.GUI.PowderScenarioTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ScenarioTab/index.html">PDielec.GUI.ScenarioTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html">PDielec.GUI.SettingsTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalLayer/index.html">PDielec.GUI.SingleCrystalLayer</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalScenarioTab/index.html">PDielec.GUI.SingleCrystalScenarioTab</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SpreadSheetManager/index.html">PDielec.GUI.SpreadSheetManager</a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ViewerTab/index.html">PDielec.GUI.ViewerTab</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GenericOutputReader/index.html">PDielec.GenericOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GulpOutputReader/index.html">PDielec.GulpOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/HelperRoutines/index.html">PDielec.HelperRoutines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/IO/index.html">PDielec.IO</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Materials/index.html">PDielec.Materials</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Mie/index.html">PDielec.Mie</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/PhonopyOutputReader/index.html">PDielec.PhonopyOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Plotter/index.html">PDielec.Plotter</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/PrimitiveCell/index.html">PDielec.PrimitiveCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/QEOutputReader/index.html">PDielec.QEOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/SuperCell/index.html">PDielec.SuperCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/UnitCell/index.html">PDielec.UnitCell</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Utilities/index.html">PDielec.Utilities</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/VaspOutputReader/index.html">PDielec.VaspOutputReader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkcsv/index.html">PDielec.checkcsv</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkexcel/index.html">PDielec.checkexcel</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/graphdatagenerator/index.html">PDielec.graphdatagenerator</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p1reader/index.html">PDielec.p1reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p2cif/index.html">PDielec.p2cif</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdcompare/index.html">PDielec.pdcompare</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html">PDielec.pdgui</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html">PDielec.pdmake</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/phonopy_pdielec_born/index.html">PDielec.phonopy_pdielec_born</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pickled_reader/index.html">PDielec.pickled_reader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html">PDielec.preader</a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/vibanalysis/index.html">PDielec.vibanalysis</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html">PDielec.pdgui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html">PDielec.preader</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html">PDielec.pdmake</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../zreferences.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <h1>Source code for PDielec.GUI.PowderScenarioTab</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright 2024 John Kendrick &amp; Andrew Burnett</span>
<span class="c1">#</span>
<span class="c1"># This file is part of PDielec</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the MIT License</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the MIT License along with this program, if not see https://opensource.org/licenses/MIT</span>
<span class="c1">#</span>
<span class="sd">&quot;&quot;&quot;PowderScenarioTab module.&quot;&quot;&quot;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">ctypes</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">sys</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">functools</span><span class="w"> </span><span class="kn">import</span> <span class="n">partial</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">multiprocessing</span><span class="w"> </span><span class="kn">import</span> <span class="n">Array</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">numpy</span><span class="w"> </span><span class="k">as</span><span class="w"> </span><span class="nn">np</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qtpy.QtCore</span><span class="w"> </span><span class="kn">import</span> <span class="n">QCoreApplication</span><span class="p">,</span> <span class="n">Qt</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">qtpy.QtWidgets</span><span class="w"> </span><span class="kn">import</span> <span class="p">(</span>
    <span class="n">QComboBox</span><span class="p">,</span>
    <span class="n">QDoubleSpinBox</span><span class="p">,</span>
    <span class="n">QFormLayout</span><span class="p">,</span>
    <span class="n">QHBoxLayout</span><span class="p">,</span>
    <span class="n">QLabel</span><span class="p">,</span>
    <span class="n">QLineEdit</span><span class="p">,</span>
    <span class="n">QSizePolicy</span><span class="p">,</span>
    <span class="n">QSpinBox</span><span class="p">,</span>
    <span class="n">QVBoxLayout</span><span class="p">,</span>
    <span class="n">QWidget</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec</span><span class="w"> </span><span class="kn">import</span> <span class="n">Calculator</span><span class="p">,</span> <span class="n">DielectricFunction</span><span class="p">,</span> <span class="n">Materials</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.GUI.ScenarioTab</span><span class="w"> </span><span class="kn">import</span> <span class="n">ScenarioTab</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.Materials</span><span class="w"> </span><span class="kn">import</span> <span class="n">MaterialsDataBase</span>
<span class="kn">from</span><span class="w"> </span><span class="nn">PDielec.Utilities</span><span class="w"> </span><span class="kn">import</span> <span class="n">Debug</span>


<div class="viewcode-block" id="PowderScenarioTab">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab">[docs]</a>
<span class="k">class</span><span class="w"> </span><span class="nc">PowderScenarioTab</span><span class="p">(</span><span class="n">ScenarioTab</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A class for managing the Powder Scenario Tab.</span>

<span class="sd">    It inherits from :class:`~PDielec.GUI.ScenarioTab`, thus utilizing its layout and properties, </span>
<span class="sd">    with additional features and settings pertinent to powder scenarios.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : QWidget</span>
<span class="sd">        The parent widget to attach to this scenario tab.</span>
<span class="sd">    debug : bool, optional</span>
<span class="sd">        If set to True, debug messages will be printed. Defaults to False.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    scenarioType : str</span>
<span class="sd">        Defines the type of scenario as &#39;Powder&#39;.</span>
<span class="sd">    settings : dict</span>
<span class="sd">        Dictionary holding various settings related to the scenario.</span>
<span class="sd">    methods : list</span>
<span class="sd">        List of available effective medium methods.</span>
<span class="sd">    shapes : list</span>
<span class="sd">        List of available particle shapes.</span>
<span class="sd">    materialNames : list</span>
<span class="sd">        List of available material names.</span>
<span class="sd">    materialDefined : bool</span>
<span class="sd">        Indicates whether the material is defined manually or not.</span>
<span class="sd">    direction : ndarray</span>
<span class="sd">        Array defining the unique direction for particle shape.</span>
<span class="sd">    depolarisation : ndarray (3x3)</span>
<span class="sd">        Array defining the depolarisation factors.</span>
<span class="sd">    scenarioIndex : any</span>
<span class="sd">        Index associated with the current scenario.</span>
<span class="sd">    refreshRequired : bool</span>
<span class="sd">        Indicates if UI refresh is required.</span>
<span class="sd">    calculationRequired : bool</span>
<span class="sd">        Indicates if recalculation is required due to parameter changes.</span>
<span class="sd">    reader : An dft output reader</span>
<span class="sd">        Used to read external data.</span>
<span class="sd">    realPermittivity : list</span>
<span class="sd">        List holding real parts of permittivity values.</span>
<span class="sd">    imagPermittivity : list</span>
<span class="sd">        List holding imaginary parts of permittivity values.</span>
<span class="sd">    absorptionCoefficient : list</span>
<span class="sd">        List to hold absorption coefficient values.</span>
<span class="sd">    molarAbsorptionCoefficient : list</span>
<span class="sd">        List to hold molar absorption coefficient values.</span>
<span class="sd">    sp_atr : list</span>
<span class="sd">        List to hold ATR specific calculation results.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    crystal_density()</span>
<span class="sd">        Compute and return the density of the crystal based on its volume and mass.</span>
<span class="sd">    openDB_button_clicked()</span>
<span class="sd">        Handler for the event where the database open button is clicked.</span>
<span class="sd">    on_h_sb_changed(value)</span>
<span class="sd">        Handler for changes in the &#39;h&#39; dimension parameter of the crystal&#39;s unique direction.</span>
<span class="sd">    on_k_sb_changed(value)</span>
<span class="sd">        Handler for changes in the &#39;k&#39; dimension parameter of the crystal&#39;s unique direction.</span>
<span class="sd">    on_l_sb_changed(value)</span>
<span class="sd">        Handler for changes in the &#39;l&#39; dimension parameter of the crystal&#39;s unique direction.</span>
<span class="sd">    on_shape_cb_activated(index)</span>
<span class="sd">        Handler for changes in the selected shape of powder particles.</span>
<span class="sd">    on_methods_cb_activated(index)</span>
<span class="sd">        Handler to deal with changes in the selected calculation method for effective medium theory.</span>
<span class="sd">    on_mf_sb_changed(value)</span>
<span class="sd">        Handler for changes to the mass fraction value, updating the volume fraction value accordingly.</span>
<span class="sd">    update_vf_sb()</span>
<span class="sd">        Update the volume fraction spinbox according to the mass fraction and recalculates as necessary.</span>
<span class="sd">    on_aoverb_sb_changed(value)</span>
<span class="sd">        Handler for changes to the ellipsoid a/b ratio or eccentricity.</span>
<span class="sd">    on_legend_le_changed(text)</span>
<span class="sd">        Handler for changes to the legend label of the powder scenario.</span>
<span class="sd">    on_sigma_sb_changed(value)</span>
<span class="sd">        Handler for changes to the particle size distribution sigma.</span>
<span class="sd">    on_size_sb_changed(value)</span>
<span class="sd">        Handler for changes to the particle size.</span>
<span class="sd">    on_vf_sb_changed(value)</span>
<span class="sd">        Handle changes to the volume fraction spinbox, updating mass fraction accordingly.</span>
<span class="sd">    update_mf_sb()</span>
<span class="sd">        Update the mass fraction spinbox according to the volume fraction and recalculates as necessary.</span>
<span class="sd">    on_matrix_cb_activated(index)</span>
<span class="sd">        Handler for changes to the selected support matrix in the ComboBox.</span>
<span class="sd">    on_density_sb_changed(value)</span>
<span class="sd">        Handle changes to the density spinbox of the support matrix.</span>
<span class="sd">    on_bubble_vf_sb_changed(value)</span>
<span class="sd">        Handle changes to the bubble volume fraction spinbox.</span>
<span class="sd">    on_bubble_radius_sb_changed(value)</span>
<span class="sd">        Handle changes to the bubble radius spinbox.</span>
<span class="sd">    on_permittivity_i_sb_changed(value)</span>
<span class="sd">        Handle changes to the imaginary part of the support matrix permittivity.</span>
<span class="sd">    on_permittivity_r_sb_changed(value)</span>
<span class="sd">        Handle changes to the real part of the support matrix permittivity.</span>
<span class="sd">    on_atr_index_sb_changed(value)</span>
<span class="sd">        Handle changes to the ATR material refractive index spinbox.</span>
<span class="sd">    on_atr_incident_ang_sb_changed(value)</span>
<span class="sd">        Handle changes to the ATR incident angle spinbox.</span>
<span class="sd">    on_atr_spolfrac_sb_changed(value)</span>
<span class="sd">        Handle changes to the ATR s-polarisation fraction spinbox.</span>
<span class="sd">    change_greyed_out()</span>
<span class="sd">        Enable or disable elements of the GUI based on the current scenario settings.</span>
<span class="sd">    calculate(vs_cm1)</span>
<span class="sd">        Calculate the powder absorption for the given frequency range.</span>
<span class="sd">    get_result(vs_cm1, plot_type)</span>
<span class="sd">        Return the calculation result for the specified plot type.</span>
<span class="sd">    get_results(vs_cm1)</span>
<span class="sd">        Prepare the necessary results for displaying or processing.</span>
<span class="sd">    refresh(force=False)</span>
<span class="sd">        Refresh the GUI interface with up to date values.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span><span class="w"> </span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize the ScenarioTab subclass for Powder Scenario with UI and connectivity.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent : QWidget</span>
<span class="sd">            The parent widget to attach to this scenario tab.</span>
<span class="sd">        debug : bool, optional</span>
<span class="sd">            If set to True, debug messages will be printed. Defaults to False.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        scenarioType : str</span>
<span class="sd">            Defines the type of scenario as &#39;Powder&#39;.</span>
<span class="sd">        settings : dict</span>
<span class="sd">            Dictionary holding various settings related to the scenario.</span>
<span class="sd">        methods : list</span>
<span class="sd">            List of available effective medium methods.</span>
<span class="sd">        shapes : list</span>
<span class="sd">            List of available particle shapes.</span>
<span class="sd">        materialNames : list</span>
<span class="sd">            List of available material names.</span>
<span class="sd">        materialDefined : bool</span>
<span class="sd">            Indicates whether the material is defined manually or not.</span>
<span class="sd">        direction : ndarray</span>
<span class="sd">            Array defining the unique direction for particle shape.</span>
<span class="sd">        depolarisation : ndarray (3x3)</span>
<span class="sd">            Array defining the depolarisation factors.</span>
<span class="sd">        scenarioIndex : any</span>
<span class="sd">            Index associated with the current scenario.</span>
<span class="sd">        refreshRequired : bool</span>
<span class="sd">            Indicates if UI refresh is required.</span>
<span class="sd">        calculationRequired : bool</span>
<span class="sd">            Indicates if recalculation is required due to parameter changes.</span>
<span class="sd">        reader : An dft output reader</span>
<span class="sd">            Used to read external data.</span>
<span class="sd">        realPermittivity : list</span>
<span class="sd">            List holding real parts of permittivity values.</span>
<span class="sd">        imagPermittivity : list</span>
<span class="sd">            List holding imaginary parts of permittivity values.</span>
<span class="sd">        absorptionCoefficient : list</span>
<span class="sd">            List to hold absorption coefficient values.</span>
<span class="sd">        molarAbsorptionCoefficient : list</span>
<span class="sd">            List to hold molar absorption coefficient values.</span>
<span class="sd">        sp_atr : list</span>
<span class="sd">            List to hold ATR specific calculation results.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">ScenarioTab</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">global</span> <span class="n">debugger</span>
        <span class="n">debugger</span> <span class="o">=</span> <span class="n">Debug</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;PowderScenarioTab:&quot;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Start:: initialiser&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scenarioType</span> <span class="o">=</span> <span class="s2">&quot;Powder&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Scenario type&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Powder&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">noCalculationsRequired</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">30.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size(mu)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0001</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size distribution sigma(mu)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Ellipsoid a/b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - h&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass or volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;volume&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR material refractive index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">4.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">45.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR S polarisation fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Maxwell-Garnett&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sphere&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Maxwell-Garnett&quot;</span><span class="p">,</span> <span class="s2">&quot;Bruggeman&quot;</span><span class="p">,</span> <span class="s2">&quot;Averaged Permittivity&quot;</span><span class="p">,</span> <span class="s2">&quot;Mie&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Sphere&quot;</span><span class="p">,</span> <span class="s2">&quot;Needle&quot;</span><span class="p">,</span> <span class="s2">&quot;Plate&quot;</span><span class="p">,</span> <span class="s2">&quot;Ellipsoid&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">depolarisation</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mi">0</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scenarioIndex</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realPermittivity</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imagPermittivity</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">absorptionCoefficient</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molarAbsorptionCoefficient</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp_atr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Create a scenario tab</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># Option to open a database of permittivities for the support</span>
        <span class="c1"># label and button are defined the parent class</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">openDB_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">openDB_button</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Add a name for the database</span>
        <span class="c1"># label and button are defined the parent class</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">database_le_label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">database_le</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Support matrix, read information from the database</span>
        <span class="c1">#</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the permittivity and density of the support matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getSheetNames</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_matrix_cb_activated</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Material defined manually&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="n">Materials</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;manual&quot;</span><span class="p">,</span><span class="n">permittivity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">],</span><span class="n">density</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getMaterial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">])</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Support matrix&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the permittivity and density of the support matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_info_le</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_info_le</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Provides details about database entry&quot;</span><span class="p">)</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getInformation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_info_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_info_le</span><span class="o">.</span><span class="n">setReadOnly</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">matrix_info_le</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">hbox</span><span class="p">)</span>
        <span class="c1"># Set the Matrix density and permittivity at 0cm-1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getDensity</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getPermittivityFunction</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Support matrix permittivity</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the support matrix density. </span><span class="se">\n</span><span class="s2">This makes changes to the support density and permittivity&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_density_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Support density&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the support matrix density. </span><span class="se">\n</span><span class="s2">This makes changes to the support density and permittivity&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Support matrix permittivity</span>
        <span class="c1">#</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the real component of the support matrix permittivity&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_permittivity_r_sb_changed</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define imaginary component of the the support matrix permittivity&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_permittivity_i_sb_changed</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Support permittivity&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the complex support matrix permittivity&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">hbox</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Bubble volume fraction</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the % volume fraction of air bubble inclusions in the matrix&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_bubble_vf_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;% Air void volume fraction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the % volume fraction of air bubble inclusions in the matrix&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Bubble radius in microns</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the air bubble radius&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble radius&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_bubble_radius_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Air void radius (μm)&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the air void radius&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Mass fraction of dielectric medium</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The percentage mass fraction of the dielectric medium. </span><span class="se">\n</span><span class="s2">Note that volume and mass fraction are linked&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass fraction&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_mf_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;% Mass fraction of dielectric&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The percentage mass fraction of the dielectric medium. </span><span class="se">\n</span><span class="s2">Note that volume and mass fraction are linked&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Volume fraction of dielectric medium</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The percentage volume fraction of the dielectric medium. </span><span class="se">\n</span><span class="s2">Note that volume and mass fraction are linked&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_vf_sb_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">])</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;% Volume fraction of dielectric&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The percentage volume fraction of the dielectric medium. </span><span class="se">\n</span><span class="s2">Note that volume and mass fraction are linked&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Calculation method</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Choose the calculation method for the effective medium theory&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method index was not 0&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_methods_cb_activated</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Method&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Choose the calculation method for the effective medium theory&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Particle size option</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.000001</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the particle radius of the sphere in μm.&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size(mu)&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_size_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Particle radius (μm)&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the particle radius of the sphere in μm.&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Particle sigma option</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the particle size distribution as a lognormal distribution with the given sigma. </span><span class="se">\n</span><span class="s2">Only applicable for the Mie method&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size distribution sigma(mu)&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_sigma_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Particle sigma (μm)&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the particle size distribition as a lognormal with the given sigma. </span><span class="se">\n</span><span class="s2">Only applicable for the Mie method&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Crystallite shape</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Choose a particle shape. </span><span class="se">\n</span><span class="s2">For the Mie methods only sphere is allowed.  </span><span class="se">\n</span><span class="s2">For shapes other than sphere there is a unique direction. </span><span class="se">\n</span><span class="s2">For ellipsoidal and needle like this is a direction [abc].  </span><span class="se">\n</span><span class="s2">For a plate the perpendicular to a crystal face (hkl) is used to define the unique direction&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method index was not 0&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_shape_cb_activated</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Choose a particle shape. </span><span class="se">\n</span><span class="s2">For the Mie methods only sphere is allowed.  </span><span class="se">\n</span><span class="s2">For shapes other than sphere there is a unique direction. </span><span class="se">\n</span><span class="s2">For ellipsoidal and needle like this is a direction [abc].  </span><span class="se">\n</span><span class="s2">For a plate the perpendicular to a crystal face (hkl) is used to define the unique direction&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Particle shape information</span>
        <span class="c1"># unique direction (hkl) or [abc]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the h dimension of the unique direction&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - h&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_h_sb_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the k dimension of the unique direction&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - k&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_k_sb_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the l dimension of the unique direction&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="mi">20</span><span class="p">,</span><span class="mi">20</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - l&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_l_sb_changed</span><span class="p">)</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hkl_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Unique direction [abc]&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">hkl_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the unique direction by [abc] or (hkl). </span><span class="se">\n</span><span class="s2">[abc] is used by needles and ellipsoids.  It defines the unique direction in crystallographic units. </span><span class="se">\n</span><span class="s2">(hkl) is used by plates it defines a surface and the unique direction is perpendicular to it.&quot;</span><span class="p">)</span>

        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">hkl_label</span><span class="p">,</span> <span class="n">hbox</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># a over b ratio for ellipse</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the ellipsoid a/b ratio or eccentricity.  </span><span class="se">\n</span><span class="s2">Only applicable for the ellipsoid shapes </span><span class="se">\n</span><span class="s2">a/b &lt; 1: oblate ellipsoid </span><span class="se">\n</span><span class="s2">a/b &gt; 1: prolate ellipsoid&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Ellipsoid a/b&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_aoverb_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Ellipsoid a/b eccentricty&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the ellipsoid a/b ratio or eccentricity.  </span><span class="se">\n</span><span class="s2">Only applicable for the ellipsoid shapes </span><span class="se">\n</span><span class="s2">a/b &lt; 1: oblate ellipsoid </span><span class="se">\n</span><span class="s2">a/b &gt; 1: prolate ellipsoid&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Add ATR options</span>
        <span class="c1"># Refractive Index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.001</span><span class="p">,</span> <span class="mf">100.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the ATR material refractive index&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR material refractive index&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_atr_index_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;ATR material refractive index&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the ATR material refractive index&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="p">)</span>
        <span class="c1"># Incident angle in degreees</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">180.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the ATR incident angle&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR theta&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_atr_incident_ang_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;ATR incident angle&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the ATR incident angle&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="p">)</span>
        <span class="c1"># S polarisation fraction</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the ATR S polarisation fraction, the rest is P polarisation&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR S polarisation fraction&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_atr_spolfrac_sb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;ATR S polarisation fraction&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Define the S polarisation fraction, the rest is P polarisation&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Add a legend option</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend_le</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend_le</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The legend will be used to describe the results in the plot&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend_le</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_legend_le_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Powder scenario legend&quot;</span><span class="p">,</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The legend will be used to describe the results in the plotting tab&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">legend_le</span><span class="p">)</span>

        <span class="c1">#</span>
        <span class="c1"># Final buttons</span>
        <span class="c1">#</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">add_scenario_buttons</span><span class="p">()</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">hbox</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
        <span class="c1"># finalise the layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
        <span class="c1"># sort out greying of boxes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_greyed_out</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Finished:: initialiser&quot;</span><span class="p">)</span>
        <span class="k">return</span>

<div class="viewcode-block" id="PowderScenarioTab.crystal_density">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.crystal_density">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">crystal_density</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Find the crystal density from the current reader and return the density.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        float</span>
<span class="sd">            The crystal density.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Finished:: crystal_density - no reader&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="mf">1.0</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">get_crystal_density</span><span class="p">()</span></div>


<div class="viewcode-block" id="PowderScenarioTab.openDB_button_clicked">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.openDB_button_clicked">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">openDB_button_clicked</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Open a new materials&#39; database.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Start:: openDB_button_clicked&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">openDataBase</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getMaterial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">])</span>
        <span class="c1"># Check to see that the matrix return a scalar permittivity</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">isTensor</span><span class="p">():</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: matrix must have a scalar permittivity using ptfe&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;ptfe&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getMaterial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">])</span>
        <span class="n">materialPermittivityFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getPermittivityFunction</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">materialPermittivityFunction</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getDensity</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_h_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_h_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_h_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change to the h parameter of the (hkl) surface.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The h, k or l value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on_h_sb_changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - h&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_k_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_k_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_k_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change to the k parameter of the (hkl) surface.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The h, k or l value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on_k_sb_changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_l_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_l_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_l_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change to the l parameter of the (hkl) surface.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int</span>
<span class="sd">            The h, k or l value</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on_l_sb_changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_shape_cb_activated">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_shape_cb_activated">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_shape_cb_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle changes to the shape of the powder particles.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index</span>
<span class="sd">            The index in the list of shapes</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on shape cb activated&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Sphere&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - h&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - k&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - l&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_greyed_out</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_methods_cb_activated">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_methods_cb_activated">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_methods_cb_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle changes in the calculation method for the effective medium theory.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index</span>
<span class="sd">            The index in the list of methods</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on methods cb activated&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Mie&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Anisotropic-Mie&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sphere&quot;</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Maxwell-Garnett&quot;</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Bruggeman&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size distribution sigma(mu)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Averaged Permittivity&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size(mu)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0001</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size distribution sigma(mu)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_greyed_out</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_mf_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_mf_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_mf_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a mass fraction change and update the volume fraction.</span>

<span class="sd">        The mass fraction is prioritized and stored.  The volume fraction is calculated.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The mass fraction</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on mass fraction line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass or volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;mass&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass fraction&quot;</span><span class="p">]</span> <span class="o">=</span>  <span class="n">value</span><span class="o">/</span><span class="mf">100.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.update_vf_sb">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.update_vf_sb">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_vf_sb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the volume fraction according to the mass fraction.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">mf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass fraction&quot;</span><span class="p">]</span>
        <span class="n">mf2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">mf1</span>
        <span class="n">rho1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_density</span><span class="p">()</span>
        <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span>
        <span class="c1">#</span>
        <span class="c1"># Avoid overflow through division by 0</span>
        <span class="c1">#</span>
        <span class="n">mf2</span>  <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">mf2</span><span class="p">,</span><span class="mf">1.0E-18</span><span class="p">)</span>
        <span class="n">rho1</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">rho1</span><span class="p">,</span><span class="mf">1.0E-18</span><span class="p">)</span>
        <span class="n">vf1</span> <span class="o">=</span> <span class="p">(</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">]</span> <span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">mf1</span><span class="o">/</span><span class="n">mf2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rho2</span><span class="o">/</span><span class="n">rho1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">+</span> <span class="p">(</span><span class="n">mf1</span><span class="o">/</span><span class="n">mf2</span><span class="p">)</span><span class="o">*</span><span class="p">(</span><span class="n">rho2</span><span class="o">/</span><span class="n">rho1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vf1</span>
        <span class="n">blocking_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">signalsBlocked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="n">vf1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">100.0</span><span class="o">*</span><span class="p">(</span><span class="mf">1.0</span><span class="o">-</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vf_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="n">blocking_state</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Update_vf_sb&quot;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;rho 1&quot;</span><span class="p">,</span> <span class="n">rho1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;rho 2&quot;</span><span class="p">,</span> <span class="n">rho2</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;vf 1 &quot;</span><span class="p">,</span> <span class="n">vf1</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_aoverb_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_aoverb_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_aoverb_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change to the a/b ratio for an ellipsoid.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The a/b ratio of the elllipsoid</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on_aoverb_le_changed&quot;</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Ellipsoid a/b&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_legend_le_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_legend_le_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_legend_le_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a legend change.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            The legend</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on legend change&quot;</span><span class="p">,</span> <span class="n">text</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_sigma_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_sigma_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_sigma_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a particle size distribution change.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The particle size distribution width in microns</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on sigma line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size distribution sigma(mu)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_size_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_size_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_size_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a particle size change.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The particle size in microns</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on size line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size(mu)&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_vf_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_vf_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_vf_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a volume fraction change, alter the mass fraction accordingly.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The volume fraction</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Start:: on_vf_sb_changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass or volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;volume&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">/</span><span class="mf">100.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: on_vf_sb_changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.update_mf_sb">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.update_mf_sb">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">update_mf_sb</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the mass fraction and according to the volume fraction.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Start:: update_mf_sb&quot;</span><span class="p">)</span>
        <span class="n">vf1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]</span>
        <span class="n">vf2</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">-</span> <span class="n">vf1</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">]</span>
        <span class="n">rho1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_density</span><span class="p">()</span>
        <span class="n">rho2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span>
        <span class="n">mf1</span> <span class="o">=</span> <span class="n">rho1</span><span class="o">*</span><span class="n">vf1</span> <span class="o">/</span> <span class="p">(</span> <span class="n">rho1</span><span class="o">*</span><span class="n">vf1</span> <span class="o">+</span> <span class="n">rho2</span><span class="o">*</span><span class="n">vf2</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">mf1</span>
        <span class="n">blocking_state</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">signalsBlocked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="n">mf1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mf_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="n">blocking_state</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Update_mf_sb&quot;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;rho 1&quot;</span><span class="p">,</span> <span class="n">rho1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;rho 2&quot;</span><span class="p">,</span> <span class="n">rho2</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;mf 1 &quot;</span><span class="p">,</span> <span class="n">mf1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: update_mf_sb&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_matrix_cb_activated">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_matrix_cb_activated">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_matrix_cb_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change to the support matrix supplied by the materials&#39; database.</span>

<span class="sd">        A refresh is flagged and the matrix name set from the combobox.</span>
<span class="sd">        QT signals are blocked while data is being updated.</span>
<span class="sd">        A material object is defined on the basis of the matrix name and the database</span>
<span class="sd">        A refresh is performed</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The index is not used but the associated text of the combobox is.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on matrix combobox activated&quot;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on matrix combobox activated&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="c1"># We will need to recalculate everything for a new support matrix</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># matrix is the name of the sheet in the database</span>
        <span class="n">matrix</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="c1"># Make some of the widgets quiet as we update them</span>
        <span class="n">m_blocking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">signalsBlocked</span><span class="p">()</span>
        <span class="n">d_blocking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">signalsBlocked</span><span class="p">()</span>
        <span class="n">r_blocking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">signalsBlocked</span><span class="p">()</span>
        <span class="n">i_blocking</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">signalsBlocked</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">if</span> <span class="s2">&quot;Material defined manually&quot;</span> <span class="ow">in</span> <span class="n">matrix</span><span class="p">:</span>
            <span class="c1"># The manual option has been chosen, so create a new material with the right permittivity and density</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="n">Materials</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;manual&quot;</span><span class="p">,</span><span class="n">permittivity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">],</span><span class="n">density</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">])</span>
            <span class="c1"># Store the new matrix material name</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">if</span> <span class="s2">&quot;Material defined manually&quot;</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">:</span>
                <span class="c1"># We don&#39;t need the manual entry any more</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">)</span>
            <span class="c1"># Read the material information for permittivity and density from the data base</span>
            <span class="n">matrixMaterial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getMaterial</span><span class="p">(</span><span class="n">matrix</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">matrixMaterial</span><span class="o">.</span><span class="n">isScalar</span><span class="p">():</span>
                <span class="c1"># Only change the matrix material if it is a scalar material</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="n">matrixMaterial</span>
                <span class="c1"># Store the new matrix material name</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">matrix</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: matrix material must have a scalar permittivity&quot;</span><span class="p">)</span>
        <span class="c1"># The permittivity may be frequency dependent, show the value at 0 cm-1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getPermittivityFunction</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getDensity</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">])</span>
        <span class="c1"># Update the matrix material information</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getInformation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_info_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="c1"># Update the values of the real and imaginary permittivity</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]))</span>
        <span class="c1"># This is a new material so reset the volume / mass fractions</span>
        <span class="c1"># volume fraction takes precedence</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass or volume fraction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;volume&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
        <span class="c1"># Restore the signal settings on the widgets</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="n">m_blocking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="n">d_blocking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="n">r_blocking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="n">i_blocking</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_density_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_density_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_density_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change to the matrix density.</span>

<span class="sd">        Changes in density cause changes in the volume and mass fractions.  </span>
<span class="sd">        These are calculated according to the mass or volume fraction having priority and the spinboxed updated.</span>
<span class="sd">        A refresh is forced</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The density</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="c1"># update the matrix density</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">setDensity</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="c1"># Force the matrix to be defined manually</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Material defined manually&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># volume fraction taked precedence</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass or volume fraction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;volume&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on density line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_bubble_vf_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_bubble_vf_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_bubble_vf_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change to the bubble volume fraction.</span>

<span class="sd">        A change in the bubble volume fraction causes changes in the volume and mass fractions</span>
<span class="sd">        These are calculated according to the mass or volume fraction having priority and the spinboxed updated.</span>
<span class="sd">        A refresh is forced</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The bubble volume fraction</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span><span class="o">/</span><span class="mf">100.0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass or volume fraction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;volume&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on bubble volume fraction changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_bubble_radius_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_bubble_radius_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_bubble_radius_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the bubble radius setting and mark refresh as required.</span>

<span class="sd">        This method updates the &#39;Bubble radius&#39; in the settings dictionary and marks the instance for refresh.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float </span>
<span class="sd">            The new value to update the bubble radius setting with.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble radius&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on bubble raduys line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_permittivity_i_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_permittivity_i_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_permittivity_i_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the imaginary part of the permittivity in the matrix material settings and trigger a refresh.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The new imaginary part of the permittivity to be set.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - Updates the imaginary part of the `Matrix permittivity` in the settings dictionary with the new value, keeping the real part unchanged.</span>
<span class="sd">        - Replaces the permittivity object of the matrix material with a new constant scalar permittivity object created using the updated `Matrix permittivity`.</span>
<span class="sd">        - Marks the matrix material as manually defined and triggers a required refresh to update any dependent calculations or displays.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">real</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">real</span><span class="p">,</span><span class="n">value</span><span class="p">)</span>
        <span class="n">newPermittivityObject</span> <span class="o">=</span> <span class="n">DielectricFunction</span><span class="o">.</span><span class="n">ConstantScalar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">setPermittivityObject</span><span class="p">(</span><span class="n">newPermittivityObject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Material defined manually&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on imaginary permittivity line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_permittivity_r_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_permittivity_r_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_permittivity_r_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the real part of the permittivity in the matrix material settings and refresh the material definition.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The new real value of the matrix permittivity to be set.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">imaginary</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">complex</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="n">imaginary</span><span class="p">)</span>
        <span class="n">newPermittivityObject</span> <span class="o">=</span> <span class="n">DielectricFunction</span><span class="o">.</span><span class="n">ConstantScalar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">setPermittivityObject</span><span class="p">(</span><span class="n">newPermittivityObject</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Material defined manually&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on permittivity line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_atr_index_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_atr_index_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_atr_index_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the change in settings for ATR material refractive index.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The new value for the ATR material refractive index.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This function updates the &#39;ATR material refractive index&#39; in the settings dictionary.</span>
<span class="sd">        - Marks the instance as requiring a refresh, possibly to update some UI elements or calculations.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR material refractive index&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on atr index line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_atr_incident_ang_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_atr_incident_ang_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_atr_incident_ang_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the update to the ATR incident angle situation.</span>

<span class="sd">        This method updates the ATR incident angle setting based on user inputs or changes. It also triggers an update to ensure the new settings are reflected across the application.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float or int</span>
<span class="sd">            The new value for the ATR incident angle.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR theta&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on atr incident angle line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.on_atr_spolfrac_sb_changed">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.on_atr_spolfrac_sb_changed">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">on_atr_spolfrac_sb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Update the ATR S polarisation fraction setting and request a refresh as required.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The new value for the ATR S polarisation fraction. </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This function updates the settings dictionary on the `self` object with the new value for the key &#39;ATR S polarisation fraction&#39;.</span>
<span class="sd">        - The refresh flag `self.refreshRequired` is set to `True` to indicate that some action is needed to reflect the change in the application.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR S polarisation fraction&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;on atr spolfraction line edit changed&quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.change_greyed_out">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.change_greyed_out">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">change_greyed_out</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># Have a look through the settings and see if we need to grey anything out</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Modify UI elements based on the selected effective medium method.</span>

<span class="sd">        This function updates the enabled status of UI elements such as size, sigma, and shape selection based on the currently selected effective medium method in the settings. It also updates the particle shape setting if necessary and adjusts the UI to reflect any changes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The method checks the &#39;Effective medium method&#39; and &#39;Particle shape&#39; in the settings.</span>
<span class="sd">        - For &#39;Mie&#39; and &#39;Anisotropic-Mie&#39; methods, it enables size and sigma spinboxes and sets the particle shape to &#39;Sphere&#39;, disabling all other shapes.</span>
<span class="sd">        - For &#39;Averaged Permittivity&#39;, it disables size and sigma spinboxes and sets the particle shape to &#39;Sphere&#39;.</span>
<span class="sd">        - For &#39;Maxwell-Garnett&#39; and &#39;Bruggeman&#39;, it enables the size spinbox and disables the sigma spinbox, allowing all shapes to be selected.</span>
<span class="sd">        - If the particle shape is set to &#39;Ellipsoid&#39;, &#39;Plate&#39;, or &#39;Needle&#39;, it enables direction (h, k, l) spinboxes and adjusts the display label accordingly. For &#39;Sphere&#39;, it disables these spinboxes.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Start:: change_greyed_out&quot;</span><span class="p">)</span>
        <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">(</span> <span class="s2">&quot;Mie&quot;</span><span class="p">,</span>  <span class="s2">&quot;Anisotropic-Mie&quot;</span> <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sphere&quot;</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Method index was not 0&quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">])</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="o">==</span> <span class="s2">&quot;Averaged Permittivity&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Sphere&quot;</span>
            <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span><span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">index</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">method</span> <span class="ow">in</span> <span class="p">(</span> <span class="s2">&quot;Maxwell-Garnett&quot;</span><span class="p">,</span> <span class="s2">&quot;Bruggeman&quot;</span> <span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shapes</span><span class="p">)):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># deal with shapes</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Ellipsoid&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hkl_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Unique direction [abc]&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Plate&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hkl_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Unique direction (hkl)&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Needle&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">hkl_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s2">&quot;Unique direction [abc]&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Sphere&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ScenarioTab: Shape not recognised&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">])</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: change_greyed_out&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.calculate">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.calculate">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vs_cm1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Calculate the powder absorption for the range of frequencies in vs_cm1.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vs_cm1 : array_like</span>
<span class="sd">            Array of frequencies for which to calculate the powder absorption.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        array_like</span>
<span class="sd">            The calculated powder absorption for the given range of frequencies.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># Only allow a calculation if the plottingTab is defined</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Start:: calculate&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: calculate - immediate return because calculationRequired false&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">plottingTab</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: calculate - immediate return because plottingTab unavailable&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: calculate - immediate return because reader unavailable&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;calculate - number of frequencies&quot;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">))</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">get_unit_cell</span><span class="p">()</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span>
        <span class="n">hkl</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - h&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - k&quot;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - l&quot;</span><span class="p">]]</span>
        <span class="k">if</span> <span class="n">shape</span> <span class="o">==</span> <span class="s2">&quot;Ellipsoid&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">convert_abc_to_xyz</span><span class="p">(</span><span class="n">hkl</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">depolarisation</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">initialise_ellipsoid_depolarisation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">aoverb</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s2">&quot;Plate&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">convert_hkl_to_xyz</span><span class="p">(</span><span class="n">hkl</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">depolarisation</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">initialise_plate_depolarisation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">shape</span> <span class="o">==</span> <span class="s2">&quot;Needle&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">convert_abc_to_xyz</span><span class="p">(</span><span class="n">hkl</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">depolarisation</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">initialise_needle_depolarisation_matrix</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">depolarisation</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">initialise_sphere_depolarisation_matrix</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span> <span class="p">[]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">direction</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">direction</span><span class="p">)</span>
        <span class="c1"># Get the crystal permittivity function from the settings tab</span>
        <span class="n">crystalPermittivity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">settingsTab</span><span class="o">.</span><span class="n">getCrystalPermittivity</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="c1"># Allocate space for the shared memory, we need twice as much as we have a complex data type</span>
        <span class="n">shared_array_base</span> <span class="o">=</span> <span class="n">Array</span><span class="p">(</span><span class="n">ctypes</span><span class="o">.</span><span class="n">c_double</span><span class="p">,</span> <span class="mi">18</span><span class="p">)</span>
        <span class="n">previous_solution_shared</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ctypeslib</span><span class="o">.</span><span class="n">as_array</span><span class="p">(</span><span class="n">shared_array_base</span><span class="o">.</span><span class="n">get_obj</span><span class="p">())</span>
        <span class="c1"># Convert the space allocated to complex</span>
        <span class="n">previous_solution_shared</span><span class="o">.</span><span class="n">dtype</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">complex128</span>
        <span class="c1"># Reshape the array and fill everything with zero&#39;s</span>
        <span class="n">previous_solution_shared</span> <span class="o">=</span> <span class="n">previous_solution_shared</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
        <span class="n">previous_solution_shared</span><span class="o">.</span><span class="n">fill</span><span class="p">(</span><span class="mf">0.0</span><span class="o">+</span><span class="mf">0.0</span><span class="n">j</span><span class="p">)</span>
        <span class="c1"># Prepare parallel call parameters for the loop over frequencies, methods, volume fractions</span>
        <span class="c1"># The concentration is defined in the plottingTab, which may not exist yet</span>
        <span class="n">concentration</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">plottingTab</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;cell concentration&quot;</span><span class="p">]</span>
        <span class="c1"># Set the material parameters</span>
        <span class="n">method</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">volume_fraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Volume fraction&quot;</span><span class="p">]</span>
        <span class="n">particle_size_mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size(mu)&quot;</span><span class="p">]</span>
        <span class="n">particle_sigma_mu</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size distribution sigma(mu)&quot;</span><span class="p">]</span>
        <span class="n">shape</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
        <span class="n">atr_refractive_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR material refractive index&quot;</span><span class="p">]</span>
        <span class="n">atr_theta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR theta&quot;</span><span class="p">]</span>
        <span class="n">atr_spolfraction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR S polarisation fraction&quot;</span><span class="p">]</span>
        <span class="n">bubble_vf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">]</span>
        <span class="n">bubble_radius</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble radius&quot;</span><span class="p">]</span>
        <span class="c1"># Use the pool of processors already available</span>
        <span class="c1"># define a partial function to use with the pool</span>
        <span class="n">partial_function</span> <span class="o">=</span> <span class="n">partial</span><span class="p">(</span><span class="n">Calculator</span><span class="o">.</span><span class="n">solve_effective_medium_equations</span><span class="p">,</span> <span class="n">method</span><span class="p">,</span><span class="n">volume_fraction</span><span class="p">,</span><span class="n">particle_size_mu</span><span class="p">,</span><span class="n">particle_sigma_mu</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span><span class="p">,</span><span class="n">shape</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">depolarisation</span><span class="p">,</span><span class="n">concentration</span><span class="p">,</span><span class="n">atr_refractive_index</span><span class="p">,</span><span class="n">atr_theta</span><span class="p">,</span><span class="n">atr_spolfraction</span><span class="p">,</span><span class="n">bubble_vf</span><span class="p">,</span><span class="n">bubble_radius</span><span class="p">,</span><span class="n">previous_solution_shared</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">startPool</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;About to use the pool to calculate effective medium equations&quot;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">result</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="n">partial_function</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">,</span><span class="n">crystalPermittivity</span><span class="p">),</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
            <span class="n">results</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">progressbars_update</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">realPermittivity</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">imagPermittivity</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">absorptionCoefficient</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molarAbsorptionCoefficient</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sp_atr</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Extracting results&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">_method</span><span class="p">,</span><span class="n">_size_mu</span><span class="p">,</span><span class="n">_size_sigma</span><span class="p">,</span><span class="n">_shape</span><span class="p">,</span><span class="n">_data</span><span class="p">,</span><span class="n">trace</span><span class="p">,</span><span class="n">absorption_coefficient</span><span class="p">,</span><span class="n">molar_absorption_coefficient</span><span class="p">,</span><span class="n">spatr</span> <span class="ow">in</span> <span class="n">results</span><span class="p">:</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">realPermittivity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">trace</span><span class="p">))</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">imagPermittivity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">trace</span><span class="p">))</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">absorptionCoefficient</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">absorption_coefficient</span><span class="p">)</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">molarAbsorptionCoefficient</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">molar_absorption_coefficient</span><span class="p">)</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">sp_atr</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">spatr</span><span class="p">)</span>
             <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">v</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: calculate&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>


<div class="viewcode-block" id="PowderScenarioTab.get_result">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.get_result">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_result</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vs_cm1</span><span class="p">,</span> <span class="n">plot_type</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return a result for plotting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vs_cm1 : list</span>
<span class="sd">            A list of frequencies in cm-1</span>
<span class="sd">        plot_type : str</span>
<span class="sd">            A string indicating the type of result to return.</span>
<span class="sd">            One of: &#39;Powder Molar Absorption&#39;, &#39;Powder Absorption&#39;, &#39;Powder Real Permittivity&#39;, &#39;Powder Imaginary Permittivity&#39;, &#39;Powder ATR&#39;</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        list</span>
<span class="sd">            A list of the required results.</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Start:: get_result&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">get_results</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: get_result&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="p">{</span> <span class="s2">&quot;Powder Molar Absorption&quot;</span>      <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">molarAbsorptionCoefficient</span><span class="p">,</span>
                 <span class="s2">&quot;Powder Absorption&quot;</span>            <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">absorptionCoefficient</span><span class="p">,</span>
                 <span class="s2">&quot;Powder Real Permittivity&quot;</span>     <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">realPermittivity</span><span class="p">,</span>
                 <span class="s2">&quot;Powder Imaginary Permittivity&quot;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">imagPermittivity</span><span class="p">,</span>
                 <span class="s2">&quot;Powder ATR&quot;</span>                   <span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">sp_atr</span> 
                <span class="p">}</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">plot_type</span><span class="p">)</span></div>



<div class="viewcode-block" id="PowderScenarioTab.get_results">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.get_results">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">get_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">vs_cm1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Return the results of the effective medium theory calculation.</span>

<span class="sd">        This routine jut causes a refresh and calculation if it is needed.</span>
<span class="sd">        See get_result() for accessing the results themselves</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vs_cm1 : list</span>
<span class="sd">            A list of frequencies in cm-1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Start:: get_results&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">))</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vs_cm1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vs_cm1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;get_results recalculating&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;get_results no need for recalculation&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">progressbars_update</span><span class="p">(</span><span class="n">increment</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">))</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: get_results&quot;</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">))</span>
        <span class="k">return</span></div>



<div class="viewcode-block" id="PowderScenarioTab.refresh">
<a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html#PDielec.GUI.PowderScenarioTab.PowderScenarioTab.refresh">[docs]</a>
    <span class="k">def</span><span class="w"> </span><span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh the GUI interface with up to date values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force : bool</span>
<span class="sd">            If True, then a refresh is forced regardless of the state of the scenario.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Start:: refresh, force =&quot;</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: refresh aborted&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span><span class="p">,</span><span class="n">force</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># Force a recalculation</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># First see if we can get the reader from the mainTab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">reader</span>
        <span class="c1">#</span>
        <span class="c1"># Block signals during refresh</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Update the database </span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Materials database&quot;</span><span class="p">]</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getFileName</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span> <span class="o">=</span> <span class="n">MaterialsDataBase</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Materials database&quot;</span><span class="p">],</span><span class="n">debug</span><span class="o">=</span><span class="n">debugger</span><span class="o">.</span><span class="n">state</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Materials database&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getFileName</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">database_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Materials database&quot;</span><span class="p">])</span>
            <span class="c1"># Update the possible  material names from the database</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getSheetNames</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;Material defined manually&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialDefinedManually</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Material defined manually&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="n">Materials</span><span class="o">.</span><span class="n">Constant</span><span class="p">(</span><span class="s2">&quot;manual&quot;</span><span class="p">,</span><span class="n">permittivity</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">],</span><span class="n">density</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getPermittivityFunction</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">DataBase</span><span class="o">.</span><span class="n">getMaterial</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getPermittivityFunction</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixPermittivityFunction</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getDensity</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error: matrix &quot;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">],</span><span class="s2">&quot; not available in database&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;       available materials are:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">)</span>
            <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">()</span>
        <span class="c1"># Reset the matrix combo box with new names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">materialNames</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="c1"># Update the matrix material information</span>
        <span class="n">text</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matrixMaterial</span><span class="o">.</span><span class="n">getInformation</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matrix_info_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="n">text</span><span class="p">)</span>
        <span class="c1"># Set the matrix density widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">density_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix density&quot;</span><span class="p">])</span>
        <span class="c1"># Set the matrix permittivity widget</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_r_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">permittivity_i_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Matrix permittivity&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_vf_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble volume fraction&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">bubble_radius_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bubble radius&quot;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Mass or volume fraction&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;volume&quot;</span><span class="p">:</span>
            <span class="c1"># volume fraction takes precedence</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># mass fraction takes precedence</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_vf_sb</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">update_mf_sb</span><span class="p">()</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Effective medium method&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">methods_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">size_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size(mu)&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle size distribution sigma(mu)&quot;</span><span class="p">])</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Particle shape&quot;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">h_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - h&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">k_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - k&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">l_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Unique direction - l&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Ellipsoid a/b&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legend_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">aoverb</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Ellipsoid a/b&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_index_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR material refractive index&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_incident_ang_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR theta&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">atr_spolfrac_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;ATR S polarisation fraction&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">change_greyed_out</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># Unblock signals after refresh</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Legend&quot;</span><span class="p">],</span><span class="s2">&quot;Finished:: refresh, force =&quot;</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
        <span class="k">return</span></div>
</div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, John Kendrick and Andrew Burnett
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script src="../../../_static/documentation_options.js?v=0b13d40c"></script>
    <script src="../../../_static/doctools.js?v=9bcbadda"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../../_static/scripts/furo.js?v=5fa4622c"></script>
    </body>
</html>