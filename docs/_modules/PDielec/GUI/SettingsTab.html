<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>PDielec.GUI.SettingsTab - PDielec: John Kendrick &amp; Andrew Burnett</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2e0a580d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">PDielec: John Kendrick & Andrew Burnett</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">PDielec: John Kendrick & Andrew Burnett</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pdgui.html">PDGui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software.html">Other Software Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_powder.html">Theory for Light Scattering from Powders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_single_crystal.html">Theory for Single Crystal Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analysis.html">Phonon Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_1.html">Applications of Effective Medium Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_2.html">Single Crystal Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../autoapi/PDielec/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of PDielec</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PDielec/GUI/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of PDielec.GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.AnalysisTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/App/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.App</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/FitterTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.FitterTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/MainTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.MainTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/NoteBook/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.NoteBook</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/OpenGLWidget/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.OpenGLWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PlottingTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PowderScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SettingsTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalLayer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SpreadSheetManager/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SpreadSheetManager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ViewerTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ViewerTab</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/AbinitOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.AbinitOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Calculator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Calculator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CastepOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CastepOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Constants/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Constants</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CrystalOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CrystalOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/DielectricFunction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.DielectricFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/ExperimentOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.ExperimentOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GTMcore/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GTMcore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GenericOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GenericOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GulpOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GulpOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/HelperRoutines/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.HelperRoutines</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/IO/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.IO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Materials/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Materials</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Mie/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Mie</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/PhonopyOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.PhonopyOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Plotter/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Plotter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/QEOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.QEOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/SuperCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.SuperCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/UnitCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.UnitCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Utilities/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Utilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/VaspOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.VaspOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkcsv/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkcsv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkexcel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkexcel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/graphdatagenerator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.graphdatagenerator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p1reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p1reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p2cif/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p2cif</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdcompare/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pickled_reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pickled_reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/vibanalysis/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.vibanalysis</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../zreferences.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for PDielec.GUI.SettingsTab</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright 2024 John Kendrick &amp; Andrew Burnett</span>
<span class="c1">#</span>
<span class="c1"># This file is part of PDielec</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the MIT License</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the MIT License along with this program, if not see https://opensource.org/licenses/MIT</span>
<span class="c1">#</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">SettingsTab module</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="c1"># -*- coding: utf8 -*-</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">PDielec.Calculator</span> <span class="k">as</span> <span class="nn">Calculator</span>
<span class="kn">import</span> <span class="nn">PDielec.DielectricFunction</span> <span class="k">as</span>  <span class="nn">DielectricFunction</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>            <span class="kn">import</span>  <span class="n">QWidget</span><span class="p">,</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>            <span class="kn">import</span>  <span class="n">QComboBox</span><span class="p">,</span> <span class="n">QLabel</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>            <span class="kn">import</span>  <span class="n">QCheckBox</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtGui</span>                <span class="kn">import</span>  <span class="n">QFont</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>            <span class="kn">import</span>  <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QFormLayout</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>            <span class="kn">import</span>  <span class="n">QDoubleSpinBox</span><span class="p">,</span> <span class="n">QTableWidget</span><span class="p">,</span> <span class="n">QTableWidgetItem</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>            <span class="kn">import</span>  <span class="n">QSizePolicy</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span>               <span class="kn">import</span>  <span class="n">Qt</span><span class="p">,</span> <span class="n">QSize</span><span class="p">,</span> <span class="n">QCoreApplication</span>
<span class="kn">from</span> <span class="nn">PDielec.Constants</span>          <span class="kn">import</span>  <span class="n">wavenumber</span><span class="p">,</span> <span class="n">amu</span><span class="p">,</span> <span class="n">angstrom</span>
<span class="kn">from</span> <span class="nn">PDielec.Constants</span>          <span class="kn">import</span>  <span class="n">average_masses</span><span class="p">,</span> <span class="n">isotope_masses</span>
<span class="kn">from</span> <span class="nn">PDielec.Utilities</span>          <span class="kn">import</span>  <span class="n">Debug</span>
<span class="kn">from</span> <span class="nn">functools</span>                  <span class="kn">import</span>  <span class="n">partial</span>

<div class="viewcode-block" id="FixedQTableWidget"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.FixedQTableWidget">[docs]</a><span class="k">class</span> <span class="nc">FixedQTableWidget</span><span class="p">(</span><span class="n">QTableWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A custom QTableWidget with fixed number of rows and columns.</span>

<span class="sd">    This widget is designed to have a fixed size based on a specified number of rows and columns, rather than adjusting dynamically to the content it displays. If the number of rows and columns isn&#39;t specifically provided, it defaults to the current count of rows and columns in the widget.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    args</span>
<span class="sd">        Variable length argument list.</span>
<span class="sd">    parent : Optional[QWidget]</span>
<span class="sd">        The parent widget. Default is None.</span>
<span class="sd">    rows : Optional[int]</span>
<span class="sd">        The fixed number of rows for the table. If None, the table&#39;s row count is used. Default is None.</span>
<span class="sd">    columns : Optional[int]</span>
<span class="sd">        The fixed number of columns for the table. If None, the table&#39;s column count is used. Default is None.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    sizeHint()</span>
<span class="sd">        Calculates and returns the recommended size for the table widget based on the fixed number of rows and columns, or based on its current row and column counts if no fixed numbers are provided.</span>

<span class="sd">    See Also</span>
<span class="sd">    --------</span>
<span class="sd">    QTableWidget : The base class from which this class is derived.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">parent</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initialize a QTableWidget instance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        args</span>
<span class="sd">            Variable length argument list passed to the super class initializer.</span>
<span class="sd">        parent : optional</span>
<span class="sd">            The parent widget of the QTableWidget. Default is None.</span>
<span class="sd">        rows : int, optional</span>
<span class="sd">            The initial number of rows in the table. Default is None.</span>
<span class="sd">        columns : int, optional</span>
<span class="sd">            The initial number of columns in the table. Default is None.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="n">columns</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">=</span> <span class="n">rows</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">QTableWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>

<div class="viewcode-block" id="FixedQTableWidget.sizeHint"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.FixedQTableWidget.sizeHint">[docs]</a>    <span class="k">def</span> <span class="nf">sizeHint</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the suggested dimensions for the widget based on its content.</span>

<span class="sd">        This method calculates the preferred size of the widget by summing up the widths of all columns and the heights of all rows, including any scrollbars, headers, and frame widths.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        QSize</span>
<span class="sd">            The calculated size that suggests the optimal dimensions for the widget. The width is determined by the total width of all columns, the vertical header width, the vertical scrollbar width, and twice the frame width. The height is determined by the total height of all rows, the horizontal header height, the horizontal scrollbar height, and twice the frame width.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">width</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columnCount</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">columns</span><span class="p">):</span>
            <span class="n">width</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">columnWidth</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">width</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="n">width</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="n">width</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frameWidth</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span>
        <span class="n">height</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rowCount</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">rows</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rows</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">rows</span><span class="p">):</span>
            <span class="n">height</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">rowHeight</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">height</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">verticalHeader</span><span class="p">()</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">width</span><span class="p">()</span>
        <span class="n">height</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">horizontalScrollBar</span><span class="p">()</span><span class="o">.</span><span class="n">sizeHint</span><span class="p">()</span><span class="o">.</span><span class="n">height</span><span class="p">()</span>
        <span class="n">height</span> <span class="o">+=</span> <span class="bp">self</span><span class="o">.</span><span class="n">frameWidth</span><span class="p">()</span><span class="o">*</span><span class="mi">2</span>
        <span class="k">return</span> <span class="n">QSize</span><span class="p">(</span><span class="n">width</span><span class="p">,</span><span class="n">height</span><span class="p">)</span></div></div>

<div class="viewcode-block" id="SettingsTab"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab">[docs]</a><span class="k">class</span> <span class="nc">SettingsTab</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class for managing and displaying settings related to optical permittivity, mass calculation, and vibrational calculations for crystal structures within a GUI application.</span>

<span class="sd">    This class allows for the configuration of various simulation parameters, such as Eckart conditions, Born charge neutrality, atomic mass definitions, and optical permittivity values. It also enables the calculation of infrared intensities, dielectric functions, and permittivity values based on these settings.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : QWidget</span>
<span class="sd">        The parent widget (container) of this widget.</span>
<span class="sd">    debug : bool, optional</span>
<span class="sd">        Flag indicating whether debugging messages should be printed. Defaults to False.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    notebook : parent</span>
<span class="sd">        The notebook widget that contains this settings tab.</span>
<span class="sd">    refreshRequired : bool</span>
<span class="sd">        A flag indicating whether the displayed information needs to be refreshed.</span>
<span class="sd">    calculationRequired : bool</span>
<span class="sd">        A flag indicating whether new calculations are needed based on the current settings.</span>
<span class="sd">    settings : dict</span>
<span class="sd">        A dictionary of settings related to calculations. Includes flags for Eckart conditions, Born charge neutrality, mass definition, and sigma values.</span>
<span class="sd">    mass_definition_options : list</span>
<span class="sd">        A list of options for defining atomic masses.</span>
<span class="sd">    masses_dictionary : dict</span>
<span class="sd">        A dictionary where keys are element symbols and values are the corresponding atomic masses.</span>
<span class="sd">    modes_selected : list</span>
<span class="sd">        A list indicating which vibrational modes are selected for calculations.</span>
<span class="sd">    frequencies_cm1 : list</span>
<span class="sd">        A list of vibrational frequencies in cm^-1.</span>
<span class="sd">    frequencies_have_been_edited : bool</span>
<span class="sd">        A flag indicating if frequencies have been manually edited.</span>
<span class="sd">    intensities : list</span>
<span class="sd">        A list of calculated infrared intensities for the vibrational modes.</span>
<span class="sd">    sigmas_cm1 : list</span>
<span class="sd">        A list of Lorentzian width factors (Ïƒ) in cm^-1 for the vibrational modes.</span>
<span class="sd">    oscillator_strengths : list</span>
<span class="sd">        A list of oscillator strengths calculated for the vibrational modes.</span>
<span class="sd">    mass_weighted_normal_modes : np.ndarray</span>
<span class="sd">        An array of mass-weighted normal modes.</span>
<span class="sd">    CrystalPermittivityObject : DielectricFunction</span>
<span class="sd">        An object for calculating dielectric functions.</span>
<span class="sd">    vs_cm1 : list</span>
<span class="sd">        A list of frequencies in cm^-1 at which the crystal permittivity is calculated.</span>
<span class="sd">    crystal_permittivity : list</span>
<span class="sd">        A list of calculated crystal permittivity values.</span>
<span class="sd">    recalculate_selected_modes : bool</span>
<span class="sd">        A flag indicating whether selected modes should be recalculated.</span>
<span class="sd">    reader : object</span>
<span class="sd">        A reader object from the parent notebook, used for accessing and manipulating input data.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    setElementMass(element, mass)</span>
<span class="sd">        Sets the mass for a specified element.</span>
<span class="sd">    createIntensityTable()</span>
<span class="sd">        Creates a table displaying calculated intensities for selected vibrational modes.</span>
<span class="sd">    requestRefresh()</span>
<span class="sd">        Requests a refresh of displayed data.</span>
<span class="sd">    writeSpreadsheet()</span>
<span class="sd">        Writes the current settings and calculated values to a spreadsheet.</span>
<span class="sd">    redraw_output_tw()</span>
<span class="sd">        Redraws the output table widget with updated values.</span>
<span class="sd">    on_sigma_changed()</span>
<span class="sd">        Handles changes to the sigma value.</span>
<span class="sd">    on_mass_cb_activated(index)</span>
<span class="sd">        Activates the specified mass definition option based on the selected index.</span>
<span class="sd">    set_masses_tw()</span>
<span class="sd">        Sets the masses in the table widget based on the current mass definition setting.</span>
<span class="sd">    on_output_tw_itemChanged(item)</span>
<span class="sd">        Handles changes to items in the output table widget.</span>
<span class="sd">    on_element_masses_tw_itemClicked(item)</span>
<span class="sd">        Handles item clicks in the element masses table widget.</span>
<span class="sd">    on_element_masses_tw_itemChanged(item)</span>
<span class="sd">        Handles changes to items in the element masses table widget.</span>
<span class="sd">    on_optical_tw_itemChanged(item)</span>
<span class="sd">        Handles changes to items in the optical permittivity table widget.</span>
<span class="sd">    on_optical_tw_itemClicked(item)</span>
<span class="sd">        Handles item clicks in the optical permittivity table widget.</span>
<span class="sd">    refresh(force=False)</span>
<span class="sd">        Refreshes the displayed information and recalculates values if necessary.</span>
<span class="sd">    refresh_optical_permittivity_tw()</span>
<span class="sd">        Refreshes the displayed optical permittivity values in the table widget.</span>
<span class="sd">    set_optical_permittivity_tw()</span>
<span class="sd">        Sets the optical permittivity values based on reader data.</span>
<span class="sd">    on_born_changed()</span>
<span class="sd">        Handles changes to the Born charge neutrality setting.</span>
<span class="sd">    on_eckart_changed()</span>
<span class="sd">        Handles changes to the Eckart condition setting.</span>
<span class="sd">    calculate(vs_cm1)</span>
<span class="sd">        Calculates the permittivity of the crystal over the specified range of frequencies.</span>
<span class="sd">    getCrystalPermittivity(vs_cm1)</span>
<span class="sd">        Returns the crystal permittivity for the specified frequencies.</span>
<span class="sd">    getCrystalPermittivityObject()</span>
<span class="sd">        Returns the crystal permittivity object used for calculations.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the QWidget object with specific settings for an application.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent : QWidget</span>
<span class="sd">            The parent widget (container) of this widget.</span>
<span class="sd">        debug : bool, optional</span>
<span class="sd">            Flag indicating whether debugging messages should be printed. Defaults to False.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method sets up various elements of the interface, including checkboxes, comboBoxes, spinBoxes, and tableWidgets with predefined settings and connects various signals and slots. Settings related to the Eckart flag, neutral Born charges, sigma values, mass definition, and optical permittivity are initialized. Additionally, UI elements for adjusting these settings are created. It involves initializing debugging capabilities, setting up a notebook reference, and various flags and settings necessary for the functionality of the application.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">(</span><span class="n">QWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">global</span> <span class="n">debugger</span>
        <span class="n">debugger</span> <span class="o">=</span> <span class="n">Debug</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span> <span class="s1">&#39;SettingsTab:&#39;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: initialisation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Eckart flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Neutral Born charges&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Sigma value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_definition_options</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;average&#39;</span><span class="p">,</span><span class="s1">&#39;program&#39;</span><span class="p">,</span><span class="s1">&#39;isotope&#39;</span><span class="p">,</span><span class="s1">&#39;gui&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;average&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity edited&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_have_been_edited</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intensities</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">oscillator_strengths</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_weighted_normal_modes</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CrystalPermittivityObject</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crystal_permittivity</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># get the reader from the main tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">reader</span>
        <span class="c1"># Create second tab - SettingsTab</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># The eckart checkbox</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Applying Eckart conditions ensures three zero translation mode)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">setLayoutDirection</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightToLeft</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Eckart flag&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_eckart_changed</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Apply Eckart conditions?&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Add the Born neutral condition</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span> <span class="o">=</span> <span class="n">QCheckBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Applying Born charge neutrality ensures unit cell has zero charge&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">setLayoutDirection</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">RightToLeft</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Neutral Born charges&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">stateChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_born_changed</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Apply Born charge neutrality?&#39;</span><span class="p">,</span><span class="bp">self</span><span class="p">),</span><span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># The mass definition combobox</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;The atomic masses used to calculate frequencies and intensities can be give here&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Average natural abundance&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Mass taken from QM/MM program&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Most common isotope mass&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">addItem</span><span class="p">(</span><span class="s1">&#39;Masses set individually&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># set default to average natural abundance</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_mass_cb_activated</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_mass_definition_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_definition_options</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Atomic mass defintion:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="p">)</span>
        <span class="c1"># Create Table containing the masses - block signals until the table is loaded</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span> <span class="o">=</span> <span class="n">FixedQTableWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Individual element masses can be modified here&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">itemClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_element_masses_tw_itemClicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">itemChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_element_masses_tw_itemChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">sizePolicy</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Atomic masses&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># The lorentzian width - sigma</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">100.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Sigma value&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the default Lorentzian width factor (Ïƒ) in cm-1&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_sigma_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Lorentzian width (Ïƒ):&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the default Lorentzian width factor (Ïƒ) in cm-1&#39;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Create the Optical permittivity table widget and block signals until a click on the widget</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span> <span class="o">=</span> <span class="n">FixedQTableWidget</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;The optical permittivity is taken from the calculation where this is possible.  If it is not availble suitbale values should be provided here&#39;</span><span class="p">)</span>
        <span class="c1"># Set the header names</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">setVerticalHeaderLabels</span>  <span class="p">([</span><span class="s1">&#39;x&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">,</span><span class="s1">&#39;z&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">itemClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_optical_tw_itemClicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">itemChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_optical_tw_itemChanged</span><span class="p">)</span>
        <span class="c1"># Block the widget until the optical permittivity is loaded</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">sizePolicy</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Optical permittivity:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
        <span class="c1"># output window</span>
        <span class="c1"># Create Table containing the IR active modes</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span> <span class="o">=</span> <span class="n">FixedQTableWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Output showing the frequencies and strengths of the IR active modes only&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">itemChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_output_tw_itemChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="p">)</span>
        <span class="c1"># finalise the layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: initialisation&#39;</span><span class="p">)</span>

<div class="viewcode-block" id="SettingsTab.setElementMass"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.setElementMass">[docs]</a>    <span class="k">def</span> <span class="nf">setElementMass</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">element</span><span class="p">,</span><span class="n">mass</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the mass value of a specific element in the GUI.</span>

<span class="sd">        This method updates the mass value for a specified element in the graphical user interface (GUI). It also triggers various updates in the GUI to reflect this change, including updating the mass selection and recalculating modes if required.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        element : str</span>
<span class="sd">            The element whose mass is to be set.</span>
<span class="sd">        mass : float</span>
<span class="sd">            The mass value to set for the specified element.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This method assumes that `self.settings`, `self.masses_dict`, `self.mass_cb`, and other related attributes are already defined in the class.</span>
<span class="sd">        - It triggers a refresh of the GUI and potentially recalculates selected modes based on the new mass settings.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start::  setElementMass&#39;</span><span class="p">,</span><span class="n">element</span><span class="p">,</span><span class="n">mass</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gui&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masses_dict</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_masses_tw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished::  setElementMass&#39;</span><span class="p">,</span><span class="n">element</span><span class="p">,</span><span class="n">mass</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.createIntensityTable"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.createIntensityTable">[docs]</a>    <span class="k">def</span> <span class="nf">createIntensityTable</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Generate the intensity table for spectroscopy analysis.</span>

<span class="sd">        This method is responsible for creating a table that includes calculated intensities, frequencies, oscillator strengths, </span>
<span class="sd">        and other related parameters required for spectroscopic analysis. It adapts based on reader settings, mass definitions, </span>
<span class="sd">        and whether to recalculate selected modes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method relies on several external variables and settings, including:</span>
<span class="sd">        - reader settings for neutralizing or resetting born charges</span>
<span class="sd">        - mass definition settings to determine how masses are handled in calculations</span>
<span class="sd">        - a check on if frequencies have been edited, which affects reading directly from the reader or not</span>
<span class="sd">        - uses `Calculator` class methods to compute normal modes, oscillator strengths, infrared intensities, and ionic permittivity</span>
<span class="sd">        - the method also determines the dielectric function based on the configuration and recalculates selected modes if necessary</span>
<span class="sd">        - it finally populates a provided table widget (`self.output_tw`) with computed spectroscopic properties</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        - `Calculator.normal_modes`: For calculation of normal modes.</span>
<span class="sd">        - `Calculator.oscillator_strengths`: For calculating oscillator strengths based on normal modes and born charges.</span>
<span class="sd">        - `Calculator.infrared_intensities`: For the calculation of infrared intensities from oscillator strengths.</span>
<span class="sd">        - `Calculator.ionic_permittivity`: For calculating the ionic permittivity based on mode list, oscillator strengths, and frequencies.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: createIntensityTable&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">reader</span>
        <span class="c1"># Only calculate if the reader is set</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;createIntensityTable aborting as now reader available&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Neutral Born charges&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">neutralise_born_charges</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">reset_born_charges</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">eckart</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Eckart flag&#39;</span><span class="p">]</span>
        <span class="n">mass_dictionary</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">reset_masses</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">change_masses</span><span class="p">(</span><span class="n">average_masses</span><span class="p">,</span> <span class="n">mass_dictionary</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;program&#39;</span><span class="p">:</span>
            <span class="k">pass</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;isotope&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">change_masses</span><span class="p">(</span><span class="n">isotope_masses</span><span class="p">,</span> <span class="n">mass_dictionary</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gui&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">change_masses</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">,</span> <span class="n">mass_dictionary</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Error unkown mass definition&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_weighted_normal_modes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">calculate_mass_weighted_normal_modes</span><span class="p">()</span>
        <span class="c1"># convert cm-1 to au</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_have_been_edited</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">frequencies</span>
        <span class="n">frequencies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">)</span> <span class="o">*</span> <span class="n">wavenumber</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Sigma value&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span> <span class="p">]</span>
        <span class="n">born_charges</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">born_charges</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="s1">&#39;Experimental output&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oscillator_strengths</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">oscillator_strengths</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#</span>
            <span class="c1"># calculate normal modes in xyz coordinate space</span>
            <span class="n">masses</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">masses</span><span class="p">)</span> <span class="o">*</span> <span class="n">amu</span>
            <span class="n">normal_modes</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">normal_modes</span><span class="p">(</span><span class="n">masses</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_weighted_normal_modes</span><span class="p">)</span>
            <span class="c1"># from the normal modes and the born charges calculate the oscillator strengths of each mode</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">oscillator_strengths</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">oscillator_strengths</span><span class="p">(</span><span class="n">normal_modes</span><span class="p">,</span> <span class="n">born_charges</span><span class="p">)</span>
        <span class="c1"># calculate the intensities from the trace of the oscillator strengths</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">intensities</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">infrared_intensities</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">oscillator_strengths</span><span class="p">)</span>
        <span class="c1"># Decide which modes to select</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">intensities</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;createIntensityTable: recalculating selected modes&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,(</span><span class="n">f</span><span class="p">,</span><span class="n">intensity</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">intensities</span><span class="p">)):</span>
                <span class="k">if</span> <span class="n">f</span> <span class="o">&gt;</span> <span class="mf">10.0</span> <span class="ow">and</span> <span class="n">intensity</span> <span class="o">&gt;</span> <span class="mf">1.0E-6</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">mode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span><span class="p">]</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Selected modes are;&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># end if</span>
        <span class="c1">#</span>
        <span class="c1"># Calculate the ionic contribution to the permittivity</span>
        <span class="n">frequencies_au</span> <span class="o">=</span> <span class="n">wavenumber</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">)</span>
        <span class="n">volume_au</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">volume</span><span class="o">*</span><span class="n">angstrom</span><span class="o">*</span><span class="n">angstrom</span><span class="o">*</span><span class="n">angstrom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_ionic</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">ionic_permittivity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oscillator_strengths</span><span class="p">,</span> <span class="n">frequencies_au</span><span class="p">,</span> <span class="n">volume_au</span> <span class="p">)</span>
        <span class="c1"># Make an np array of epsilon infinity</span>
        <span class="n">epsilon_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity&#39;</span><span class="p">])</span>
        <span class="c1">#</span>
        <span class="c1"># If the reader already has a Dielectric Constant then use this</span>
        <span class="c1">#</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">CrystalPermittivity</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CrystalPermittivityObject</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">CrystalPermittivity</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># Otherwise create one from the data that has been read in</span>
            <span class="n">drude</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">drude_plasma_au</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">drude_sigma_au</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="n">sigmas_au</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">)</span><span class="o">*</span><span class="n">wavenumber</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;CreateIntensityTable: Calculating dielectric&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">CrystalPermittivityObject</span> <span class="o">=</span> <span class="n">DielectricFunction</span><span class="o">.</span><span class="n">DFT</span><span class="p">(</span>
                                         <span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span><span class="p">,</span> <span class="n">frequencies_au</span><span class="p">,</span> <span class="n">sigmas_au</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">oscillator_strengths</span><span class="p">,</span>
                                         <span class="n">volume_au</span><span class="p">,</span> <span class="n">drude</span><span class="p">,</span> <span class="n">drude_plasma_au</span><span class="p">,</span> <span class="n">drude_sigma_au</span> <span class="p">)</span>
        <span class="c1"># Add the optical permittivity to the dielctric function</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">CrystalPermittivityObject</span><span class="o">.</span><span class="n">setEpsilonInfinity</span><span class="p">(</span><span class="n">epsilon_inf</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Prepare to finish</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">([</span><span class="s1">&#39;   Sigma   </span><span class="se">\n</span><span class="s1">(cm-1)&#39;</span><span class="p">,</span> <span class="s1">&#39; Frequency </span><span class="se">\n</span><span class="s1">(cm-1)&#39;</span><span class="p">,</span> <span class="s1">&#39;  Intensity  </span><span class="se">\n</span><span class="s1">(Debye2/Ã…2/amu)&#39;</span><span class="p">,</span> <span class="s1">&#39;Integrated Molar Absorption</span><span class="se">\n</span><span class="s1">(L/mole/cm2)&#39;</span><span class="p">,</span> <span class="s1">&#39;Absorption maximum</span><span class="se">\n</span><span class="s1">(L/mole/cm)&#39;</span><span class="p">])</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_output_tw</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="c1"># if self.notebook.spreadsheet is not None:</span>
        <span class="c1">#     self.writeSpreadsheet()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: createIntensityTable&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.requestRefresh"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.requestRefresh">[docs]</a>    <span class="k">def</span> <span class="nf">requestRefresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request to refresh the environment or state.</span>

<span class="sd">        This method sets a flag to indicate that a refresh is required, logging the start and end of its execution.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: requestRefresh&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># self.refresh()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: requestRefresh&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.writeSpreadsheet"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.writeSpreadsheet">[docs]</a>    <span class="k">def</span> <span class="nf">writeSpreadsheet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the configuration and calculation results to the associated spreadsheet.</span>

<span class="sd">        This function iterates through various settings and results stored within the object, such as optical permittivity, mass definitions, and vibrational mode calculations. For each setting or result, it writes the relevant information to a new row in the spreadsheet. The spreadsheet is expected to have a &#39;Settings&#39; worksheet, which this function selects and updates with the provided values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: writeSpreadsheet&#39;</span><span class="p">)</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">spreadsheet</span>
        <span class="k">if</span> <span class="n">sp</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: writeSpreadsheet - Aborting write of spreadsheet&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Writing of spreadsheet&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">selectWorkSheet</span><span class="p">(</span><span class="s1">&#39;Settings&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">delete</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Settings and calculations of frequencies and absorption&#39;</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;Optical permittivity&#39;</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">item</span><span class="p">]</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="n">item</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">0</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">1</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">item</span><span class="p">][</span><span class="mi">2</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_ionic</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Ionic Contribution to permittivity at zero frequency&#39;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">eps</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">epsilon_ionic</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">item</span><span class="p">])</span>
               <span class="n">eps</span> <span class="o">=</span> <span class="n">eps</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Total Contribution to permittivity at zero frequency&#39;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">item</span> <span class="o">==</span> <span class="s1">&#39;Mass definition&#39;</span><span class="p">:</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="n">item</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">item</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
               <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">:</span>
                   <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="n">c</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">c</span><span class="p">]],</span><span class="n">col</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
               <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="n">item</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="n">item</span><span class="p">]],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Mode&#39;</span><span class="p">,</span><span class="s1">&#39;Include?&#39;</span><span class="p">,</span><span class="s1">&#39;Sigma(cm-1)&#39;</span><span class="p">,</span><span class="s1">&#39;Frequency(cm-1)&#39;</span><span class="p">,</span><span class="s1">&#39;Intensity(Debye2/Angs2/amu&#39;</span><span class="p">,</span><span class="s1">&#39;Integrated Molar Absorption(/L/mole/cm2&#39;</span><span class="p">,</span><span class="s1">&#39;Absorption maximum (L/mole/cm)&#39;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">mode</span><span class="p">,(</span><span class="n">f</span><span class="p">,</span><span class="n">intensity</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">selected</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensities</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="p">)):</span>
            <span class="n">yn</span> <span class="o">=</span> <span class="s1">&#39;No&#39;</span>
            <span class="k">if</span> <span class="n">selected</span><span class="p">:</span>
                <span class="n">yn</span> <span class="o">=</span> <span class="s1">&#39;Yes&#39;</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="n">mode</span><span class="p">,</span> <span class="n">yn</span><span class="p">,</span> <span class="n">sigma</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="n">intensity</span><span class="p">,</span> <span class="mf">4225.6</span><span class="o">*</span><span class="n">intensity</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><span class="mf">4225.6</span><span class="o">*</span><span class="n">intensity</span><span class="o">/</span><span class="n">sigma</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: writeSpreadsheet&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.redraw_output_tw"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.redraw_output_tw">[docs]</a>    <span class="k">def</span> <span class="nf">redraw_output_tw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Redraws the output table widget with updated values.</span>

<span class="sd">        This method loops through frequencies, sigmas, and intensities, updating the table widget rows</span>
<span class="sd">        with new items representing these values and custom flags for item behavior. It also calculates</span>
<span class="sd">        and displays additional derived values in the table. Selection flags for each item are set</span>
<span class="sd">        based on whether the mode is selected or not. The table&#39;s columns are resized to content at the end.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This method assumes that `self.frequencies_cm1`, `self.sigmas_cm1`, `self.intensities`, and `self.modes_selected` contain iterable values that are indexed correspondingly.</span>
<span class="sd">        - The method temporarily blocks signals from `self.output_tw` to prevent unwanted signal handling during updates.</span>
<span class="sd">        - Table item flags are set to control their selectability, checkability, editability, and enablement based on whether the corresponding mode is selected.</span>
<span class="sd">        - After updating, it ensures the table columns fit the content and re-enables the signals.</span>
<span class="sd">        - Uses `Qt` enumeration for setting check state, item flags, and text alignment.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: redraw_output_tw&#39;</span><span class="p">)</span>
        <span class="c1"># If the frequencies haven&#39;t been set yet just don&#39;t try to do anything</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">f</span><span class="p">,</span><span class="n">sigma</span><span class="p">,</span><span class="n">intensity</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">intensities</span><span class="p">)):</span>
            <span class="c1"># Sigma and check / unchecked column</span>
            <span class="n">items</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">itemFlags</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.1f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">sigma</span><span class="p">))</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">)</span>
                <span class="n">itemFlags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsUserCheckable</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsSelectable</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEditable</span> <span class="p">)</span>
                <span class="n">freqFlags</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsSelectable</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEditable</span>
                <span class="n">otherFlags</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1">#itemFlags.append( item.flags() | Qt.ItemIsUserCheckable | Qt.ItemIsEnabled &amp; ~Qt.ItemIsSelectable &amp; ~Qt.ItemIsEditable )</span>
                <span class="n">itemFlags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsUserCheckable</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span> <span class="p">)</span>
                <span class="n">freqFlags</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEnabled</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsSelectable</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">ItemIsEditable</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
                <span class="n">freqFlags</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span> 
                <span class="n">otherFlags</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">flags</span><span class="p">()</span> <span class="o">&amp;</span> <span class="n">Qt</span><span class="o">.</span><span class="n">NoItemFlags</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">item</span><span class="p">)</span>
            <span class="c1"># Frequency column cm-1</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">itemFlags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">freqFlags</span> <span class="p">)</span>
            <span class="c1"># Intensity column Debye2/Angs2/amu</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">intensity</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">itemFlags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">otherFlags</span> <span class="p">)</span>
            <span class="c1"># Integrated molar absorption L/mole/cm/cm</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">intensity</span><span class="o">*</span><span class="mf">4225.6</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">itemFlags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">otherFlags</span> <span class="p">)</span>
            <span class="c1"># Maximum extinction L/mole/cm</span>
            <span class="n">items</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.2f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">intensity</span><span class="o">*</span><span class="mf">4225.6</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span> <span class="p">)</span> <span class="p">)</span>
            <span class="n">itemFlags</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">otherFlags</span> <span class="p">)</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,(</span><span class="n">item</span><span class="p">,</span><span class="n">flag</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">items</span><span class="p">,</span><span class="n">itemFlags</span><span class="p">)):</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setFlags</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span>
                <span class="n">item</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">j</span><span class="p">,</span> <span class="n">item</span> <span class="p">)</span>
        <span class="c1"># Release the block on signals for the frequency output table</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">resizeColumnsToContents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: redraw_output_tw&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.on_sigma_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_sigma_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_sigma_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Updates the sigma value in settings and applies it across the frequency range, then refreshes the output.</span>

<span class="sd">        This method is triggered when the sigma value has been changed. It updates the stored sigma value in the settings,</span>
<span class="sd">        applies the new sigma value across the pre-defined frequency range, redraws the output table widget, and then</span>
<span class="sd">        initiates a refresh to reflect the newly applied changes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: redraw_output_tw&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Sigma value&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Sigma value&#39;</span><span class="p">]</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span> <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redraw_output_tw</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on sigma change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Sigma value&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_sigma_changed&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.on_mass_cb_activated"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_mass_cb_activated">[docs]</a>    <span class="k">def</span> <span class="nf">on_mass_cb_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles activation of a combobox option in a mass-related setting.</span>

<span class="sd">        This method updates the current mass definition based on the selected option</span>
<span class="sd">        from a combobox, updates related settings, and refreshes the GUI accordingly.</span>
<span class="sd">        It disables the 4th option in the combobox if one of the first three options is selected.</span>
<span class="sd">        Additionally, it processes all pending events to ensure the GUI is updated immediately.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The index of the selected option in the combobox.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - `refresh()` is called to update the UI based on the new selection.</span>
<span class="sd">        - It also makes use of `QCoreApplication.processEvents()` to ensure the UI is </span>
<span class="sd">          responsive by processing all pending events.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        set_masses_tw : A method to update the masses table widget based on the selection.</span>
<span class="sd">        refresh : A method to refresh the UI components.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_mass_combobox_activated&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_definition_options</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">current_mass_definition_index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="c1"># Modify the element masses</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_masses_tw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_mass_combobox_activated&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">currentText</span><span class="p">())</span></div>

<div class="viewcode-block" id="SettingsTab.set_masses_tw"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.set_masses_tw">[docs]</a>    <span class="k">def</span> <span class="nf">set_masses_tw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the element masses in the table widget based on the mass_definition setting.</span>

<span class="sd">        This method updates the element masses table widget with masses according to the selected mass definition mode (&#39;average&#39;, &#39;program&#39;, &#39;isotope&#39;, &#39;gui&#39;). It retrieves species information from the reader attribute, calculates or fetches the corresponding masses, and updates an internal dictionary and the table widget accordingly. Signals from the table widget are temporarily blocked to prevent unwanted event triggers during updates.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: set_masses_tw&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">species</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">()</span>
            <span class="c1"># set the initial dictionary according to the mass_definition</span>
            <span class="n">masses</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
                    <span class="n">mass</span> <span class="o">=</span> <span class="n">average_masses</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
                    <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;program&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">reset_masses</span><span class="p">()</span>
                <span class="n">masses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">masses_per_type</span>
                <span class="k">for</span> <span class="n">mass</span><span class="p">,</span><span class="n">element</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">masses</span><span class="p">,</span><span class="n">species</span><span class="p">):</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;isotope&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
                    <span class="n">mass</span> <span class="o">=</span> <span class="n">isotope_masses</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
                    <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">mass</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gui&#39;</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">element</span> <span class="ow">in</span> <span class="n">species</span><span class="p">:</span>
                    <span class="n">mass</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">element</span><span class="p">]</span>
                    <span class="n">masses</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mass</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                 <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Error mass_definition not recognised&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">masses</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setVerticalHeaderLabels</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">])</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;masses_dictionary&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">)</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;masses&#39;</span><span class="p">,</span><span class="n">masses</span><span class="p">)</span>
            <span class="c1"># set masses of the elements in the table widget according to the mass definition</span>
            <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">mass</span><span class="p">,</span><span class="n">element</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">masses</span><span class="p">,</span><span class="n">species</span><span class="p">)):</span>
                <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;set_masses_tw&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">],</span><span class="n">i</span><span class="p">,</span><span class="n">mass</span><span class="p">,</span><span class="n">element</span><span class="p">)</span>
                <span class="n">qw</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">()</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;program&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">mass</span><span class="p">))</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">qw</span> <span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;average&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">average_masses</span><span class="p">[</span><span class="n">element</span><span class="p">]))</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span>
                    <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;average&#39;</span><span class="p">,</span><span class="n">average_masses</span><span class="p">[</span><span class="n">element</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">qw</span> <span class="p">)</span>
                <span class="k">elif</span>  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;isotope&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">isotope_masses</span><span class="p">[</span><span class="n">element</span><span class="p">]))</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span>
                    <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;isotope&#39;</span><span class="p">,</span><span class="n">isotope_masses</span><span class="p">[</span><span class="n">element</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">qw</span> <span class="p">)</span>
                <span class="k">elif</span>  <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;gui&#39;</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.6f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">element</span><span class="p">]))</span>
                    <span class="n">qw</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span>
                    <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;gui&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">element</span><span class="p">])</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">qw</span> <span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Mass definition not processed&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">])</span>
            <span class="c1"># unblock the table signals</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: set_masses_tw&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.on_output_tw_itemChanged"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_output_tw_itemChanged">[docs]</a>    <span class="k">def</span> <span class="nf">on_output_tw_itemChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle item changes in the output table widget.</span>

<span class="sd">        This method is called when an item in the output table widget (`output_tw`) is changed. It manages the selection state of modes based on the state of checkbox items in the first column, updates the &quot;sigmas_cm1&quot; and &quot;frequencies_cm1&quot; lists based on the user input in the respective columns, refreshes the widget, and processes pending GUI events.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : QTableWidgetItem</span>
<span class="sd">            The table widget item that was changed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This method blocks signals from the output table widget at the beginning to prevent recursive calls during its execution.</span>
<span class="sd">        - It distinguishes between changes in the first column (selection state and mode sigma values) and the second column (frequency values).</span>
<span class="sd">        - The method updates internal state to reflect the changes made by the user, including which modes are selected and the values for &quot;sigmas_cm1&quot; and &quot;frequencies_cm1&quot;.</span>
<span class="sd">        - After making changes, this method refreshes the output table widget and enforces a GUI update with `QCoreApplication.processEvents()`.</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        redraw_output_tw : Redraws the output table widget.</span>
<span class="sd">        refresh : Refreshes the internal state based on the latest changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">output_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_output_tw_itemChanged&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="p">)</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
        <span class="n">row</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">col</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># If this is the first column alter the check status but reset the sigma value</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">checkState</span><span class="p">()</span> <span class="o">==</span> <span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">:</span>
                <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on_output_tw_itemChanged setting selected mode to True&#39;</span><span class="p">,</span><span class="n">row</span> <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">mode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on_output_tw_itemChanged setting selected mode to False&#39;</span><span class="p">,</span><span class="n">row</span> <span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">mode_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">mode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span><span class="p">)</span> <span class="k">if</span> <span class="n">mode</span><span class="p">]</span>
            <span class="n">new_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">new_value</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">sigmas_cm1</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">redraw_output_tw</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">col</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="c1"># This is the frequency column</span>
            <span class="k">if</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_have_been_edited</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">new_value</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">[</span><span class="n">row</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_have_been_edited</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redraw_output_tw</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">redraw_output_tw</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on_output_tw_itemChanged selected_modes&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">modes_selected</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_output_tw_itemChanged&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.on_element_masses_tw_itemClicked"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_element_masses_tw_itemClicked">[docs]</a>    <span class="k">def</span> <span class="nf">on_element_masses_tw_itemClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the item clicked event on the element mass table widget.</span>

<span class="sd">        The only thing this function does is to make sure that signal from the `element_masses_tw` table widget are not blocked,</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : QTableWidgetItem</span>
<span class="sd">            The item in the table widget that was clicked.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_element_masses_tw_itemClicked)&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span><span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_masses_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_element_masses_tw_itemClicked)&#39;</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.on_element_masses_tw_itemChanged"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_element_masses_tw_itemChanged">[docs]</a>    <span class="k">def</span> <span class="nf">on_element_masses_tw_itemChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle item changed event in the mass table widget.</span>

<span class="sd">        This function is triggered whenever a cell in the masses table widget is edited. It updates the internal masses dictionary based on the new value provided in the table cell. Additionally, it sets some UI components to reflect the change and flags the need for recalculation and refresh.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : QTableWidgetItem</span>
<span class="sd">            The table widget item that was changed.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - `self.reader.getSpecies()` returns a list of elements corresponding to table columns.</span>
<span class="sd">        - `self.masses_dictionary` is a dict where keys are element symbols and values are their masses.</span>
<span class="sd">        - `self.refreshRequired` and `self.recalculate_selected_modes` are boolean flags used to indicate that a refresh and a recalculation are necessary.</span>
<span class="sd">        - `self.refresh()` is a method that refreshes or updates the UI components as needed based on the new changes.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_element_masses_tw_itemChanged)&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="p">)</span>
        <span class="n">elements</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">()</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Mass definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;gui&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mass_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">[</span><span class="n">elements</span><span class="p">[</span><span class="n">col</span><span class="p">]]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;masses_dictionary&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">masses_dictionary</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_element_masses_tw_itemChanged)&#39;</span> <span class="p">)</span></div>

<div class="viewcode-block" id="SettingsTab.on_optical_tw_itemChanged"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_optical_tw_itemChanged">[docs]</a>    <span class="k">def</span> <span class="nf">on_optical_tw_itemChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle item change events for an optical permittivity table.</span>

<span class="sd">        This method updates the optical permittivity settings based on changes made to the table widget items. It enforces symmetry in the optical permittivity matrix, marks the settings as edited, and triggers a series of updates and recalculations.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : QTableWidgetItem</span>
<span class="sd">            The table widget item that was changed. The item&#39;s row, column, and text are used to update the settings.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - Updates the &#39;Optical permittivity&#39; matrix in the settings dictionary based on the row, column, and text of the changed item.</span>
<span class="sd">        - Enforces symmetry by setting the [column][row] element equal to the [row][column] element.</span>
<span class="sd">        - Marks the &#39;Optical permittivity edited&#39; flag as True.</span>
<span class="sd">        - Calls `refresh_optical_permittivity_tw` to refresh the optical permittivity table widget.</span>
<span class="sd">        - Flags `refreshRequired`, `recalculate_selected_modes`, and `refresh` methods/attributes for further actions.</span>
<span class="sd">        - Processes any pending events with `QCoreApplication.processEvents()` to ensure the UI remains responsive.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start::on_optical_itemChanged)&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">()</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity&#39;</span><span class="p">][</span><span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">()][</span><span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity&#39;</span><span class="p">][</span><span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()][</span><span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">()]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity edited&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_optical_permittivity_tw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished::on_optical_itemChanged)&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.on_optical_tw_itemClicked"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_optical_tw_itemClicked">[docs]</a>    <span class="k">def</span> <span class="nf">on_optical_tw_itemClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle item clicked event for an optical widget&#39;s table item.</span>

<span class="sd">        This method is designed to be connected to the itemClicked signal of a table widget</span>
<span class="sd">        in a graphical user interface built with PyQt or PySide. When a table widget item</span>
<span class="sd">        is clicked, it first prints the start message along with the row and column of the</span>
<span class="sd">        clicked item. It then unblocks signals for the table widget and processes any pending</span>
<span class="sd">        GUI events, ensuring the application remains responsive. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : QTableWidgetItem</span>
<span class="sd">            The table widget item that was clicked.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_optical_itemClicked)&#39;</span><span class="p">,</span> <span class="n">item</span><span class="o">.</span><span class="n">row</span><span class="p">(),</span> <span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_optical_itemClicked)&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.refresh"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Refreshes the current state based on notebook content changes or user request.</span>

<span class="sd">        This method updates the GUI components such as tables for masses, optical permittivity, sigma value, Eckart term checkbox, and Born charges checkbox based on the changes made in the notebook or when forced by the user. It also triggers refreshes for any associated scenarios, plotting, analysis, and fitting tabs. The method blocks all signals from widgets during the update process to prevent unwanted calls to event handlers.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force : bool, optional</span>
<span class="sd">            If True, forces the refresh even if it&#39;s deemed not necessary. The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - Blocks all QWidget signals before starting the update process to prevent unintended event handling.</span>
<span class="sd">        - Updates various GUI components based on the current notebook&#39;s reader and settings information.</span>
<span class="sd">        - Triggers refreshes on associated tabs and scenarios within the notebook.</span>
<span class="sd">        - Unblocks all QWidget signals after updates are applied.</span>
<span class="sd">        - Manages internal flags to keep track of the need for refreshes and calculations.</span>
<span class="sd">        - Processes all pending Qt events with `QCoreApplication.processEvents()`.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: refresh&#39;</span><span class="p">,</span> <span class="n">force</span> <span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">reader</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: refresh not required&#39;</span><span class="p">,</span><span class="n">force</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1">#</span>
        <span class="c1"># Block signals during refresh</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">reader</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="p">:</span>
            <span class="c1"># Masses</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_masses_tw</span><span class="p">()</span>
            <span class="c1"># Optical dielectric</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity&#39;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">set_optical_permittivity_tw</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">refresh_optical_permittivity_tw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">sigma_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Sigma value&#39;</span><span class="p">])</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Eckart flag&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Neutral Born charges&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Checked</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">setCheckState</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">Unchecked</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Unlock signals after refresh</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">createIntensityTable</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># Refresh the scenarios that depend on this dielectric</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">scenarios</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">scenarios</span><span class="p">:</span>
                <span class="n">scenario</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">plottingTab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">plottingTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">analysisTab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">analysisTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: refresh&#39;</span><span class="p">,</span> <span class="n">force</span> <span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.refresh_optical_permittivity_tw"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.refresh_optical_permittivity_tw">[docs]</a>    <span class="k">def</span> <span class="nf">refresh_optical_permittivity_tw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Refresh the table widget with optical permittivity values.</span>

<span class="sd">        This function takes no parameters explicitly, it operates on the instance&#39;s attributes.</span>
<span class="sd">        It updates the `optical_tw` table widget with optical permittivity values from the `settings` attribute.</span>
<span class="sd">        Formatting of the values is to four decimal places and aligned both horizontally and vertically to the center.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - Assumes: </span>
<span class="sd">            - `self.settings` is a dict containing the key &#39;Optical permittivity&#39; which maps to a 2D list (i.e., list of lists) of numeric values.</span>
<span class="sd">            - `self.optical_tw` is a Qt TableWidget or similar object with a `.setItem()` method accepting row, column, and QTableWidgetItem arguments.</span>
<span class="sd">            - The table widget&#39;s signals are temporarily blocked to prevent unintended side-effects during the update.</span>
<span class="sd">            - `Qt.AlignHCenter | Qt.AlignVCenter` is used to center-align the text, assuming `Qt` and `QTableWidgetItem` are properly imported and used.</span>
<span class="sd">            - The `QCoreApplication.processEvents()` call forces the application to process all pending events, ensuring the UI updates in real-time.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: refresh_optical_permittivity&#39;</span><span class="p">)</span>
        <span class="n">optical</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">row</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">optical</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">row</span><span class="p">):</span>
                <span class="n">qw</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{0:.4f}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="p">)</span>
                <span class="n">qw</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">qw</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">optical_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: refresh_optical_permittivity&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.set_optical_permittivity_tw"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.set_optical_permittivity_tw">[docs]</a>    <span class="k">def</span> <span class="nf">set_optical_permittivity_tw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set the optical permittivity in the current settings.</span>

<span class="sd">        This method sets the &#39;Optical permittivity&#39; value in the settings to the value of `zerof_optical_dielectric` from the reader, triggers a refresh for the optical permittivity widget, and marks the selected modes for recalculation. It also signals that a refresh is required in the application and ensures the GUI events are processed to keep the application responsive.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: set_optical_permittivity_tw&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Optical permittivity&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">zerof_optical_dielectric</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh_optical_permittivity_tw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: set_optical_permittivity_tw&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.on_born_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_born_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_born_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle changes in the Born checkbox state.</span>

<span class="sd">        This method is triggered when the state of the Born checkbox changes. It updates the settings to reflect the new state, marks the session for refresh and recalculation, and then refreshes the UI.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_born_change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Neutral Born charges&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on born change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Neutral Born charges&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_born_change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">born_cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.on_eckart_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.on_eckart_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_eckart_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles changes in the Eckart flag state.</span>

<span class="sd">        This function is triggered when the state of the Eckart checkbox changes.</span>
<span class="sd">        It logs the state change, updates the settings to reflect the new state,</span>
<span class="sd">        marks refresh and recalculations as needed, and triggers a UI refresh.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_eckart_change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Eckart flag&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on eckart change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Eckart flag&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">recalculate_selected_modes</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_eckart_change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">eckart_cb</span><span class="o">.</span><span class="n">isChecked</span><span class="p">())</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.calculate"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vs_cm1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate the permittivity of the crystal over the range of frequencies in vs_cm1.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vs_cm1 : list</span>
<span class="sd">            Frequencies in cm-1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: calculate &#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: calculate aborted vs_cm1 has not been set&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span> <span class="o">=</span> <span class="n">vs_cm1</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
        <span class="n">dielectricFunction</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">CrystalPermittivityObject</span><span class="o">.</span><span class="n">function</span><span class="p">()</span>
        <span class="c1"># </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">crystal_permittivity</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;About to calculate settings crystal dielectric using pool&#39;</span><span class="p">)</span>
        <span class="c1"># Loop over the frequencies and calculate the crystal dielectric for each frequency</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">pool</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">startPool</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">dielecv</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">pool</span><span class="o">.</span><span class="n">imap</span><span class="p">(</span><span class="n">dielectricFunction</span><span class="p">,</span> <span class="n">vs_cm1</span><span class="p">,</span> <span class="n">chunksize</span><span class="o">=</span><span class="mi">20</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">crystal_permittivity</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dielecv</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">progressbars_update</span><span class="p">()</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: calculate &#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="SettingsTab.getCrystalPermittivity"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.getCrystalPermittivity">[docs]</a>    <span class="k">def</span> <span class="nf">getCrystalPermittivity</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">vs_cm1</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the crystal permittivity</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        vs_cm1 : list of floats</span>
<span class="sd">            The frequencies in cm-1</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self.crystal_permittivity : array_like</span>
<span class="sd">            The crystal permittivity (a 3x3 tensor) at each frequency</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: get_crystal_permittivity&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="ow">or</span>  <span class="p">(</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">)</span> <span class="o">!=</span> <span class="nb">len</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vs_cm1</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="ow">or</span> <span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="n">vs_cm1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;get_crystal_permittivity refreshing and recalculating&#39;</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: get_crystal_permittivity&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">crystal_permittivity</span></div>


<div class="viewcode-block" id="SettingsTab.getCrystalPermittivityObject"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html#PDielec.GUI.SettingsTab.SettingsTab.getCrystalPermittivityObject">[docs]</a>    <span class="k">def</span> <span class="nf">getCrystalPermittivityObject</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the crystal permittivity object</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        self.CrystalPermittivityObject : a permittivity object</span>
<span class="sd">            An instance of dielectric function</span>
<span class="sd">         &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: getCrystalPermittivityObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">calculationRequired</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;getCrystalPermittivityObject refreshing and recalculating&#39;</span> <span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: getCrystalPermittivityObject&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span><span class="p">)</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">CrystalPermittivityObject</span></div></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, John Kendrick and Andrew Burnett
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=01b4f342"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>