<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>PDielec.GUI.PlottingTab - PDielec: John Kendrick &amp; Andrew Burnett</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2e0a580d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">PDielec: John Kendrick & Andrew Burnett</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">PDielec: John Kendrick & Andrew Burnett</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pdgui.html">PDGui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software.html">Other Software Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_powder.html">Theory for Light Scattering from Powders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_single_crystal.html">Theory for Single Crystal Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analysis.html">Phonon Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_1.html">Applications of Effective Medium Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_2.html">Single Crystal Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../autoapi/PDielec/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of PDielec</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PDielec/GUI/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of PDielec.GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.AnalysisTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/App/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.App</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/FitterTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.FitterTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/MainTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.MainTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/NoteBook/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.NoteBook</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/OpenGLWidget/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.OpenGLWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PlottingTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PowderScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SettingsTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalLayer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SpreadSheetManager/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SpreadSheetManager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ViewerTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ViewerTab</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/AbinitOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.AbinitOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Calculator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Calculator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CastepOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CastepOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Constants/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Constants</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CrystalOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CrystalOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/DielectricFunction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.DielectricFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/ExperimentOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.ExperimentOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GTMcore/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GTMcore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GenericOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GenericOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GulpOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GulpOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/HelperRoutines/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.HelperRoutines</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/IO/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.IO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Materials/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Materials</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Mie/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Mie</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/PhonopyOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.PhonopyOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Plotter/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Plotter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/QEOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.QEOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/SuperCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.SuperCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/UnitCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.UnitCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Utilities/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Utilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/VaspOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.VaspOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkcsv/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkcsv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkexcel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkexcel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/graphdatagenerator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.graphdatagenerator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p1reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p1reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p2cif/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p2cif</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdcompare/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pickled_reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pickled_reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/vibanalysis/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.vibanalysis</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../zreferences.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for PDielec.GUI.PlottingTab</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright 2024 John Kendrick &amp; Andrew Burnett</span>
<span class="c1">#</span>
<span class="c1"># This file is part of PDielec</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the MIT License</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the MIT License along with this program, if not see https://opensource.org/licenses/MIT</span>
<span class="c1">#</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="sd">PlottingTab module</span>
<span class="sd">&#39;&#39;&#39;</span>
<span class="kn">import</span> <span class="nn">os.path</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>  <span class="kn">import</span>  <span class="n">QPushButton</span><span class="p">,</span> <span class="n">QWidget</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>  <span class="kn">import</span>  <span class="n">QComboBox</span><span class="p">,</span> <span class="n">QLabel</span><span class="p">,</span> <span class="n">QLineEdit</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>  <span class="kn">import</span>  <span class="n">QProgressBar</span><span class="p">,</span> <span class="n">QApplication</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>  <span class="kn">import</span>  <span class="n">QVBoxLayout</span><span class="p">,</span> <span class="n">QHBoxLayout</span><span class="p">,</span> <span class="n">QFormLayout</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>  <span class="kn">import</span>  <span class="n">QSpinBox</span><span class="p">,</span><span class="n">QDoubleSpinBox</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span>  <span class="kn">import</span>  <span class="n">QSizePolicy</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span>     <span class="kn">import</span>  <span class="n">QCoreApplication</span><span class="p">,</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">PDielec.Constants</span> <span class="kn">import</span>  <span class="n">avogadro_si</span><span class="p">,</span> <span class="n">angstrom</span>
<span class="c1"># Import plotting requirements</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="kn">import</span> <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="kn">import</span> <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span>
<span class="kn">from</span> <span class="nn">PDielec.Utilities</span> <span class="kn">import</span> <span class="n">Debug</span>

<span class="n">possible_frequency_units</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">,</span><span class="s1">&#39;THz&#39;</span><span class="p">,</span><span class="s1">&#39;GHz&#39;</span><span class="p">,</span><span class="s1">&#39;ang&#39;</span><span class="p">,</span><span class="s1">&#39;nm&#39;</span><span class="p">,</span><span class="s1">&#39;um&#39;</span><span class="p">,</span><span class="s1">&#39;mm&#39;</span><span class="p">,</span><span class="s1">&#39;cm&#39;</span><span class="p">,</span><span class="s1">&#39;m&#39;</span><span class="p">]</span>

<div class="viewcode-block" id="isThisAFrequencyUnit"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.isThisAFrequencyUnit">[docs]</a><span class="k">def</span> <span class="nf">isThisAFrequencyUnit</span><span class="p">(</span><span class="n">unit</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Return true if this is a frequency unit, false if a wavelength.</span>

<span class="sd">    Units of frequency are &#39;wavenumber&#39;,&#39;THz&#39;,&#39;GHz&#39;</span>
<span class="sd">    Units of wavelength are &#39;ang&#39;,&#39;nm&#39;,&#39;um&#39;,&#39;mm&#39;,&#39;cm&#39; or &#39;m&#39;</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    bool</span>
<span class="sd">        True if this is a frequency unit, False if a wavelength.</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">possible_frequency_units</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">unit</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;=</span><span class="mi">2</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">True</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">result</span> <span class="o">=</span> <span class="kc">False</span>
    <span class="k">return</span> <span class="n">result</span></div>

<div class="viewcode-block" id="convert_frequency_units"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.convert_frequency_units">[docs]</a><span class="k">def</span> <span class="nf">convert_frequency_units</span><span class="p">(</span> <span class="n">value</span><span class="p">,</span> <span class="n">unit_in</span><span class="p">,</span> <span class="n">unit_out</span> <span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Convert between frequency and wavelength units.</span>

<span class="sd">    The input can be either a scalar value or a numpy array of values. The function will return the converted value(s) in the output units specified.</span>
<span class="sd">    The unit strings are turned into lower-case so case is irrelevant</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    unit_in : str</span>
<span class="sd">        The units of the input value(s). Can be one of &#39;cm-1&#39; (or &#39;wavenumber&#39;), &#39;GHz&#39;, &#39;THz&#39;, &#39;nm&#39;, &#39;um&#39;, &#39;mm&#39;, &#39;cm&#39;, &#39;m&#39;.</span>
<span class="sd">    unit_out : str</span>
<span class="sd">        The units of the output value(s). Must be one of &#39;cm-1&#39; (or &#39;wavenumber&#39;), &#39;GHz&#39;, &#39;THz&#39;, &#39;nm&#39;, &#39;um&#39;, &#39;mm&#39;, &#39;cm&#39;, &#39;m&#39;.</span>
<span class="sd">    input_value : scalar or numpy array</span>
<span class="sd">        The value(s) for which the conversion is to be made.</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    scalar or numpy array</span>
<span class="sd">        The converted value(s) in the output units specified.</span>

<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">unit_in</span>  <span class="o">=</span> <span class="n">unit_in</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">unit_out</span> <span class="o">=</span> <span class="n">unit_out</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="c1"># the conversion dictionary has a tuple for each unit</span>
    <span class="c1"># the first entry is the multiplicative factor, the second is the operator</span>
    <span class="c1"># To convert wavelength they have to be scaled and then inverted</span>
    <span class="n">wavenumber</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;cm-1&#39;</span>       <span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;wavenumber&#39;</span> <span class="p">:</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;thz&#39;</span>        <span class="p">:</span> <span class="p">(</span><span class="mf">33.356</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;ghz&#39;</span>        <span class="p">:</span> <span class="p">(</span><span class="mf">33.356E+3</span><span class="p">,</span><span class="s1">&#39;*&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;ang&#39;</span>        <span class="p">:</span> <span class="p">(</span><span class="mf">1E-8</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;nm&#39;</span>         <span class="p">:</span> <span class="p">(</span><span class="mf">1E-7</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;um&#39;</span>         <span class="p">:</span> <span class="p">(</span><span class="mf">1E-4</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;mm&#39;</span>         <span class="p">:</span> <span class="p">(</span><span class="mf">1E-1</span><span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;cm&#39;</span>         <span class="p">:</span> <span class="p">(</span><span class="mf">1.0</span> <span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">),</span>
                   <span class="s1">&#39;m&#39;</span>          <span class="p">:</span> <span class="p">(</span><span class="mf">1E2</span> <span class="p">,</span><span class="s1">&#39;/&#39;</span><span class="p">),</span>
                 <span class="p">}</span>
    <span class="c1"># Convert the input unit to cm-1</span>
    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span><span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Problem with negative or zero conversions between wavelength and frequency</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning a zero or negative frequency/wavelength is not permitted&#39;</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">unit_in</span><span class="p">,</span><span class="n">unit_out</span><span class="p">)</span>
                <span class="n">x</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0E-8</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;=</span> <span class="mi">0</span> <span class="p">:</span>
            <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0E-8</span>
    <span class="n">scale</span><span class="p">,</span><span class="n">operator</span> <span class="o">=</span> <span class="n">wavenumber</span><span class="p">[</span><span class="n">unit_in</span><span class="p">]</span>
    <span class="n">value</span> <span class="o">=</span> <span class="n">scale</span> <span class="o">*</span> <span class="n">value</span>     
    <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">value</span>  
    <span class="c1"># convert the internal value from cm-1 to the output unit</span>
    <span class="n">scale</span><span class="p">,</span><span class="n">operator</span> <span class="o">=</span> <span class="n">wavenumber</span><span class="p">[</span><span class="n">unit_out</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">operator</span> <span class="o">==</span> <span class="s1">&#39;/&#39;</span><span class="p">:</span>
        <span class="n">value</span> <span class="o">=</span> <span class="mf">1.0</span> <span class="o">/</span> <span class="n">value</span>  
    <span class="n">value</span> <span class="o">=</span> <span class="n">value</span> <span class="o">/</span> <span class="n">scale</span>
    <span class="k">return</span> <span class="n">value</span></div>
    
<div class="viewcode-block" id="PlottingTab"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab">[docs]</a><span class="k">class</span> <span class="nc">PlottingTab</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A class used for creating and managing a plotting tab in a graphical user interface. It inherits from QWidget.</span>

<span class="sd">    This class is responsible for handling plotting functionalities like choosing plot types, setting molar definitions and frequency values, managing interactions with UI components such as spin boxes, combo boxes, and buttons, and plotting the data using matplotlib.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : QWidget</span>
<span class="sd">        The parent widget.</span>
<span class="sd">    debug : bool, optional</span>
<span class="sd">        Enables debug mode which provides additional logging details. Defaults to False.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    settings : dict</span>
<span class="sd">        A dictionary containing settings related to plotting such as minimum frequency, maximum frequency, frequency increment, molar definitions, number of atoms, plot type, and frequency unit.</span>
<span class="sd">    refreshRequired : bool</span>
<span class="sd">        A flag indicating whether the plot needs to be refreshed.</span>
<span class="sd">    subplot : matplotlib subplot object</span>
<span class="sd">        The subplot used for plotting data.</span>
<span class="sd">    vmin, vmax, vinc : float</span>
<span class="sd">        Variables to store current minimum frequency, maximum frequency, and frequency increment values for the plot.</span>
<span class="sd">    molar_cb_current_index : int</span>
<span class="sd">        Tracks the current index of the molar definition combo box to handle changes.</span>
<span class="sd">    notebook : QWidget</span>
<span class="sd">        A reference to the parent widget which contains the widget structure.</span>
<span class="sd">    reader : object</span>
<span class="sd">        An object to read and handle data from different file formats or sources.</span>
<span class="sd">    legends, vs_cm1 : list</span>
<span class="sd">        Lists used for storing legends for the plots and frequency values respectively.</span>
<span class="sd">    frequency_length : int</span>
<span class="sd">        Stores the length of the frequency array to check for changes.</span>
<span class="sd">    progressbar : QProgressBar</span>
<span class="sd">        A progress bar widget to display operation progress.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    get_total_number_of_frequency_calculations()</span>
<span class="sd">        Calculates the total number of frequency calculations required.</span>
<span class="sd">    requestRefresh()</span>
<span class="sd">        Requests a refresh for the plotting.</span>
<span class="sd">    requestScenarioRefresh()</span>
<span class="sd">        Requests a refresh for all scenarios in the application.</span>
<span class="sd">    on_vmin_changed(), on_vmax_changed(), on_vinc_changed(value), on_funits_cb_activated(index), on_molar_cb_activated(index), on_natoms_changed(value), on_plot_type_cb_activated(index)</span>
<span class="sd">        Event handlers for UI component changes.</span>
<span class="sd">    refresh(force=False)</span>
<span class="sd">        Refreshes the plot based on current settings and data.</span>
<span class="sd">    plot()</span>
<span class="sd">        Generates and displays the plot based on the selected plot type and data.</span>
<span class="sd">    get_number_of_califications_required()</span>
<span class="sd">        Returns the number of calculations needed for updating the plot.</span>
<span class="sd">    greyed_out()</span>
<span class="sd">        Greys out options in the UI that are not available.</span>
<span class="sd">    writeSpreadsheet()</span>
<span class="sd">        Writes results to a spreadsheet.</span>
<span class="sd">    set_concentrations()</span>
<span class="sd">        Sets the concentrations for the plotting based on the molar definition.</span>
<span class="sd">    &quot;&quot;&quot;</span>    
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initializes the Plotting tab within a given parent.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent : QWidget</span>
<span class="sd">            The parent widget in which this plotting tab will be initialized.</span>
<span class="sd">        debug : bool, optional</span>
<span class="sd">            Determines whether debugging messages should be shown, by default False.</span>

<span class="sd">        Attributes</span>
<span class="sd">        ----------</span>
<span class="sd">        settings : dict</span>
<span class="sd">            A dictionary to store settings such as frequency range, molar definitions, etc.</span>
<span class="sd">        refreshRequired : bool</span>
<span class="sd">            Indicates whether the plot needs to be refreshed.</span>
<span class="sd">        subplot : NoneType or matplotlib subplot</span>
<span class="sd">            Placeholder for a future subplot object, initialized as None.</span>
<span class="sd">        molar_definitions : list</span>
<span class="sd">            A list of possible definitions for a mole, including &#39;Unit cells&#39;, &#39;Atoms&#39;, &#39;Molecules&#39;.</span>
<span class="sd">        legends : list</span>
<span class="sd">            A list to store legend entries.</span>
<span class="sd">        vs_cm1 : list</span>
<span class="sd">            A list to store frequency data.</span>
<span class="sd">        frequency_length : int</span>
<span class="sd">            Stores the length of `vs_cm1` list.</span>
<span class="sd">        vmin, vmax, vinc : float</span>
<span class="sd">            Variables to store minimum, maximum, and increment values for frequency/wavelength after conversion.</span>
<span class="sd">        molar_cb_current_index : int</span>
<span class="sd">            Tracks the currently selected index in the molar definitions combo box.</span>
<span class="sd">        notebook : QWidget</span>
<span class="sd">            A reference to the parent widget, here it&#39;s assumed to be a notebook containing multiple tabs.</span>
<span class="sd">        reader : Object</span>
<span class="sd">            An object that deals with reading data, accessed through the `notebook`&#39;s mainTab.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        Widget elements such as QDoubleSpinBox, QComboBox, QLabel, QPushButton, QProgressBar, and the matplotlib figure are also initialized and configured within this method. This involves setting up signal-slot connections for interactive behavior, tooltips for user guidance, and incorporating the matplotlib canvas and toolbar for plotting functionality. Additionally, the method is designed for setup within a Qt layout structure, ensuring proper arrangement and display of the interface components.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">(</span><span class="n">QWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">global</span> <span class="n">debugger</span>
        <span class="n">debugger</span> <span class="o">=</span> <span class="n">Debug</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span><span class="s1">&#39;PlottingTab&#39;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: Plotting tab initialisation&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s1">&#39;Plotting&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">200</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.2</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_definitions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Unit cells&#39;</span><span class="p">,</span><span class="s1">&#39;Atoms&#39;</span><span class="p">,</span><span class="s1">&#39;Molecules&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Unit cells&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Number of atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Powder Molar Absorption&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;wavenumber&#39;</span>
        <span class="c1"># self.settings[&#39;Plot title&#39;] = &#39;Plot Title&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc</span> <span class="o">=</span> <span class="mf">0.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># store the notebook</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="c1"># get the reader from the main tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">reader</span>
        <span class="c1"># Create last tab - PlottingTab</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="c1"># Preamble for frequencies / wavelengths display</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span>
        <span class="c1"># n is the number of samples</span>
        <span class="n">n</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vmin</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">)))</span>
        <span class="c1"># convert units</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">])</span>
        <span class="c1"># vinc is calculated using the number of samples</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span><span class="o">-</span><span class="n">vmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">n</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="n">vinc</span><span class="p">,</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">])</span>
        <span class="c1"># If dealing with wavelength then swap the order of vmin and vmax</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">vmin</span>
        <span class="c1">#</span>
        <span class="c1"># The minimum frequency</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.00000001</span><span class="p">,</span><span class="mi">900000000000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the minimum frequency to be considered)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the minimum wavelength to be considered)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_vmin_changed</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># The maximum frequency</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.00000001</span><span class="p">,</span><span class="mi">900000000000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the maximum frequency to be considered)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the maximum wavelength to be considered)&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_vmax_changed</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Choose a suitable increment</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.0000001</span><span class="p">,</span><span class="mf">5000000000.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose an increment for the frequency when plotting&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose an increment for the wavelength when plotting&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">vinc</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_vinc_changed</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Set the frequency units</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span> <span class="n">possible_frequency_units</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_funits_cb_activated</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">possible_frequency_units</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Frequency unit&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the frequency unit&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Frequency min, max and increment&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose minimum, maximum and increment for frequency&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the wavelength unit&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Wavelength min, max and increment&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose minimum, maximum and increment for wavelength&#39;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1">#</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="p">,</span> <span class="n">hbox</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Define molar quantity</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Define what a mole is.  </span><span class="se">\n</span><span class="s1">In the case of Molecules, the number of atoms in a molecule must be given&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_definitions</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_definitions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Molar definition&quot;</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Molar definition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_definitions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_molar_cb_activated</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Define what a mole is.  </span><span class="se">\n</span><span class="s1">In the case of Molecules, the number of atoms in a molecule must be given&#39;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Number of atoms in a molecule</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span> <span class="o">=</span> <span class="n">QSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the number of atoms in a molecule. </span><span class="se">\n</span><span class="s1">Only need this if moles of molecules is needed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">500</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Number of atoms&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_natoms_changed</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Number of atoms per molecule&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the number of atoms in a molecule. </span><span class="se">\n</span><span class="s1">Only need this if moles of molecules is needed&#39;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Final button</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose the which data to plot&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span> <span class="o">=</span> <span class="p">[</span>
                            <span class="s1">&#39;Powder Molar Absorption&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Powder Absorption&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Powder Real Permittivity&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Powder Imaginary Permittivity&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Powder ATR&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Crystal Reflectance (P polarisation)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Crystal Reflectance (S polarisation)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Crystal Transmittance (P polarisation)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Crystal Transmittance (S polarisation)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Crystal Absorbtance (P polarisation)&#39;</span><span class="p">,</span>
                            <span class="s1">&#39;Crystal Absorbtance (S polarisation)&#39;</span><span class="p">,</span>
                          <span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_ylabels</span> <span class="o">=</span> <span class="p">{</span>
                     <span class="s1">&#39;Powder Molar Absorption&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Molar Absorption Coefficient $\mathdefault{(L mole^{-1} cm^{-1})}$&#39;</span><span class="p">,</span>
                           <span class="s1">&#39;Powder Absorption&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Absorption Coefficient $\mathdefault{(cm^{-1})}$&#39;</span><span class="p">,</span>
                    <span class="s1">&#39;Powder Real Permittivity&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Real Component of Permittivity&#39;</span><span class="p">,</span>
               <span class="s1">&#39;Powder Imaginary Permittivity&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Imaginary Component of Permittivity&#39;</span><span class="p">,</span>
                                  <span class="s1">&#39;Powder ATR&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;ATR absorption&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Crystal Reflectance (P polarisation)&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Fraction of p-polarised reflectance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Crystal Reflectance (S polarisation)&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Fraction of s-polarised reflectance&#39;</span><span class="p">,</span>
      <span class="s1">&#39;Crystal Transmittance (P polarisation)&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Fraction of p-polarised transmitted&#39;</span><span class="p">,</span>
      <span class="s1">&#39;Crystal Transmittance (S polarisation)&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Fraction of s-polarised transmitted&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Crystal Absorbtance (P polarisation)&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Fraction of p-polarised absorbtance&#39;</span><span class="p">,</span>
        <span class="s1">&#39;Crystal Absorbtance (S polarisation)&#39;</span><span class="p">:</span> <span class="sa">r</span><span class="s1">&#39;Fraction of s-polarised absorbtance&#39;</span><span class="p">,</span>
                            <span class="p">}</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">activated</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_plot_type_cb_activated</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span> <span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Choose plot type&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose the plot type&#39;</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">plot_button</span> <span class="o">=</span> <span class="n">QPushButton</span><span class="p">(</span><span class="s1">&#39;Update plot&#39;</span><span class="p">)</span>
        <span class="n">plot_button</span><span class="o">.</span><span class="n">clicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">)</span>
        <span class="n">plot_button</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Update the plot&#39;</span><span class="p">)</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="n">plot_button</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">hbox</span><span class="p">)</span>
        <span class="c1"># Add a progress bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressbar</span> <span class="o">=</span> <span class="n">QProgressBar</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">progressbar</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Show the progress of any calculations&#39;</span><span class="p">)</span>
        <span class="c1"># Append the progress bar to the list of progress bars managed by the notebook</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">progressbars_add</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">progressbar</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">progressbars_set_maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_total_number_of_frequency_calculations</span><span class="p">())</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s1">&#39;Calculation progress&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Show the progress of any calculations&#39;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">progressbar</span><span class="p">)</span>
        <span class="c1"># Add the matplotlib figure to the bottom</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">))</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
        <span class="c1"># finalise the layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="c1"># Create the plot</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: Plotting tab initialisation&#39;</span><span class="p">)</span>
        <span class="k">return</span>

<div class="viewcode-block" id="PlottingTab.get_total_number_of_frequency_calculations"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.get_total_number_of_frequency_calculations">[docs]</a>    <span class="k">def</span> <span class="nf">get_total_number_of_frequency_calculations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Calculate and return the total number of frequency calculations required.</span>

<span class="sd">        This method computes the total number of frequency calculations based on the current settings for minimum frequency, maximum frequency, and frequency increment. It updates the scenario if the frequency range or the increment has changed since the last update.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The total number of frequency calculations required, which is the product of the number of calculations required (as obtained from `get_number_of_calculations_required`) and the new length of frequency range computed.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vmin</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">))</span>
        <span class="n">new_length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequency_length</span> <span class="o">!=</span> <span class="n">new_length</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span> <span class="o">!=</span> <span class="n">vmin</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span> <span class="o">!=</span> <span class="n">vmax</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">vinc</span> <span class="o">!=</span> <span class="n">vinc</span> <span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">requestScenarioRefresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_length</span> <span class="o">=</span> <span class="n">new_length</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmin</span> <span class="o">=</span> <span class="n">vmin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vinc</span> <span class="o">=</span> <span class="n">vinc</span>
        <span class="n">n</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_number_of_calculations_required</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">n</span><span class="o">*</span><span class="n">new_length</span></div>

<div class="viewcode-block" id="PlottingTab.requestRefresh"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.requestRefresh">[docs]</a>    <span class="k">def</span> <span class="nf">requestRefresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Initiates a refresh request.</span>

<span class="sd">        This function flags that a refresh is required</span>
<span class="sd">        It doesn&#39;t return any value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: requestRefresh&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: requestRefresh&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.requestScenarioRefresh"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.requestScenarioRefresh">[docs]</a>    <span class="k">def</span> <span class="nf">requestScenarioRefresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Request a refresh on all scenarios within a notebook.</span>

<span class="sd">        This function triggers a refresh process for the settings tab and all scenarios within the notebook. </span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: requestScenarioRefresh&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">settingsTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">scenarios</span><span class="p">:</span>
            <span class="n">scenario</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: requestScenarioRefresh&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.on_vinc_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.on_vinc_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_vinc_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the change in frequency increment and update GUI accordingly.</span>

<span class="sd">        This function is triggered when there&#39;s a change in the frequency increment value. It adjusts the number of GUI elements based on </span>
<span class="sd">        new values of minimum and maximum frequency and the changed frequency increment. It also updates the settings dict with the </span>
<span class="sd">        new frequency increment value.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The new value of the frequency increment.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Side Effects</span>
<span class="sd">        ------------</span>
<span class="sd">        - Temporarily blocks signals from the vinc_sb spin box to prevent recursive calls.</span>
<span class="sd">        - Updates &#39;Frequency increment&#39; in the settings dictionary with the new frequency increment value.</span>
<span class="sd">        - Requests a refresh of the fitterTab if needed.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_vinc_changed&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">&lt;=</span><span class="mi">0</span> <span class="p">:</span>
            <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Use existing units to calculate the number of samples</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">ngui</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span> <span class="o">/</span> <span class="n">value</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="c1"># Work out the increment needed for cm-1</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">ngui</span> <span class="o">&lt;=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ngui</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ncm1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vmin</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">)))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vinc</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on_vinc_change &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_vinc_changed&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlottingTab.on_vmin_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.on_vmin_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_vmin_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the change in the minimum frequency setting.</span>

<span class="sd">        This method adjusts the stored minimum frequency in the settings according to the new</span>
<span class="sd">        minimum frequency input by the user. It first blocks the signals of the minimum frequency spinbox</span>
<span class="sd">        to prevent recursive calls during the adjustment process. It then updates the setting based</span>
<span class="sd">        on whether the frequency units are compatible with a predefined list, converting the frequency</span>
<span class="sd">        accordingly. After adjusting the settings, it triggers a refresh request for the application&#39;s</span>
<span class="sd">        fitter tab and marks the need for a general refresh. Finally, it re-enables the signals for</span>
<span class="sd">        the minimum frequency spinbox and logs the completion of the process.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - Uses the `blockSignals` method on `self.vmin_sb` to prevent signal-slot recursion.</span>
<span class="sd">        - Adjusts settings based on a unit conversion utility function, `convert_frequency_units`.</span>
<span class="sd">        - The effect of this method extends beyond just the internal state changes; it influences the UI and possibly other components&#39; states through the requested refresh.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_vmin_changed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">],</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="n">vmin</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">],</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on_vmin_changed setting vmin to&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_vmin_changed&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlottingTab.on_vmax_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.on_vmax_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_vmax_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handles the event when the maximum frequency setting is changed.</span>

<span class="sd">        This method is triggered whenever there is a change in the maximum frequency setting (`vmax`). It blocks signal emission from the `vmax_sb` spinner box (presumably, a GUI element for setting `vmax`), reads the current minimum (`vmin`) and maximum (`vmax`) frequency settings, and updates the corresponding setting based on the specified frequency unit. If the frequency unit denotes a frequency, `vmax` is converted and stored as the &#39;Maximum frequency&#39; in the settings dictionary in the &#39;wavenumber&#39; unit. Otherwise, it updates the &#39;Minimum frequency&#39; with the converted value. This method also triggers any necessary refresh operations in the user interface and finally unblocks signal emissions from the `vmax_sb`.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This method assumes the existence of `vmin_sb` and `vmax_sb` attributes, which should be spinner box GUI elements (or similar) for setting minimum and maximum frequencies, respectively.</span>
<span class="sd">        - The `settings` dictionary must have a &#39;Frequency unit&#39; key, and possibly &#39;Maximum frequency&#39; and &#39;Minimum frequency&#39; keys which are updated based on the condition.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_vmax_changed&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">],</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="n">vmax</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">],</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on_vmax_changed setting vmax to &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_vmax_changed&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlottingTab.refresh"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Refreshes the current state based on the changes in settings, forces refresh if needed.</span>

<span class="sd">        This function updates the frequency settings (minimum frequency, maximum frequency, and frequency increment) based on the current settings. It ensures that these settings are within logical limits. The function updates GUI elements (spin boxes and combo boxes) with these new calculations. Additionally, it handles the conversion of frequency units, updates GUI tooltips based on the frequency unit, and builds or refreshes the visualization plot based on the refreshed data. If the &#39;force&#39; flag is set or if a refresh is deemed necessary due to significant changes in the settings, it proceeds with the refresh operation, else it skips the refresh to optimize performance.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force : bool, optional</span>
<span class="sd">            A boolean flag indicating whether to forcefully execute a refresh regardless of whether it was deemed necessary based on internal conditions. The default is False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - The actual refresh operation involves several steps:</span>
<span class="sd">            - Checking if a refresh is required based on the current settings and the &#39;force&#39; parameter.</span>
<span class="sd">            - Temporarily blocking signals from all child widgets to prevent unintended side effects during settings updates.</span>
<span class="sd">            - Verifying and updating frequency settings to maintain logical constraints.</span>
<span class="sd">            - Updating GUI components with new settings values and tooltips based on the current frequency unit.</span>
<span class="sd">            - Processing and plotting data based on the updated settings.</span>
<span class="sd">            - Re-enabling signals for child widgets after modifications are complete.</span>
<span class="sd">        - The processEvents call is used to ensure the UI remains responsive during long operations.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: refresh&#39;</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: refreshing widget not required&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1">#</span>
        <span class="c1"># Block signals during refresh</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">greyed_out</span><span class="p">()</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Now refresh values</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span> <span class="o">-</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">])</span><span class="o">/</span><span class="mi">2</span>
        <span class="c1"># The GUI uses frequency and wavelength, convert the values in settings from cm-1</span>
        <span class="c1"># Work out the increment needed for cm-1</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span>
        <span class="c1"># Protect the code from over-exuberant choice of parameters</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span><span class="o">/</span><span class="n">vinc</span> <span class="o">&gt;</span> <span class="mi">90000</span><span class="p">:</span>
            <span class="n">vinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span> <span class="o">/</span> <span class="mi">90000</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Warning - the number data points in a plot has been limited to 9000&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;          this happens if a 0 wavelength or frequency is entered in the GUI&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vinc</span>
        <span class="n">ncm1</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vmin</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">)))</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">],</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">])</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">],</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">])</span>
        <span class="c1"># Reorder the GUI values</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="o">&gt;</span> <span class="n">vmax</span><span class="p">:</span>
            <span class="n">vmin</span><span class="p">,</span> <span class="n">vmax</span> <span class="o">=</span> <span class="n">vmax</span><span class="p">,</span> <span class="n">vmin</span>
        <span class="c1"># Set the GUI values</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="p">(</span><span class="n">vmax</span> <span class="o">-</span> <span class="n">vmin</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">ncm1</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">vmin</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="n">vinc</span><span class="p">)</span>
        <span class="c1"># Update the tool tips as the frequency unit could be a wavelength</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the minimum frequency to be considered)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the maximum frequency to be considered)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose an increment for the frequency when plotting&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the frequency unit&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose minimum, maximum and increment for frequency&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Frequency min, max and increment&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose minimum, maximum and increment for frequency&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the minimum wavelength to be considered)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the maximum wavelength to be considered)&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vinc_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose an increment for the wavelength when plotting&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Set the wavelength unit&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="s1">&#39;Wavelength min, max and increment&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">frequency_form_label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s1">&#39;Choose minimum, maximum and increment for wavelength&#39;</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="n">possible_frequency_units</span><span class="o">.</span><span class="n">index</span><span class="p">((</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Frequency unit&quot;</span><span class="p">]))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">funits_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="n">index</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_definitions</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Molar definition&quot;</span><span class="p">])</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Molar definition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_definitions</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Number of atoms&#39;</span><span class="p">])</span>
        <span class="c1"># Refresh the widgets that depend on the reader</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">reader</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">set_concentrations</span><span class="p">()</span>
        <span class="c1"># Reset the progress bar</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">progressbars_set_maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_total_number_of_frequency_calculations</span><span class="p">())</span>
        <span class="c1">#</span>
        <span class="c1"># Unblock signals after refresh</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;calling plot from refresh&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: refresh&#39;</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.on_natoms_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.on_natoms_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_natoms_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the change in the number of atoms.</span>

<span class="sd">        This method is called when the number of atoms changes. It updates the relevant setting in the instance, recalculates the concentration based on the new number of atoms, flags that a refresh is required, and then triggers the refresh process.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int or float</span>
<span class="sd">            The new number of atoms. This value is used to update settings and recalculate concentrations.</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - `self.reader.volume` and `self.reader.nions` are expected to be available and contain the volume of the container and the number of ions, respectively.</span>
<span class="sd">        - The method refreshes `self.notebook.fitterTab` object with a `requestRefresh` method to initiate the refresh process.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_natoms_changed&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Number of atoms&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;on natoms changed &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Number of atoms&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">avogadro_si</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">volume</span> <span class="o">*</span> <span class="mf">1.0e-24</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Number of atoms&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">nions</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;The concentration has been set&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_natoms_changed&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlottingTab.on_plot_type_cb_activated"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.on_plot_type_cb_activated">[docs]</a>    <span class="k">def</span> <span class="nf">on_plot_type_cb_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle plot type change from a combo box.</span>

<span class="sd">        This method gets triggered when the plot type in a combo box is changed.</span>
<span class="sd">        It updates the plot type in the settings, marks the current state as needing a refresh,</span>
<span class="sd">        requests the fitter tab to refresh, and finally refreshes the current view.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The index of the selected item in the combo box.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_plot_type_cb_activated&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Changed plot type to &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_plot_type_cb_activated&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlottingTab.on_funits_cb_activated"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.on_funits_cb_activated">[docs]</a>    <span class="k">def</span> <span class="nf">on_funits_cb_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the activation of a frequency unit combo box item.</span>

<span class="sd">        This method updates the active frequency unit in the settings, triggers necessary refresh processes and logs the change.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The index of the activated item in the frequency units combo box.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method is part of a GUI application where `self` refers to an instance of the application or a relevant widget. It manages updates to the application&#39;s settings and GUI components based on the user&#39;s selection of a frequency unit from a combo box.</span>

<span class="sd">        - `self.settings` is a dictionary where application settings are stored.</span>
<span class="sd">        - `self.refreshRequired` is a boolean flag used to indicate whether a refresh of certain GUI components is necessary.</span>
<span class="sd">        - `self.notebook` appears to be a widget container (like a tab widget), with `fitterTab` being one of its child tabs.</span>
<span class="sd">        - `self.vmin_sb` is another component (likely a spin box or similar input widget) that may need its signals blocked/unblocked during the process to avoid unwanted signal emission.</span>
<span class="sd">        - The `debugger.print` calls are used for logging and are not a standard Python function; they imply the existence of a custom logging or debugging utility named `debugger`.</span>

<span class="sd">        The actual refreshing of the GUI and handling of signal blocking is done within other methods not shown here, such as `self.refresh()` and `self.notebook.fitterTab.requestRefresh()`.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        This function does not explicitly raise any exceptions but depends on the proper functioning of the methods it calls and the state of `self` and its attributes.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_funits_cb_activated&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">possible_frequency_units</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Frequency unit changed to &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">])</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_funits_cb_activated&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlottingTab.on_molar_cb_activated"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.on_molar_cb_activated">[docs]</a>    <span class="k">def</span> <span class="nf">on_molar_cb_activated</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle the activation of the molar combobox option.</span>

<span class="sd">        This method is tied to a GUI event where a selection from a molar combobox triggers various updates in the application state, including setting concentrations, refreshing UI elements, and potentially triggering further calculations or refreshes as needed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The index of the selected item in the molar combobox. This index corresponds to a specific molar definition and is used to update the application settings and state accordingly.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        See Also</span>
<span class="sd">        --------</span>
<span class="sd">        set_concentrations : A method to update the concentrations based on the selected molar definition.</span>
<span class="sd">        refresh : A method to refresh the UI elements.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: on_molar_cb_activated&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molar_cb_current_index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">molar_definitions</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_concentrations</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">fitterTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;The concentration has been set&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">])</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: on_molar_cb_activated&#39;</span><span class="p">,</span> <span class="n">index</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.set_concentrations"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.set_concentrations">[docs]</a>    <span class="k">def</span> <span class="nf">set_concentrations</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Sets the concentration based on the molar definition in settings.</span>

<span class="sd">        This method updates the concentration value in the settings dictionary based on the &#39;Molar definition&#39; key. It calculates concentration values differently based on whether the molar definition is set to &#39;Molecules&#39;, &#39;Unit cells&#39;, or &#39;Atoms&#39;. It also enables or disables the `natoms_sb` spin box accordingly.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: set_concentration&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Molecules&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">avogadro_si</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">volume</span> <span class="o">*</span> <span class="mf">1.0e-24</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Number of atoms&#39;</span><span class="p">]</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">nions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Unit cells&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>      <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">avogadro_si</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">volume</span> <span class="o">*</span> <span class="mf">1.0e-24</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;cell concentration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">avogadro_si</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">volume</span> <span class="o">*</span> <span class="mf">1.0e-24</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Atoms&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1000.0</span> <span class="o">/</span> <span class="p">(</span><span class="n">avogadro_si</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">volume</span> <span class="o">*</span> <span class="mf">1.0e-24</span> <span class="o">/</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">nions</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">natoms_sb</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: set_concentration&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.writeSpreadsheet"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.writeSpreadsheet">[docs]</a>    <span class="k">def</span> <span class="nf">writeSpreadsheet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update and write the results of powder and crystal scenarios to a spreadsheet.</span>

<span class="sd">        This function navigates through each scenario defined in the `notebook` attribute, extracts relevant data such as absorption coefficients, permittivities, and reflectances, and writes these along with scenario settings to a spreadsheet. It handles different types of scenarios (Powder or Crystal) and makes use of the spreadsheet object&#39;s methods for selecting worksheets, writing rows, and dealing with data transformation. The function also handles the calculation of molar absorption coefficients with unit conversion when necessary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start::writeSpreadsheet&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">spreadsheet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished::writeSpreadsheet spreadsheet is None&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="c1"># make sure the plottingTab is up to date</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refresh</span><span class="p">()</span>
        <span class="c1"># Handle powder plots</span>
        <span class="n">molarAbsorptionCoefficients</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">absorptionCoefficients</span>      <span class="o">=</span> <span class="p">[]</span>
        <span class="n">realPermittivities</span>          <span class="o">=</span> <span class="p">[]</span>
        <span class="n">imagPermittivities</span>          <span class="o">=</span> <span class="p">[]</span>
        <span class="n">sp_atrs</span>                     <span class="o">=</span> <span class="p">[]</span>
        <span class="n">R_ps</span>                        <span class="o">=</span> <span class="p">[]</span>
        <span class="n">R_ss</span>                        <span class="o">=</span> <span class="p">[]</span>
        <span class="n">T_ps</span>                        <span class="o">=</span> <span class="p">[]</span>
        <span class="n">T_ss</span>                        <span class="o">=</span> <span class="p">[]</span>
        <span class="n">A_ps</span>                        <span class="o">=</span> <span class="p">[]</span>
        <span class="n">A_ss</span>                        <span class="o">=</span> <span class="p">[]</span>
        <span class="n">powder_legends</span>              <span class="o">=</span> <span class="p">[]</span>
        <span class="n">crystal_legends</span>             <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># Deal with Scenarios </span>
        <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">spreadsheet</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">selectWorkSheet</span><span class="p">(</span><span class="s1">&#39;Scenarios&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;A list of the scenarios used:&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">scenario</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">scenarios</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">scenario</span><span class="o">.</span><span class="n">scenarioType</span> <span class="o">==</span> <span class="s1">&#39;Powder&#39;</span><span class="p">:</span>
                <span class="n">direction</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">direction</span>
                <span class="n">depolarisation</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">depolarisation</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Scenario &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)],</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">settings</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">settings</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">):</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="n">key</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]],</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Normalised unique direction&#39;</span><span class="p">]</span><span class="o">+</span><span class="n">direction</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Depolarisation matrix&#39;</span><span class="p">],</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">depolarisation</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">depolarisation</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">depolarisation</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">molarAbsorptionCoefficients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">absorptionCoefficients</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">realPermittivities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">imagPermittivities</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">sp_atrs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">powder_legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Legend&#39;</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;&#39;</span><span class="p">],</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s1">&#39;Scenario &#39;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">index</span><span class="p">)],</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">settings</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">settings</span>
                <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="nb">sorted</span><span class="p">(</span><span class="n">settings</span><span class="p">,</span><span class="n">key</span><span class="o">=</span><span class="nb">str</span><span class="o">.</span><span class="n">lower</span><span class="p">):</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="n">key</span><span class="p">,</span> <span class="n">settings</span><span class="p">[</span><span class="n">key</span><span class="p">]],</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">dielectricLayerIndex</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">getDielectricLayerIndex</span><span class="p">()</span>
                <span class="k">if</span> <span class="n">dielectricLayerIndex</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">scenario</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">dielectricLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">isTensor</span><span class="p">():</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="s1">&#39;Dielectric layer laboratory frame:&#39;</span><span class="p">)</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">dielectricLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">labframe</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">dielectricLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">labframe</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                    <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">layers</span><span class="p">[</span><span class="n">dielectricLayerIndex</span><span class="p">]</span><span class="o">.</span><span class="n">labframe</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">(),</span> <span class="n">col</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
                <span class="c1"># Store the reflectance and transmittance</span>
                <span class="n">R_ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">5</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">R_ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">6</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">T_ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">T_ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">8</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">A_ps</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">9</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">A_ss</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span> <span class="p">)</span> <span class="p">)</span>
                <span class="n">crystal_legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">scenario</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Legend&#39;</span><span class="p">])</span>
        <span class="c1"># Single crystal Permittivity</span>
        <span class="n">dielecv</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">settingsTab</span><span class="o">.</span><span class="n">getCrystalPermittivity</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="c1"># Powder results</span>
        <span class="c1"># Work out what molar units we are using</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">molarAbsorptionCoefficients</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Molecules&#39;</span><span class="p">:</span>
                <span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Powder Molar Absorption (mols)&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Unit cells&#39;</span><span class="p">:</span>
                <span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Powder Molar Absorption (cells)&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Atoms&#39;</span><span class="p">:</span>
                <span class="n">sheet_name</span> <span class="o">=</span> <span class="s1">&#39;Powder Molar Absorption (atoms)&#39;</span>
            <span class="c1"># Always write out the moles of cell</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_powder_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Powder Molar Absorption (cells)&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">powder_legends</span><span class="p">,</span> <span class="n">molarAbsorptionCoefficients</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Molar definition&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Unit cells&#39;</span><span class="p">:</span>
                <span class="c1"># If some other molar definition has been used then write that out too</span>
                <span class="n">molarAbsorptionCoefficients_mols</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">molar_scaling</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;cell concentration&#39;</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
                <span class="k">for</span> <span class="n">absorption</span> <span class="ow">in</span> <span class="n">molarAbsorptionCoefficients</span><span class="p">:</span>
                    <span class="n">molarAbsorptionCoefficients_mols</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">molar_scaling</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">absorption</span><span class="p">))</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">write_powder_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="n">sheet_name</span><span class="p">,</span>                      <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">powder_legends</span><span class="p">,</span> <span class="n">molarAbsorptionCoefficients_mols</span><span class="p">)</span>
            <span class="c1"># end if</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_powder_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Powder Absorption&#39;</span><span class="p">,</span>             <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">powder_legends</span><span class="p">,</span> <span class="n">absorptionCoefficients</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_powder_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Powder Real Permittivity&#39;</span><span class="p">,</span>      <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">powder_legends</span><span class="p">,</span> <span class="n">realPermittivities</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_powder_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Powder Imaginary Permittivity&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">powder_legends</span><span class="p">,</span> <span class="n">imagPermittivities</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_powder_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Powder ATR Reflectance&#39;</span><span class="p">,</span>        <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">powder_legends</span><span class="p">,</span> <span class="n">sp_atrs</span><span class="p">)</span>
        <span class="c1"># Single Crystal results</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">R_ps</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_crystal_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Crystal R_p&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">crystal_legends</span><span class="p">,</span> <span class="n">R_ps</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_crystal_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Crystal R_s&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">crystal_legends</span><span class="p">,</span> <span class="n">R_ss</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_crystal_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Crystal T_p&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">crystal_legends</span><span class="p">,</span> <span class="n">T_ps</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_crystal_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Crystal T_s&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">crystal_legends</span><span class="p">,</span> <span class="n">T_ss</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_crystal_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Crystal A_p&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">crystal_legends</span><span class="p">,</span> <span class="n">A_ps</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_crystal_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="s1">&#39;Crystal A_s&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">crystal_legends</span><span class="p">,</span> <span class="n">A_ss</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">dielecv</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">write_eps_results</span><span class="p">(</span><span class="n">sp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span> <span class="n">dielecv</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished::writeSpreadsheet&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.write_eps_results"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.write_eps_results">[docs]</a>    <span class="k">def</span> <span class="nf">write_eps_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="n">vs</span><span class="p">,</span> <span class="n">dielecv</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Write real and imaginary parts of crystal permittivity to a spreadsheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sp : object</span>
<span class="sd">            An instance of a spreadsheet processing class with methods to manipulate data in a spreadsheet.</span>
<span class="sd">        vs : list</span>
<span class="sd">            A list containing frequency values.</span>
<span class="sd">        dielecv : numpy.ndarray</span>
<span class="sd">            A complex numpy array where the real parts represent the real permittivities and the imaginary parts represent the imaginary permittivities of a crystal. The array should have a shape of (N,3,3) where N is the number of frequency values, and the 3x3 inner arrays represent the permittivity tensor for each frequency.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function does two main tasks:</span>
<span class="sd">        1. Selects the &#39;Real Crystal Permittivity&#39; sheet, deletes its current content if any, and writes the real parts of the permittivity tensor for each frequency along with the frequency values themselves.</span>
<span class="sd">        2. Selects the &#39;Imag Crystal Permittivity&#39; sheet, deletes its current content if any, and writes the imaginary parts of the permittivity tensor for each frequency along with the frequency values themselves.</span>

<span class="sd">        Both sections write data in the format: frequencies (cm-1), xx, yy, zz, xy, xz, yz, where xx, yy, zz, xy, xz, and yz are components of the permittivity tensor.</span>
<span class="sd">        The output data starts from the second column (index 1), and for each row written, a &#39;check&#39; flag is set to 1.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: write_eps_results length vs&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">selectWorkSheet</span><span class="p">(</span><span class="s1">&#39;Real Crystal Permittivity&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;frequencies (cm-1)&#39;</span><span class="p">,</span> <span class="s1">&#39;xx&#39;</span><span class="p">,</span> <span class="s1">&#39;yy&#39;</span><span class="p">,</span> <span class="s1">&#39;zz&#39;</span><span class="p">,</span> <span class="s1">&#39;xy&#39;</span><span class="p">,</span> <span class="s1">&#39;xz&#39;</span><span class="p">,</span> <span class="s1">&#39;yz&#39;</span> <span class="p">]</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">eps</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span><span class="n">dielecv</span><span class="p">):</span>
            <span class="n">eps_xx_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">eps_yy_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">eps_zz_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">eps_xy_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">eps_xz_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">eps_yz_r</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">eps_xx_r</span><span class="p">,</span> <span class="n">eps_yy_r</span><span class="p">,</span> <span class="n">eps_zz_r</span><span class="p">,</span> <span class="n">eps_xy_r</span><span class="p">,</span> <span class="n">eps_xz_r</span><span class="p">,</span> <span class="n">eps_yz_r</span> <span class="p">]</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">selectWorkSheet</span><span class="p">(</span><span class="s1">&#39;Imag Crystal Permittivity&#39;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">v</span><span class="p">,</span><span class="n">eps</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">vs</span><span class="p">,</span><span class="n">dielecv</span><span class="p">):</span>
            <span class="n">eps_xx_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
            <span class="n">eps_yy_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">eps_zz_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">eps_xy_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">])</span>
            <span class="n">eps_xz_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">eps_yz_i</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">imag</span><span class="p">(</span><span class="n">eps</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">,</span> <span class="n">eps_xx_i</span><span class="p">,</span> <span class="n">eps_yy_i</span><span class="p">,</span> <span class="n">eps_zz_i</span><span class="p">,</span> <span class="n">eps_xy_i</span><span class="p">,</span> <span class="n">eps_xz_i</span><span class="p">,</span> <span class="n">eps_yz_i</span> <span class="p">]</span>
            <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: write_eps_results length vs&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.write_crystal_results"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.write_crystal_results">[docs]</a>    <span class="k">def</span> <span class="nf">write_crystal_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">vs</span><span class="p">,</span> <span class="n">legends</span><span class="p">,</span> <span class="n">yss</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Wrte single crystal results to a spread sheet</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sp : object</span>
<span class="sd">            The spreadsheet object.</span>
<span class="sd">        name : str</span>
<span class="sd">            The worksheet name used for writing.</span>
<span class="sd">        vs : np.array</span>
<span class="sd">            An array of the frequencies.</span>
<span class="sd">        yss : list of np.arrays</span>
<span class="sd">            A list of numpy arrays of the reflections and transmittance.</span>
<span class="sd">        headings : list</span>
<span class="sd">            The heading names for the yss.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: write_crystal_results&#39;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;write_crystal_results name&#39;</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;write_crystal_results legends&#39;</span><span class="p">,</span><span class="n">legends</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;write_crystal_results length vs&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">selectWorkSheet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;frequencies (cm-1)&#39;</span><span class="p">]</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iv</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vs</span><span class="p">):</span>
           <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
           <span class="k">for</span> <span class="n">ys</span> <span class="ow">in</span> <span class="n">yss</span><span class="p">:</span>
               <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">iv</span><span class="p">])</span>
           <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: write_crystal_results&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.write_powder_results"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.write_powder_results">[docs]</a>    <span class="k">def</span> <span class="nf">write_powder_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sp</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">vs</span><span class="p">,</span> <span class="n">legends</span><span class="p">,</span> <span class="n">yss</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Writes the powder simulation results to a worksheet.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        sp : object</span>
<span class="sd">            An object with methods for manipulating a worksheet.</span>
<span class="sd">        name : str</span>
<span class="sd">            The name of the worksheet to select or create.</span>
<span class="sd">        vs : list</span>
<span class="sd">            A list of frequency values (in cm-1).</span>
<span class="sd">        legends : list of str</span>
<span class="sd">            The legends to be used as headers, alongside &#39;frequencies (cm-1)&#39;.</span>
<span class="sd">        yss : list of lists</span>
<span class="sd">            A list where each element is a list of intensities corresponding to each frequency in `vs`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: write powder results&#39;</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;write_powder_results name&#39;</span><span class="p">,</span><span class="n">name</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;write_powder_results legends&#39;</span><span class="p">,</span><span class="n">legends</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;write_powder_results length vs&#39;</span><span class="p">,</span><span class="nb">len</span><span class="p">(</span><span class="n">vs</span><span class="p">))</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">selectWorkSheet</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;frequencies (cm-1)&#39;</span><span class="p">]</span>
        <span class="c1">#for isc,ys in enumerate(yss):</span>
        <span class="c1">#    headers.append(&#39;Scenario&#39;+str(isc))</span>
        <span class="n">headers</span><span class="o">.</span><span class="n">extend</span><span class="p">(</span><span class="n">legends</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span><span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">iv</span><span class="p">,</span><span class="n">v</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vs</span><span class="p">):</span>
           <span class="n">output</span> <span class="o">=</span> <span class="p">[</span><span class="n">v</span><span class="p">]</span>
           <span class="k">for</span> <span class="n">ys</span> <span class="ow">in</span> <span class="n">yss</span><span class="p">:</span>
               <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">ys</span><span class="p">[</span><span class="n">iv</span><span class="p">])</span>
           <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">output</span><span class="p">,</span> <span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: write powder results&#39;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="PlottingTab.plot"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="c1"># import matplotlib.pyplot as pl</span>
        <span class="c1"># mp.use(&#39;Qt5Agg&#39;)</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plots the results based on specified settings and scenarios.</span>

<span class="sd">        This function generates a plot for the given scenarios under the analysis settings</span>
<span class="sd">        defined in the notebook object&#39;s tabs. It handles various conditions to properly format</span>
<span class="sd">        the plot, including checking if necessary parameters and objects are set, converting</span>
<span class="sd">        frequency units, and adjusting data for display based on plot type. The actual plotting</span>
<span class="sd">        is done using matplotlib, and various attributes like plot legends, titles, and axes labels</span>
<span class="sd">        are dynamically set based on the configuration.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - self.notebook.mainTab.settings: Dictionary containing program settings.</span>
<span class="sd">        - self.notebook.mainTab.getFullFileName(): Method that returns the currently selected filename.</span>
<span class="sd">        - self.notebook.mainTab.reader: Object used for reading data files.</span>
<span class="sd">        - self.notebook.settingsTab.CrystalPermittivityObject: Object containing crystal permittivity settings.</span>
<span class="sd">        - self.settings: Dictionary containing plot-related settings such as frequency range and plot type.</span>
<span class="sd">        - self.notebook.scenarios: List of scenarios to be plotted.</span>
<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: plot&#39;</span><span class="p">)</span>
        <span class="c1"># Assemble the mainTab settings</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">settings</span>
        <span class="n">program</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Program&#39;</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">getFullFileName</span><span class="p">()</span>
        <span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">reader</span>
        <span class="k">if</span> <span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: plot aborting because reader is NONE&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: plot aborting because program is not set&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: plot aborting because filename is not set&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">settingsTab</span><span class="o">.</span><span class="n">CrystalPermittivityObject</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: plot aborting because settingTab.CrystalPermittivityObject is not set&#39;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Minimum frequency&#39;</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Maximum frequency&#39;</span><span class="p">]</span>
        <span class="n">vinc</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency increment&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">vmin</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vmax</span><span class="p">)</span><span class="o">+</span><span class="mf">0.5</span><span class="o">*</span><span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">vinc</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">)</span>
        <span class="n">removeFirstElement</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">reverseElements</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># We can&#39;t have a 0 frequency converted to a wavelength</span>
            <span class="n">removeFirstElement</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
        <span class="k">if</span> <span class="n">isThisAFrequencyUnit</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]):</span>
            <span class="n">x</span> <span class="o">=</span> <span class="n">x</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="n">reverseElements</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;wavenumber&#39;</span><span class="p">:</span>
            <span class="n">xlabel</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;Frequency $\mathdefault{(cm^{-1})}$&#39;</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">convert_frequency_units</span><span class="p">(</span> <span class="n">x</span><span class="p">,</span> <span class="s1">&#39;wavenumber&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Frequency unit&#39;</span><span class="p">]</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">progressbars_set_maximum</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">get_total_number_of_frequency_calculations</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">scenarios</span><span class="p">:</span>
            <span class="n">legend</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Legend&#39;</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">legend</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">get_result</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">vs_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">])</span>
            <span class="k">if</span> <span class="n">y</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">y</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">removeFirstElement</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span>
                <span class="k">if</span> <span class="n">reverseElements</span><span class="p">:</span>
                     <span class="n">y</span> <span class="o">=</span> <span class="n">y</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Powder Molar Absorption&#39;</span><span class="p">:</span>
                    <span class="n">y</span> <span class="o">=</span> <span class="n">y</span> <span class="o">*</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;cell concentration&#39;</span><span class="p">]</span><span class="o">/</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;concentration&#39;</span><span class="p">]</span>
                <span class="n">plots</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">line</span><span class="p">,</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">lw</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="n">legend</span> <span class="p">)</span>
        <span class="k">if</span> <span class="n">plots</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_ylabels</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">]])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;best&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">])</span>
            <span class="c1">#self.subplot.set_autoscaley_on(False)</span>
            <span class="c1">#self.subplot.set_ylim([0,1])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: plot&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="PlottingTab.get_number_of_calculations_required"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.get_number_of_calculations_required">[docs]</a>    <span class="k">def</span> <span class="nf">get_number_of_calculations_required</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Return the total number of spectra that need to be calculated.</span>

<span class="sd">        Only spectra that need a refresh are included.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">            The total number of spectra that require calculation.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: get_number_of_calculations_required&#39;</span><span class="p">)</span>
        <span class="n">n</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">scenarios</span><span class="p">:</span>
            <span class="n">n</span> <span class="o">+=</span> <span class="n">scenario</span><span class="o">.</span><span class="n">getNoCalculationsRequired</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;get_number_of_calculations_required&#39;</span><span class="p">,</span><span class="n">n</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">n</span></div>

<div class="viewcode-block" id="PlottingTab.greyed_out"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html#PDielec.GUI.PlottingTab.PlottingTab.greyed_out">[docs]</a>    <span class="k">def</span> <span class="nf">greyed_out</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Handle items that should be greyed out if they are not needed.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        int</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Start:: greyed_out&#39;</span><span class="p">)</span>
        <span class="n">powder_scenarios_present</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">crystal_scenarios_present</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">scenario</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">scenarios</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">scenario</span><span class="o">.</span><span class="n">scenarioType</span> <span class="o">==</span> <span class="s1">&#39;Powder&#39;</span><span class="p">:</span>
                <span class="n">powder_scenarios_present</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">crystal_scenarios_present</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="c1"># end of for loop</span>
        <span class="c1"># </span>
        <span class="c1"># Disable any plot types that are not needed</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">index</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">findText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">],</span> <span class="n">Qt</span><span class="o">.</span><span class="n">MatchFixedString</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">powder_scenarios_present</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">crystal_scenarios_present</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">7</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">8</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">9</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">model</span><span class="p">()</span><span class="o">.</span><span class="n">item</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">index</span> <span class="o">&gt;=</span> <span class="mi">5</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s1">&#39;Plot type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_cb</span><span class="o">.</span><span class="n">currentText</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;Finished:: greyed_out&#39;</span><span class="p">)</span></div></div>
</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, John Kendrick and Andrew Burnett
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=01b4f342"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>