<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>PDielec.GUI.AnalysisTab - PDielec: John Kendrick &amp; Andrew Burnett</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=80d5e7a1" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2e0a580d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">PDielec: John Kendrick & Andrew Burnett</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon no-toc" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">PDielec: John Kendrick & Andrew Burnett</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pdgui.html">PDGui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software.html">Other Software Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_powder.html">Theory for Light Scattering from Powders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_single_crystal.html">Theory for Single Crystal Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analysis.html">Phonon Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_1.html">Applications of Effective Medium Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_2.html">Single Crystal Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../../autoapi/index.html">API Reference</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../../../autoapi/PDielec/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of PDielec</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../../../autoapi/PDielec/GUI/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of PDielec.GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.AnalysisTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/App/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.App</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/FitterTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.FitterTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/MainTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.MainTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/NoteBook/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.NoteBook</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/OpenGLWidget/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.OpenGLWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PlottingTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PlottingTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/PowderScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PowderScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SettingsTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SettingsTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalLayer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SingleCrystalScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/SpreadSheetManager/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SpreadSheetManager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../../../autoapi/PDielec/GUI/ViewerTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ViewerTab</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/AbinitOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.AbinitOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Calculator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Calculator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CastepOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CastepOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Constants/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Constants</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/CrystalOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CrystalOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/DielectricFunction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.DielectricFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/ExperimentOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.ExperimentOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GTMcore/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GTMcore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GenericOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GenericOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/GulpOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GulpOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/HelperRoutines/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.HelperRoutines</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/IO/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.IO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Materials/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Materials</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Mie/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Mie</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/PhonopyOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.PhonopyOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Plotter/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Plotter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/QEOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.QEOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/SuperCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.SuperCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/UnitCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.UnitCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/Utilities/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Utilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/VaspOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.VaspOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkcsv/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkcsv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/checkexcel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkexcel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/graphdatagenerator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.graphdatagenerator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p1reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p1reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/p2cif/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p2cif</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdcompare/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/pickled_reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pickled_reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../../../autoapi/PDielec/vibanalysis/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.vibanalysis</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../autoapi/PDielec/pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../zreferences.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon no-toc" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <h1>Source code for PDielec.GUI.AnalysisTab</h1><div class="highlight"><pre>
<span></span><span class="c1">#</span>
<span class="c1"># Copyright 2024 John Kendrick &amp; Andrew Burnett</span>
<span class="c1">#</span>
<span class="c1"># This file is part of PDielec</span>
<span class="c1">#</span>
<span class="c1"># This program is free software; you can redistribute it and/or modify</span>
<span class="c1"># it under the terms of the MIT License</span>
<span class="c1">#</span>
<span class="c1"># This program is distributed in the hope that it will be useful,</span>
<span class="c1"># but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span class="c1"># MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.</span>
<span class="c1">#</span>
<span class="c1"># You should have received a copy of the MIT License along with this program, if not see https://opensource.org/licenses/MIT</span>
<span class="c1">#</span>
<span class="sd">&quot;&quot;&quot;AnalysisTab Module.&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">math</span>

<span class="c1"># Import plotting requirements</span>
<span class="kn">import</span> <span class="nn">matplotlib</span>
<span class="kn">import</span> <span class="nn">matplotlib.figure</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="kn">import</span> <span class="n">FigureCanvasQTAgg</span> <span class="k">as</span> <span class="n">FigureCanvas</span>
<span class="kn">from</span> <span class="nn">matplotlib.backends.backend_qt5agg</span> <span class="kn">import</span> <span class="n">NavigationToolbar2QT</span> <span class="k">as</span> <span class="n">NavigationToolbar</span>
<span class="kn">from</span> <span class="nn">matplotlib.ticker</span> <span class="kn">import</span> <span class="n">MaxNLocator</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtCore</span> <span class="kn">import</span> <span class="n">QCoreApplication</span><span class="p">,</span> <span class="n">Qt</span>
<span class="kn">from</span> <span class="nn">PyQt5.QtWidgets</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">QApplication</span><span class="p">,</span>
    <span class="n">QComboBox</span><span class="p">,</span>
    <span class="n">QDoubleSpinBox</span><span class="p">,</span>
    <span class="n">QFormLayout</span><span class="p">,</span>
    <span class="n">QHBoxLayout</span><span class="p">,</span>
    <span class="n">QLabel</span><span class="p">,</span>
    <span class="n">QLineEdit</span><span class="p">,</span>
    <span class="n">QSizePolicy</span><span class="p">,</span>
    <span class="n">QTableWidgetItem</span><span class="p">,</span>
    <span class="n">QVBoxLayout</span><span class="p">,</span>
    <span class="n">QWidget</span><span class="p">,</span>
<span class="p">)</span>

<span class="kn">from</span> <span class="nn">PDielec</span> <span class="kn">import</span> <span class="n">Calculator</span>
<span class="kn">from</span> <span class="nn">PDielec.Constants</span> <span class="kn">import</span> <span class="n">covalent_radii</span>
<span class="kn">from</span> <span class="nn">PDielec.GUI.SettingsTab</span> <span class="kn">import</span> <span class="n">FixedQTableWidget</span>
<span class="kn">from</span> <span class="nn">PDielec.Utilities</span> <span class="kn">import</span> <span class="n">Debug</span>


<div class="viewcode-block" id="AnalysisTab"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab">[docs]</a><span class="k">class</span> <span class="nc">AnalysisTab</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;A widget class for analyzing vibrational modes, molecular composition, and bonding configurations within a molecular dataset.</span>

<span class="sd">    This class inherits from QWidget</span>
<span class="sd">    Key features include plotting vibrational mode decompositions</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    parent : QObject</span>
<span class="sd">        The parent widget or object, typically the main application or main window in which this widget will be embedded.</span>
<span class="sd">    debug : bool, optional</span>
<span class="sd">        Indicates if debugging is enabled for this widget. The default is False.</span>

<span class="sd">    Attributes</span>
<span class="sd">    ----------</span>
<span class="sd">    subplot : matplotlib subplot</span>
<span class="sd">        A subplot attribute for plotting the analysis results. </span>
<span class="sd">    settings : dict</span>
<span class="sd">        A dictionary for storing various settings related to analysis, like radii, frequencies, and plotting configurations.</span>
<span class="sd">    settings[&#39;Radii&#39;] : list </span>
<span class="sd">        Holds specific radii settings if provided; otherwise, set to None.</span>
<span class="sd">    settings[&#39;Minimum frequency&#39;] : int</span>
<span class="sd">        The minimum frequency boundary for analysis, initialized to -1.</span>
<span class="sd">    settings[&#39;Maximum frequency&#39;] : int</span>
<span class="sd">        The maximum frequency boundary for analysis, initialized to 400.</span>
<span class="sd">    settings[&#39;title&#39;] : str</span>
<span class="sd">        The title for plots generated within the widget. Defaults to &#39;Analysis&#39;.</span>
<span class="sd">    settings[&#39;Covalent radius scaling&#39;] : float</span>
<span class="sd">        A scaling factor for adjusting covalent radii in bonding calculations. Defaults to 1.1.</span>
<span class="sd">    settings[&#39;Bonding tolerance&#39;] : float</span>
<span class="sd">        The tolerance level used in bonding calculations, determining what is considered a bond. Defaults to 0.1.</span>
<span class="sd">    settings[&#39;Bar width&#39;] : float</span>
<span class="sd">        Determines the width of bars in bar plots. Defaults to 0.5.</span>
<span class="sd">    refreshRequired : bool</span>
<span class="sd">        A flag indicating whether the widget needs to be refreshed to update the visuals or calculations. Defaults to True.</span>
<span class="sd">    plot_types : list</span>
<span class="sd">        A list of available plot types the user can select from.</span>
<span class="sd">    plot_type_index : int</span>
<span class="sd">        The index of the currently selected plot type in `plot_types` list.</span>
<span class="sd">    number_of_molecules : int</span>
<span class="sd">        The number of molecules identified during the last analysis. Defaults to 0.</span>
<span class="sd">    frequency_units : str or None</span>
<span class="sd">        String representing the units used for frequency measurements. Initially set to None.</span>
<span class="sd">    cell_of_molecules : object or None</span>
<span class="sd">        An object containing information about the cell of molecules, if analysis has been run. Initially set to None.</span>
<span class="sd">    original_atomic_order : list or None</span>
<span class="sd">        List maintaining the original order of atoms as read from the input. Initially set to None.</span>
<span class="sd">    frequencies_cm1 : list</span>
<span class="sd">        A list holding frequency values in cm-1 units.</span>
<span class="sd">    mode_energies : list</span>
<span class="sd">        Stores the calculated energies for different vibrational modes.</span>
<span class="sd">    element_radii : dict</span>
<span class="sd">        A dictionary mapping elements to their corresponding covalent radii used in the analysis.</span>
<span class="sd">    species : list</span>
<span class="sd">        A list of species involved in the current analysis.</span>
<span class="sd">    notebook : object</span>
<span class="sd">        A reference to the parent notebook-like structure which hosts this widget.</span>
<span class="sd">    reader : object</span>
<span class="sd">        An object responsible for reading and interpreting molecular data files.</span>

<span class="sd">    Methods</span>
<span class="sd">    -------</span>
<span class="sd">    on_element_radii_tw_itemClicked(self, item)</span>
<span class="sd">        Handler for click events on table widget items related to element radii.</span>
<span class="sd">    on_element_radii_tw_itemChanged(self, item)</span>
<span class="sd">        Handler for changes in the table widget items related to element radii.</span>
<span class="sd">    set_radii_tw(self)</span>
<span class="sd">        Updates the radii table widget based on current settings or data.</span>
<span class="sd">    setCovalentRadius(self, element, radius)</span>
<span class="sd">        Sets the covalent radius for a given element and updates the analysis.</span>
<span class="sd">    writeSpreadsheet(self)</span>
<span class="sd">        Writes the analysis results to a spreadsheet hosted by the parent structure.</span>
<span class="sd">    on_width_changed(self, value)</span>
<span class="sd">        Handler for changes in the bar width setting.</span>
<span class="sd">    on_scale_changed(self, value)</span>
<span class="sd">        Handler for changes in the covalent radius scaling setting.</span>
<span class="sd">    on_tolerance_changed(self, value)</span>
<span class="sd">        Handler for changes in the bonding tolerance setting.</span>
<span class="sd">    on_title_changed(self, text)</span>
<span class="sd">        Handler for changes in the plot title.</span>
<span class="sd">    on_vmin_changed(self)</span>
<span class="sd">        Handler for changes in the minimum frequency setting.</span>
<span class="sd">    on_vmax_changed(self)</span>
<span class="sd">        Handler for changes in the maximum frequency setting.</span>
<span class="sd">    requestRefresh(self)</span>
<span class="sd">        Requests a refresh of the analysis and visualization.</span>
<span class="sd">    refresh(self, force=False)</span>
<span class="sd">        Refreshes the widget based on current settings, optionally forcing a refresh.</span>
<span class="sd">    on_plottype_cb_changed(self, index)</span>
<span class="sd">        Handler for changes in the selected plot type.</span>
<span class="sd">    calculate(self)</span>
<span class="sd">        Performs calculations based on current settings, preparing data for visualization.</span>
<span class="sd">    plot(self)</span>
<span class="sd">        Invokes the plotting method corresponding to the current plot type selection.</span>
<span class="sd">    plot_molecular(self)</span>
<span class="sd">        Generates a plot based on molecular composition of vibrational energy.</span>
<span class="sd">    plot_internal_external(self)</span>
<span class="sd">        Generates a plot based on the decomposition of vibrational energy into internal and external movements.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">parent</span><span class="p">,</span> <span class="n">debug</span><span class="o">=</span><span class="kc">False</span> <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialise the analysis tab with configurable settings and plotting capabilities.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        parent : QObject</span>
<span class="sd">            The parent widget or object, typically the main application or main window in which this widget will be embedded.</span>
<span class="sd">        debug : bool, optional</span>
<span class="sd">            Indicates if debugging is enabled for this widget. The default is False.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="nb">super</span><span class="p">(</span><span class="n">QWidget</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">parent</span><span class="p">)</span>
        <span class="k">global</span> <span class="n">debugger</span>
        <span class="n">debugger</span> <span class="o">=</span> <span class="n">Debug</span><span class="p">(</span><span class="n">debug</span><span class="p">,</span><span class="s2">&quot;AnalysisTab&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setWindowTitle</span><span class="p">(</span><span class="s2">&quot;Analysis&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Radii&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">400</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Analysis&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Covalent radius scaling&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">1.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bonding tolerance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bar width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="mf">0.5</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Internal vs External&quot;</span><span class="p">,</span><span class="s2">&quot;Molecular Composition&quot;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequency_units</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_of_molecules</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">original_atomic_order</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_energies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii</span> <span class="o">=</span> <span class="n">covalent_radii</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="c1"># store the notebook</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span> <span class="o">=</span> <span class="n">parent</span>
        <span class="c1"># get the reader from the main tab</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">reader</span>
        <span class="c1"># Create last tab - AnalysisTab</span>
        <span class="n">vbox</span> <span class="o">=</span> <span class="n">QVBoxLayout</span><span class="p">()</span>
        <span class="n">form</span> <span class="o">=</span> <span class="n">QFormLayout</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># The minimum frequency</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="o">-</span><span class="mi">100</span><span class="p">,</span><span class="mi">9000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Set the minimum frequency to be considered)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_vmin_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Minimum frequency:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Set the minimum frequency to be considered)&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># The maximum frequency</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">9000</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Set the maximum frequency to be considered)&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_vmax_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Maximum frequency:&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Set the maximum frequency to be considered)&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># The bonding tolerance and scaling of radii frequency</span>
        <span class="c1">#</span>
        <span class="n">hbox</span> <span class="o">=</span> <span class="n">QHBoxLayout</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">10.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Covalent radius scaling&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Scale the covalent radii to determine bonding&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_scale_changed</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bonding tolerance&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Tolerance for bonding is determined from scale*(radi+radj)+toler&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_tolerance_changed</span><span class="p">)</span>
        <span class="n">hbox</span><span class="o">.</span><span class="n">addWidget</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Bonding scale and tolerance&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Bonding is determined from scale*(radi+radj)+toler&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="n">hbox</span><span class="p">)</span>
        <span class="c1"># Add a table of covalent radii</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span> <span class="o">=</span> <span class="n">FixedQTableWidget</span><span class="p">(</span><span class="n">parent</span><span class="o">=</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Individual covalent radii used to determine bonding can be set here&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">itemClicked</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_element_radii_tw_itemClicked</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">itemChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_element_radii_tw_itemChanged</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">setRowCount</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">sizePolicy</span> <span class="o">=</span> <span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Minimum</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">sizePolicy</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Atomic radii&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="p">)</span>
        <span class="c1"># Add number of molecules found</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_le</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_le</span><span class="o">.</span><span class="n">setEnabled</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_le</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The bonding tolerances can change the number of molecules found&quot;</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Number of molecules found&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The bonding tolerances can change the number of molecules found&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">molecules_le</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># The plotting width of bar</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span> <span class="o">=</span> <span class="n">QDoubleSpinBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="o">.</span><span class="n">setRange</span><span class="p">(</span><span class="mf">0.01</span><span class="p">,</span><span class="mf">2.0</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="o">.</span><span class="n">setSingleStep</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="o">.</span><span class="n">setDecimals</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bar width&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Change the width of the bars - should be between 0 and 1&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="o">.</span><span class="n">valueChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_width_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Bar width&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Change the width of the bars - should be between 0 and 1&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Set the plot title</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_le</span> <span class="o">=</span> <span class="n">QLineEdit</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_le</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Set the plot title&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_le</span><span class="o">.</span><span class="n">textChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_title_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Plot title&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;Set the plot title&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">title_le</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Add a comb box to select which type of plot</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cb</span> <span class="o">=</span> <span class="n">QComboBox</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cb</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The energy can be decomposed either according to internal vs external motion or into a molecular based decompostion&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cb</span><span class="o">.</span><span class="n">addItems</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_types</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_type_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cb</span><span class="o">.</span><span class="n">currentIndexChanged</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">on_plottype_cb_changed</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">QLabel</span><span class="p">(</span><span class="s2">&quot;Choose the plot type&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="n">label</span><span class="o">.</span><span class="n">setToolTip</span><span class="p">(</span><span class="s2">&quot;The energy can be decomposed either according to internal vs external motion or into a molecular based decompostion&quot;</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="n">label</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cb</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Add the matplotlib figure to the bottom</span>
        <span class="c1">#</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span> <span class="o">=</span> <span class="n">matplotlib</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">Figure</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span> <span class="o">=</span> <span class="n">FigureCanvas</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Expanding</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span> <span class="o">=</span> <span class="n">NavigationToolbar</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="o">.</span><span class="n">setSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="p">(</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">,</span><span class="n">QSizePolicy</span><span class="o">.</span><span class="n">Fixed</span><span class="p">))</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="p">)</span>
        <span class="n">form</span><span class="o">.</span><span class="n">addRow</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">toolbar</span><span class="p">)</span>
        <span class="n">vbox</span><span class="o">.</span><span class="n">addLayout</span><span class="p">(</span><span class="n">form</span><span class="p">)</span>
        <span class="c1"># finalise the layout</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">setLayout</span><span class="p">(</span><span class="n">vbox</span><span class="p">)</span>
        <span class="n">QCoreApplication</span><span class="o">.</span><span class="n">processEvents</span><span class="p">()</span>
        <span class="c1">#if self.notebook.spreadsheet is not None:</span>
        <span class="c1">#    self.writeSpreadsheet()</span>
        <span class="c1">#QCoreApplication.processEvents()</span>

<div class="viewcode-block" id="AnalysisTab.on_element_radii_tw_itemClicked"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_element_radii_tw_itemClicked">[docs]</a>    <span class="k">def</span> <span class="nf">on_element_radii_tw_itemClicked</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the item clicked event for a TableWidget related to element radii.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : QTableWidgetItem</span>
<span class="sd">            The item from the TableWidget that was clicked.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This function unblocks signals for the `element_radii_tw` TableWidget after an item click</span>
<span class="sd">        event has occurred, allowing subsequent events to be processed.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span></div>

<div class="viewcode-block" id="AnalysisTab.on_element_radii_tw_itemChanged"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_element_radii_tw_itemChanged">[docs]</a>    <span class="k">def</span> <span class="nf">on_element_radii_tw_itemChanged</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">item</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Respond to changes in element radii within a widget.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        item : QTableWidgetItem</span>
<span class="sd">            The table widget item that was changed. This item contains the new radius value as its text, and its column indicates which element&#39;s radius was modified.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">col</span> <span class="o">=</span> <span class="n">item</span><span class="o">.</span><span class="n">column</span><span class="p">()</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Changing the element radius&quot;</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Radii&quot;</span><span class="p">][</span><span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">viewerTab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">viewerTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
        <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Failed Changing the element radius&quot;</span><span class="p">,</span><span class="n">col</span><span class="p">,</span><span class="n">item</span><span class="o">.</span><span class="n">text</span><span class="p">())</span>
            <span class="k">pass</span></div>

<div class="viewcode-block" id="AnalysisTab.set_radii_tw"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.set_radii_tw">[docs]</a>    <span class="k">def</span> <span class="nf">set_radii_tw</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set or update the atomic radii in the GUI&#39;s table widget based on the current settings and active file.</span>

<span class="sd">        This method updates the radii configuration within the element radii table widget of the GUI. It first ensures that</span>
<span class="sd">        a reader object, a program, and a filename are set and available. If any of these are missing, the process is aborted</span>
<span class="sd">        with a message. It then checks if custom radii are set in the settings; if not, it defaults to using pre-defined radii.</span>
<span class="sd">        The species and their corresponding radii are then used to populate the table widget. After the table is populated,</span>
<span class="sd">        it updates the settings with the possibly new radii values.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None </span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">reader</span>
        <span class="n">program</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Program&quot;</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">getFullFileName</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;set_radii_tw aborting - no reader&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;set_radii_tw aborting - no program&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;set_radii_tw aborting - no filename&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;set_radii_tw starting&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">getSpecies</span><span class="p">()</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Radii&quot;</span><span class="p">]</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">radii</span> <span class="o">=</span> <span class="p">[</span> <span class="bp">self</span><span class="o">.</span><span class="n">element_radii</span><span class="p">[</span><span class="n">el</span><span class="p">]</span> <span class="k">for</span> <span class="n">el</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">species</span> <span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">radii</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Radii&quot;</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">sp</span><span class="p">,</span><span class="n">rad</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Radii&quot;</span><span class="p">]):</span>
               <span class="bp">self</span><span class="o">.</span><span class="n">element_radii</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">rad</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">setColumnCount</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">setHorizontalHeaderLabels</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">setVerticalHeaderLabels</span><span class="p">([</span><span class="s2">&quot;&quot;</span><span class="p">])</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">radius</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">radii</span><span class="p">):</span>
            <span class="n">qw</span> <span class="o">=</span> <span class="n">QTableWidgetItem</span><span class="p">()</span>
            <span class="n">qw</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">radius</span><span class="si">:</span><span class="s2">.6f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">qw</span><span class="o">.</span><span class="n">setTextAlignment</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">AlignHCenter</span> <span class="o">|</span> <span class="n">Qt</span><span class="o">.</span><span class="n">AlignVCenter</span><span class="p">))</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">setItem</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">i</span><span class="p">,</span> <span class="n">qw</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii_tw</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Radii&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">radii</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;set_radii_tw finishing&quot;</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="AnalysisTab.setCovalentRadius"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.setCovalentRadius">[docs]</a>    <span class="k">def</span> <span class="nf">setCovalentRadius</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">element</span><span class="p">,</span><span class="n">radius</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set the covalent radius for a given element and update the plot.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        element : str</span>
<span class="sd">            The chemical symbol of the element for which to set the covalent radius.</span>
<span class="sd">        radius : float</span>
<span class="sd">            The new covalent radius for the element.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">element_radii</span><span class="p">[</span><span class="n">element</span><span class="p">]</span> <span class="o">=</span> <span class="n">radius</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_radii_tw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.writeSpreadsheet"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.writeSpreadsheet">[docs]</a>    <span class="k">def</span> <span class="nf">writeSpreadsheet</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Write analysis data into a selected worksheet in the notebook&#39;s spreadsheet.</span>

<span class="sd">        This method assumes the existence of a spreadsheet object within the notebook</span>
<span class="sd">        attribute of the class instance. It selects a worksheet named &#39;Analysis&#39;,</span>
<span class="sd">        writes a header row and data rows containing calculated percentages of</span>
<span class="sd">        vibrational mode contributions for molecules and internal/external modes.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">spreadsheet</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">sp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">spreadsheet</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">selectWorkSheet</span><span class="p">(</span><span class="s2">&quot;Analysis&quot;</span><span class="p">)</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">delete</span><span class="p">()</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">([</span><span class="s2">&quot;Analysis of the vibrational modes into percentage contributions for molecules and internal/external modes&quot;</span><span class="p">],</span> <span class="n">row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mode&quot;</span><span class="p">,</span><span class="s2">&quot;Frequency (cm-1)&quot;</span><span class="p">,</span> <span class="s2">&quot;Centre of mass %&quot;</span><span class="p">,</span><span class="s2">&quot;Rotational %&quot;</span><span class="p">,</span> <span class="s2">&quot;Vibrational %&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">mol</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span><span class="p">):</span>
            <span class="n">headers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Molecule &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span><span class="o">+</span><span class="s2">&quot; %&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">imode</span><span class="p">,(</span><span class="n">freq</span><span class="p">,</span><span class="n">energies</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">mode_energies</span><span class="p">)):</span>
           <span class="n">tote</span><span class="p">,</span><span class="n">cme</span><span class="p">,</span><span class="n">rote</span><span class="p">,</span><span class="n">vibe</span><span class="p">,</span> <span class="n">molecular_energies</span> <span class="o">=</span> <span class="n">energies</span>
           <span class="n">tote</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tote</span><span class="p">,</span><span class="mf">1.0E-8</span><span class="p">)</span>
           <span class="n">output</span> <span class="o">=</span> <span class="p">[</span> <span class="n">imode</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">freq</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">cme</span><span class="o">/</span><span class="n">tote</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">rote</span><span class="o">/</span><span class="n">tote</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">vibe</span><span class="o">/</span><span class="n">tote</span> <span class="p">]</span>
           <span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="n">molecular_energies</span><span class="p">:</span>
               <span class="n">output</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mi">100</span><span class="o">*</span><span class="n">e</span><span class="o">/</span><span class="n">tote</span><span class="p">)</span>
           <span class="n">sp</span><span class="o">.</span><span class="n">writeNextRow</span><span class="p">(</span><span class="n">output</span><span class="p">,</span><span class="n">col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">check</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span></div>


<div class="viewcode-block" id="AnalysisTab.on_width_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_width_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_width_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle changes to the width property.</span>

<span class="sd">        This method is called when the width property of an object is changed. It updates the stored width value in the object&#39;s settings and then re-plots the object to reflect the new width.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : int or float</span>
<span class="sd">            The new value for the width.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on width changed &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bar width&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.on_scale_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_scale_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_scale_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the event when the scale setting is changed.</span>

<span class="sd">        This function is typically connected to a signal that is emitted when the</span>
<span class="sd">        scaling factor for the covalent radius is adjusted in a graphical user interface.</span>
<span class="sd">        It updates the stored &#39;Covalent radius scaling&#39; value, marks that a refresh is</span>
<span class="sd">        required, calculates necessary data based on new settings, and finally triggers</span>
<span class="sd">        a plot update.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The new scale value for the covalent radius.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on scale_le changed &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Covalent radius scaling&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.on_tolerance_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_tolerance_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_tolerance_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the event when the tolerance value changes.</span>

<span class="sd">        This function updates the &#39;Bonding tolerance&#39; setting based on the provided value, marks the system as requiring a refresh, and then recalculates and replots the data.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        value : float</span>
<span class="sd">            The new tolerance value.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on_tolerance_le changed &quot;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bonding tolerance&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.on_title_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_title_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_title_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span><span class="n">text</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle title change events.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            The new title text.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">text</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on title change &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span></div>

<div class="viewcode-block" id="AnalysisTab.on_vmin_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_vmin_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_vmin_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the change in minimum value of frequency.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            The new title text.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vmin</span> <span class="o">&lt;</span> <span class="n">vmax</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmin</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on_vmin_changed new value&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on_vmin_changed restricting value to&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="AnalysisTab.on_vmax_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_vmax_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_vmax_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle the change in maximum value for frequency.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        text : str</span>
<span class="sd">            The new title text.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">value</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">vmax</span> <span class="o">&gt;</span> <span class="n">vmin</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vmax</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on_vmax_changed new value&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;on_vmax_changed restricting value to&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="AnalysisTab.requestRefresh"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.requestRefresh">[docs]</a>    <span class="k">def</span> <span class="nf">requestRefresh</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Mark the instance as requiring a refresh.</span>

<span class="sd">        Sets the instance attribute `refreshRequired` to True, indicating that a refresh is necessary.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">True</span></div>

<div class="viewcode-block" id="AnalysisTab.refresh"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.refresh">[docs]</a>    <span class="k">def</span> <span class="nf">refresh</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">force</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Refresh the widget state, optionally enforcing refresh.</span>

<span class="sd">        This method updates the widgets&#39; states and values according to the current settings. It first checks if a refresh is required or if the `force` parameter is set to `True`. If neither condition is met, it exits early. Otherwise, it proceeds to block signals from all child QWidget instances to avoid unwanted signal emission during state update. It then updates various UI components with new settings values, calculates and plots according to the updated settings, and finally re-enables signals for all child QWidget instances.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        force : bool, optional</span>
<span class="sd">            If set to `True`, the widget refresh is forced even if it is deemed not required. Defaults to `False`.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="ow">and</span> <span class="ow">not</span> <span class="n">force</span><span class="p">:</span>
            <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;return with no refresh&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span><span class="p">,</span> <span class="n">force</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Refreshing widget&quot;</span><span class="p">)</span>
        <span class="c1">#</span>
        <span class="c1"># Block signals during refresh</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmin_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">vmax_sb</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scale_sp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Covalent radius scaling&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tolerance_sp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bonding tolerance&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">width_sp</span><span class="o">.</span><span class="n">setValue</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bar width&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">title_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;title&quot;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plottype_cb</span><span class="o">.</span><span class="n">setCurrentIndex</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">plot_type_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_radii_tw</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">calculate</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span>
        <span class="c1">#</span>
        <span class="c1"># Unlock signals after refresh</span>
        <span class="c1">#</span>
        <span class="k">for</span> <span class="n">w</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">findChildren</span><span class="p">(</span><span class="n">QWidget</span><span class="p">):</span>
            <span class="n">w</span><span class="o">.</span><span class="n">blockSignals</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="k">return</span></div>

<div class="viewcode-block" id="AnalysisTab.on_plottype_cb_changed"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.on_plottype_cb_changed">[docs]</a>    <span class="k">def</span> <span class="nf">on_plottype_cb_changed</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">index</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Handle a change in plot type selection.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        index : int</span>
<span class="sd">            The new index that indicates the selected plot type.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_index</span> <span class="o">=</span> <span class="n">index</span>
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;Plot type index changed to &quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_index</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.calculate"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.calculate">[docs]</a>    <span class="k">def</span> <span class="nf">calculate</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Perform calculations for the current object state including molecular contents, normal modes, and energy distributions.</span>

<span class="sd">        This method orchestrates the calculation process, setting up necessary parameters, processing molecular contents</span>
<span class="sd">        based on the provided settings, calculating normal modes and their mass weighting, and finally computing the energy</span>
<span class="sd">        distribution among the modes. It updates the UI and internal state as necessary based on the calculation results.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        The function interacts with several attributes of the object it belongs to, including:</span>
<span class="sd">        - `self.notebook.mainTab.settings`: Access to settings specific to the main tab.</span>
<span class="sd">        - `self.notebook.mainTab.reader`: The reader associated with the main tab for accessing file data.</span>
<span class="sd">        - `self.species` and `self.settings[&#39;Radii&#39;]`: Used for setting up element radii.</span>
<span class="sd">        - `self.notebook.settingsTab.settings`, `self.notebook.settingsTab.frequencies_cm1`, and </span>
<span class="sd">        - `self.notebook.settingsTab.mass_weighted_normal_modes`: Access to settings and data specific to the settings tab.</span>
<span class="sd">        - `self.cell_of_molecules`, `self.original_atomic_order`, `self.number_of_molecules`: Modifies and utilizes these attributes</span>
<span class="sd">        - to hold molecular content, order of atoms, and the number of molecules, respectively.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="n">debugger</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s2">&quot;calculate&quot;</span><span class="p">)</span>
        <span class="c1"># Assemble the mainTab settings</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">settings</span>
        <span class="n">program</span> <span class="o">=</span> <span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Program&quot;</span><span class="p">]</span>
        <span class="n">filename</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">getFullFileName</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">mainTab</span><span class="o">.</span><span class="n">reader</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">program</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="n">filename</span> <span class="o">==</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">for</span> <span class="n">sp</span><span class="p">,</span><span class="n">rad</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">species</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Radii&quot;</span><span class="p">]):</span>
           <span class="bp">self</span><span class="o">.</span><span class="n">element_radii</span><span class="p">[</span><span class="n">sp</span><span class="p">]</span> <span class="o">=</span> <span class="n">rad</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">setOverrideCursor</span><span class="p">(</span><span class="n">Qt</span><span class="o">.</span><span class="n">WaitCursor</span><span class="p">)</span>
        <span class="c1"># Assemble the settingsTab settings</span>
        <span class="n">settings</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">settingsTab</span><span class="o">.</span><span class="n">settings</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">settingsTab</span><span class="o">.</span><span class="n">frequencies_cm1</span>
        <span class="n">mass_weighted_normal_modes</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">settingsTab</span><span class="o">.</span><span class="n">mass_weighted_normal_modes</span>
        <span class="n">scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Covalent radius scaling&quot;</span><span class="p">]</span>
        <span class="n">tolerance</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bonding tolerance&quot;</span><span class="p">]</span>
        <span class="c1"># Find the last unit cell read by the reader and its masses</span>
        <span class="n">cell</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span><span class="o">.</span><span class="n">get_unit_cell</span><span class="p">()</span>
        <span class="n">atom_masses</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">get_atomic_masses</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">cell_of_molecules</span><span class="p">,</span><span class="n">nmols</span><span class="p">,</span><span class="bp">self</span><span class="o">.</span><span class="n">original_atomic_order</span> <span class="o">=</span> <span class="n">cell</span><span class="o">.</span><span class="n">calculate_molecular_contents</span><span class="p">(</span><span class="n">scale</span><span class="o">=</span><span class="n">scale</span><span class="p">,</span> <span class="n">tolerance</span><span class="o">=</span><span class="n">tolerance</span><span class="p">,</span> <span class="n">radii</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">element_radii</span><span class="p">)</span>
        <span class="c1"># if the number of molecules has changed then tell the viewerTab that the cell has changed</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span> <span class="o">!=</span> <span class="n">nmols</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">viewerTab</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">notebook</span><span class="o">.</span><span class="n">viewerTab</span><span class="o">.</span><span class="n">requestRefresh</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span> <span class="o">=</span> <span class="n">nmols</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">molecules_le</span><span class="o">.</span><span class="n">setText</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="c1"># get the normal modes from the mass weighted ones</span>
        <span class="n">normal_modes</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">normal_modes</span><span class="p">(</span><span class="n">atom_masses</span><span class="p">,</span> <span class="n">mass_weighted_normal_modes</span><span class="p">)</span>
        <span class="c1"># Reorder the atoms so that the mass weighted normal modes order agrees with the ordering in the cell_of_molecules cell</span>
        <span class="n">nmodes</span><span class="p">,</span><span class="n">nions</span><span class="p">,</span><span class="n">temp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">shape</span><span class="p">(</span><span class="n">normal_modes</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_normal_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">nmodes</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">nions</span><span class="p">)</span> <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span> <span class="p">(</span><span class="n">nmodes</span><span class="p">,</span><span class="mi">3</span><span class="o">*</span><span class="n">nions</span><span class="p">)</span> <span class="p">)</span>
        <span class="n">masses</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">cell_of_molecules</span><span class="o">.</span><span class="n">atomic_masses</span>
        <span class="k">for</span> <span class="n">imode</span><span class="p">,</span><span class="n">mode</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mass_weighted_normal_modes</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">index</span><span class="p">,</span><span class="n">old_index</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">original_atomic_order</span><span class="p">):</span>
                <span class="n">i</span> <span class="o">=</span> <span class="n">index</span><span class="o">*</span><span class="mi">3</span>
                <span class="n">j</span> <span class="o">=</span> <span class="n">old_index</span><span class="o">*</span><span class="mi">3</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span><span class="p">[</span><span class="n">old_index</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span><span class="p">[</span><span class="n">old_index</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="n">mode</span><span class="p">[</span><span class="n">old_index</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">new_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">0</span><span class="p">]</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">masses</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">new_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">]</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">masses</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">new_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span><span class="p">[</span><span class="n">imode</span><span class="p">,</span><span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]</span> <span class="o">/</span> <span class="n">math</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">masses</span><span class="p">[</span><span class="n">index</span><span class="p">])</span>
        <span class="c1"># Calculate the distribution in energy for the normal modes</span>
        <span class="n">mode_energies</span> <span class="o">=</span> <span class="n">Calculator</span><span class="o">.</span><span class="n">calculate_energy_distribution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">cell_of_molecules</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">new_mass_weighted_normal_modes</span><span class="p">)</span>
        <span class="c1"># Deal with degeneracies</span>
        <span class="n">degenerate_list</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">fi</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">j</span><span class="p">,</span><span class="n">fj</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">):</span>
                <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">fi</span><span class="o">-</span><span class="n">fj</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mf">1.0E-5</span><span class="p">:</span>
                    <span class="n">degenerate_list</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">j</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mode_energies</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">)):</span>
            <span class="n">tote</span><span class="p">,</span><span class="n">cme</span><span class="p">,</span><span class="n">rote</span><span class="p">,</span><span class="n">vibe</span><span class="p">,</span><span class="n">mole</span> <span class="o">=</span> <span class="n">mode_energies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">tote</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tote</span><span class="p">,</span><span class="mf">1.0E-8</span><span class="p">)</span>
            <span class="n">sums</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="mi">5</span>
            <span class="n">sume</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">]</span><span class="o">*</span><span class="nb">len</span><span class="p">(</span><span class="n">mole</span><span class="p">)</span>
            <span class="n">degeneracy</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">degenerate_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">degenerate_list</span><span class="p">[</span><span class="n">i</span><span class="p">]:</span>
                <span class="n">tote</span><span class="p">,</span><span class="n">cme</span><span class="p">,</span><span class="n">rote</span><span class="p">,</span><span class="n">vibe</span><span class="p">,</span><span class="n">mole</span> <span class="o">=</span> <span class="n">mode_energies</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
                <span class="n">tote</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tote</span><span class="p">,</span><span class="mf">1.0E-8</span><span class="p">)</span>
                <span class="n">sums</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+=</span> <span class="n">tote</span> <span class="o">/</span> <span class="n">degeneracy</span>
                <span class="n">sums</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">cme</span> <span class="o">/</span> <span class="n">degeneracy</span>
                <span class="n">sums</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">+=</span> <span class="n">rote</span> <span class="o">/</span> <span class="n">degeneracy</span>
                <span class="n">sums</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span> <span class="o">+=</span> <span class="n">vibe</span> <span class="o">/</span> <span class="n">degeneracy</span>
                <span class="k">for</span> <span class="n">k</span><span class="p">,</span><span class="n">e</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mole</span><span class="p">):</span>
                    <span class="n">sume</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">+=</span> <span class="n">e</span> <span class="o">/</span> <span class="n">degeneracy</span>
                <span class="n">sums</span><span class="p">[</span><span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="n">sume</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mode_energies</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sums</span><span class="p">)</span>
        <span class="c1"># Store the results in the spread shee</span>
        <span class="c1"># if self.notebook.spreadsheet is not None:</span>
        <span class="c1">#     self.writeSpreadsheet()</span>
        <span class="c1"># Flag that a recalculation is not needed</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">refreshRequired</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">QApplication</span><span class="o">.</span><span class="n">restoreOverrideCursor</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.plot"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.plot">[docs]</a>    <span class="k">def</span> <span class="nf">plot</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the spectroscopic data based on the selected plot type.</span>

<span class="sd">        This method selects between two plotting strategies: &#39;internal_external&#39;</span>
<span class="sd">        or &#39;molecular&#39;, depending on the state of `plot_type_index`. If no data</span>
<span class="sd">        reader is associated with the instance or if there are no frequencies</span>
<span class="sd">        to plot, the function will terminate without plotting.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        This method relies on `self.reader` to be non-`None`, `self.frequencies_cm1` to</span>
<span class="sd">        contain frequency data, and `self.plot_type_index` to determine the plotting</span>
<span class="sd">        strategy. It calls `self.plot_internal_external()` or `self.plot_molecular()`</span>
<span class="sd">        based on the value of `self.plot_type_index`.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">reader</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">plot_type_index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_internal_external</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">plot_molecular</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.plot_molecular"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.plot_molecular">[docs]</a>    <span class="k">def</span> <span class="nf">plot_molecular</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the molecular composition of vibrational energy.</span>

<span class="sd">        This method visualizes the distribution of vibrational energy across different molecules</span>
<span class="sd">        within specified frequency limits. It creates a bar chart representing the percentage of </span>
<span class="sd">        energy attributed to each molecule per mode within the set frequency range.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>


<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - `self.settings` should contain &#39;Minimum frequency&#39;, &#39;Maximum frequency&#39;, and &#39;Bar width&#39; keys.</span>
<span class="sd">        - `self.mode_energies` must be a list where each element is a tuple containing mode energies</span>
<span class="sd">          (total energy, center of mass energy, rotational energy, vibrational energy, molecular energy).</span>
<span class="sd">        - `self.frequencies_cm1` should be a list of mode frequencies in cm^-1.</span>
<span class="sd">        - `self.number_of_molecules` indicates the number of different molecules considered in the analysis.</span>
<span class="sd">        - The method updates `self.subplot` with the new plot and requires `self.figure` and `self.canvas`</span>
<span class="sd">          for plotting and refreshing the plot display, respectively.</span>
<span class="sd">        - Utilizes `matplotlib.axes.Axes.bar` for plotting and `matplotlib.ticker.MaxNLocator` for setting</span>
<span class="sd">          tick locations on the x-axis.</span>
<span class="sd">        - Assumes matplotlib, specifically the `matplotlib.pyplot` and `matplotlib.ticker.MaxNLocator` classes,</span>
<span class="sd">          are appropriately imported or accessible within the scope.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Mode Number&quot;</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Percentage energy&quot;</span>
        <span class="c1"># Decide which modes to analyse</span>
        <span class="n">mode_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mode_list_text</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">]</span>
        <span class="n">tote</span><span class="p">,</span><span class="n">cme</span><span class="p">,</span><span class="n">rote</span><span class="p">,</span><span class="n">vibe</span><span class="p">,</span><span class="n">mole</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_energies</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">tote</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tote</span><span class="p">,</span><span class="mf">1.0E-8</span><span class="p">)</span>
        <span class="n">mol_energies</span> <span class="o">=</span> <span class="p">[</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span><span class="p">)</span> <span class="p">]</span>
        <span class="n">mol_bottoms</span>  <span class="o">=</span> <span class="p">[</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span><span class="p">)</span> <span class="p">]</span>
        <span class="k">for</span> <span class="n">imode</span><span class="p">,</span> <span class="n">frequency</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">frequency</span> <span class="o">&gt;=</span> <span class="n">vmin</span> <span class="ow">and</span> <span class="n">frequency</span> <span class="o">&lt;=</span> <span class="n">vmax</span><span class="p">:</span>
                <span class="n">mode_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imode</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">mode_list_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">imode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">tote</span><span class="p">,</span><span class="n">cme</span><span class="p">,</span><span class="n">rote</span><span class="p">,</span><span class="n">vibe</span><span class="p">,</span><span class="n">mole</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_energies</span><span class="p">[</span><span class="n">imode</span><span class="p">]</span>
                <span class="n">tote</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tote</span><span class="p">,</span><span class="mf">1.0E-8</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">mol</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">mole</span><span class="p">):</span>
                    <span class="n">mol_energies</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">100.0</span><span class="o">*</span><span class="n">mol</span><span class="o">/</span><span class="n">tote</span><span class="p">)</span>
                    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="n">mol_bottoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="mf">0.0</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">mol_bottoms</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">mol_bottoms</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">+</span><span class="n">mol_energies</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mode_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bar width&quot;</span><span class="p">]</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;m&quot;</span><span class="p">,</span><span class="s2">&quot;k&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">i</span><span class="p">,(</span><span class="n">energies</span><span class="p">,</span><span class="n">bottoms</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">mol_energies</span><span class="p">,</span> <span class="n">mol_bottoms</span> <span class="p">)):</span>
            <span class="n">plots</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mode_list</span><span class="p">,</span><span class="n">energies</span><span class="p">,</span><span class="n">width</span><span class="p">,</span> <span class="n">bottom</span><span class="o">=</span><span class="n">bottoms</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colours</span><span class="p">[</span><span class="n">i</span><span class="o">%</span><span class="mi">6</span><span class="p">]))</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">number_of_molecules</span><span class="p">):</span>
            <span class="n">legends</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;Molecule &quot;</span><span class="o">+</span><span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">plots</span><span class="p">,</span> <span class="n">legends</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Molecular Composition of Vibrational Energy&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span></div>

<div class="viewcode-block" id="AnalysisTab.plot_internal_external"><a class="viewcode-back" href="../../../autoapi/PDielec/GUI/AnalysisTab/index.html#PDielec.GUI.AnalysisTab.AnalysisTab.plot_internal_external">[docs]</a>    <span class="k">def</span> <span class="nf">plot_internal_external</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Plot the internal and external composition of vibrational energy for modes within specified frequency ranges.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        None</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        None</span>

<span class="sd">        Notes</span>
<span class="sd">        -----</span>
<span class="sd">        - This method modifies the subplot attribute by adding the bar plots for the internal and external energy contributions of different vibrational modes within the specified frequency ranges.</span>
<span class="sd">        - This method utilizes the &#39;Minimum frequency&#39; and &#39;Maximum frequency&#39; values from the settings attribute to filter modes for plotting.</span>
<span class="sd">        - The method sets the X-axis labels to mode numbers and the Y-axis label to percentage energy.</span>
<span class="sd">        - If the number of modes within the specified frequency range is less than 3, the method returns early without performing any plotting.</span>
<span class="sd">        - The method updates the canvas with the newly plotted data.</span>

<span class="sd">        &quot;&quot;&quot;</span>        
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">clf</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">figure</span><span class="o">.</span><span class="n">add_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">MaxNLocator</span><span class="p">(</span><span class="n">integer</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
        <span class="n">xlabel</span> <span class="o">=</span> <span class="s2">&quot;Mode Number&quot;</span>
        <span class="n">ylabel</span> <span class="o">=</span> <span class="s2">&quot;Percentage energy&quot;</span>
        <span class="c1"># Decide which modes to analyse</span>
        <span class="n">mode_list</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mode_list_text</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">cme_energy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">rot_energy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vib_energy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vib_bottom</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">mol_energy</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">vmin</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Minimum frequency&quot;</span><span class="p">]</span>
        <span class="n">vmax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Maximum frequency&quot;</span><span class="p">]</span>
        <span class="n">colours</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;y&quot;</span><span class="p">,</span><span class="s2">&quot;b&quot;</span><span class="p">,</span><span class="s2">&quot;r&quot;</span><span class="p">,</span><span class="s2">&quot;c&quot;</span><span class="p">,</span><span class="s2">&quot;m&quot;</span><span class="p">,</span><span class="s2">&quot;k&quot;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">imode</span><span class="p">,</span> <span class="n">frequency</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">frequencies_cm1</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">frequency</span> <span class="o">&gt;=</span> <span class="n">vmin</span> <span class="ow">and</span> <span class="n">frequency</span> <span class="o">&lt;=</span> <span class="n">vmax</span><span class="p">:</span>
                <span class="n">mode_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">imode</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">mode_list_text</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">imode</span><span class="o">+</span><span class="mi">1</span><span class="p">))</span>
                <span class="n">tote</span><span class="p">,</span><span class="n">cme</span><span class="p">,</span><span class="n">rote</span><span class="p">,</span><span class="n">vibe</span><span class="p">,</span><span class="n">molecular_energies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mode_energies</span><span class="p">[</span><span class="n">imode</span><span class="p">]</span>
                <span class="n">molecular_energies</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">molecular_energies</span><span class="p">)</span>
                <span class="n">tote</span> <span class="o">=</span> <span class="nb">max</span><span class="p">(</span><span class="n">tote</span><span class="p">,</span><span class="mf">1.0E-8</span><span class="p">)</span>
                <span class="n">cme_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">cme</span><span class="o">/</span><span class="n">tote</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span>
                <span class="n">rot_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rote</span><span class="o">/</span><span class="n">tote</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span>
                <span class="n">vib_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">vibe</span><span class="o">/</span><span class="n">tote</span><span class="o">*</span><span class="mf">100.0</span><span class="p">)</span>
                <span class="n">vib_bottom</span><span class="o">.</span><span class="n">append</span><span class="p">(</span> <span class="p">(</span><span class="n">cme</span><span class="o">+</span><span class="n">rote</span><span class="p">)</span><span class="o">/</span><span class="n">tote</span><span class="o">*</span><span class="mf">100.0</span> <span class="p">)</span>
                <span class="n">mol_energy</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">molecular_energies</span><span class="o">/</span><span class="n">tote</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">mode_list</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">3</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">width</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">settings</span><span class="p">[</span><span class="s2">&quot;Bar width&quot;</span><span class="p">]</span>
        <span class="n">p1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mode_list</span><span class="p">,</span><span class="n">cme_energy</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colours</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">p2</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mode_list</span><span class="p">,</span><span class="n">rot_energy</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">cme_energy</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colours</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">p3</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">mode_list</span><span class="p">,</span><span class="n">vib_energy</span><span class="p">,</span><span class="n">width</span><span class="p">,</span><span class="n">bottom</span><span class="o">=</span><span class="n">vib_bottom</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colours</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
        <span class="n">plots</span> <span class="o">=</span> <span class="p">(</span> <span class="n">p1</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p2</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">p3</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="p">)</span>
        <span class="n">legends</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;translation&quot;</span><span class="p">,</span><span class="s2">&quot;rotation&quot;</span><span class="p">,</span><span class="s2">&quot;vibration&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="n">xlabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">ylabel</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span> <span class="n">plots</span><span class="p">,</span> <span class="n">legends</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">subplot</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Internal-External Composition of Vibrational Energy&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">canvas</span><span class="o">.</span><span class="n">draw_idle</span><span class="p">()</span></div></div>

</pre></div>
        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, John Kendrick and Andrew Burnett
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer no-toc">
      
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=01b4f342"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/scripts/furo.js?v=32e29ea5"></script>
    </body>
</html>