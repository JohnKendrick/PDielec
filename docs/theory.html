
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />
<meta content="PDielec package for the calculation of infrared and terahertz absorption from QM calculations" name="description" />
<meta content="Quantum Mechanics, Effective Field Theory, Maxwell, Garnett, Mie, Infrared, Terahertz, Castep, Abinit, VASP, GULP. QE" name="keywords" />

    <title>Theory &#8212; PDielec: John Kendrick &amp; Andrew Burnett</title><meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/pydoctheme.css?2021.11.1" />
    <link rel="stylesheet" type="text/css" href="_static/table_styling.css" />
    
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["AMSmath.js"], "TeX": {"Macros": {"bm": ["{\\boldsymbol{#1}}", 1], "tensor": ["{\\bar{\\bar{#1}}}", 1], "tensorbs": ["{\\bar{\\bar{\\bm{#1}}}}", 1], "tensorbf": ["{\\bar{\\bar{\\bm{#1}}}}", 1], "fieldbf": ["{\\bar{\\bm{#1}}}", 1], "water": "\\H_{2}O"}}})</script>
    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Phonon Analysis" href="analysis.html" />
    <link rel="prev" title="Software components" href="software.html" /><link rel="shortcut icon" type="image/png" href="_static/py.svg" />
            <script type="text/javascript" src="_static/copybutton.js"></script>
            <script type="text/javascript" src="_static/menu.js"></script> 
  </head>
<body>
<div class="mobile-nav">
    <input type="checkbox" id="menuToggler" class="toggler__input" aria-controls="navigation"
           aria-pressed="false" aria-expanded="false" role="button" aria-label="Menu" />
    <label for="menuToggler" class="toggler__label">
        <span></span>
    </label>
    <nav class="nav-content" role="navigation">
         <a href="https://www.python.org/" class="nav-logo">
             <img src="_static/py.svg" alt="Logo"/>
         </a>
        <div class="version_switcher_placeholder"></div>
        <form role="search" class="search" action="search.html" method="get">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" class="search-icon">
                <path fill-rule="nonzero"
                        d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 001.48-5.34c-.47-2.78-2.79-5-5.59-5.34a6.505 6.505 0 00-7.27 7.27c.34 2.8 2.56 5.12 5.34 5.59a6.5 6.5 0 005.34-1.48l.27.28v.79l4.25 4.25c.41.41 1.08.41 1.49 0 .41-.41.41-1.08 0-1.49L15.5 14zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z" fill="#444"></path>
            </svg>
            <input type="text" name="q" aria-label="Quick search"/>
            <input type="submit" value="Go"/>
        </form>
    </nav>
    <div class="menu-wrapper">
        <nav class="menu" role="navigation" aria-label="main navigation">
            <div class="language_switcher_placeholder"></div>
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Theory</a><ul>
<li><a class="reference internal" href="#molecular-approach-to-absorption-intensity">Molecular approach to absorption intensity</a></li>
<li><a class="reference internal" href="#solid-state-approach-to-absorption-intensity">Solid state approach to absorption intensity</a></li>
<li><a class="reference internal" href="#effect-of-particle-shape-on-infrared-absorption">Effect of particle shape on infrared absorption</a><ul>
<li><a class="reference internal" href="#the-polarisability-of-an-isolated-particle">The polarisability of an isolated particle</a></li>
<li><a class="reference internal" href="#the-effective-permittivity-of-a-mixture">The effective permittivity of a mixture</a></li>
<li><a class="reference internal" href="#mixing-rules">Mixing rules</a></li>
<li><a class="reference internal" href="#maxwell-garnett-mixing-rule">Maxwell-Garnett mixing rule</a></li>
<li><a class="reference internal" href="#bruggeman-mixing-rule">Bruggeman mixing rule</a></li>
<li><a class="reference internal" href="#averaged-permittivity-mixing-rule">Averaged-Permittivity mixing rule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#particle-size-effects">Particle size effects</a></li>
<li><a class="reference internal" href="#light-scattering-by-spherical-particles-using-mie-theory">Light scattering by spherical particles using Mie theory</a></li>
<li><a class="reference internal" href="#calculation-of-atr-extinction-spectra">Calculation of ATR Extinction Spectra</a></li>
<li><a class="reference internal" href="#scattering-effects-due-to-air-inclusions">Scattering Effects due to Air Inclusions</a></li>
<li><a class="reference internal" href="#removing-baseline-artifacts-from-experiment">Removing Baseline Artifacts from Experiment</a></li>
<li><a class="reference internal" href="#calculation-of-single-crystal-optics">Calculation of Single Crystal Optics</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="software.html"
                        title="previous chapter">Software components</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="analysis.html"
                        title="next chapter">Phonon Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/theory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </nav>
    </div>
</div>
  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="analysis.html" title="Phonon Analysis"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="software.html" title="Software components"
             accesskey="P">previous</a> |</li>
          <li><img src="_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="index.html">PDielec: John Kendrick & Andrew Burnett</a> &#187;
              
          </li>
        <li class="nav-item nav-item-this"><a href="">Theory</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>    

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#theory" id="id55">Theory</a></p>
<ul>
<li><p><a class="reference internal" href="#molecular-approach-to-absorption-intensity" id="id56">Molecular approach to absorption intensity</a></p></li>
<li><p><a class="reference internal" href="#solid-state-approach-to-absorption-intensity" id="id57">Solid state approach to absorption intensity</a></p></li>
<li><p><a class="reference internal" href="#effect-of-particle-shape-on-infrared-absorption" id="id58">Effect of particle shape on infrared absorption</a></p>
<ul>
<li><p><a class="reference internal" href="#the-polarisability-of-an-isolated-particle" id="id59">The polarisability of an isolated particle</a></p></li>
<li><p><a class="reference internal" href="#the-effective-permittivity-of-a-mixture" id="id60">The effective permittivity of a mixture</a></p></li>
<li><p><a class="reference internal" href="#mixing-rules" id="id61">Mixing rules</a></p></li>
<li><p><a class="reference internal" href="#maxwell-garnett-mixing-rule" id="id62">Maxwell-Garnett mixing rule</a></p></li>
<li><p><a class="reference internal" href="#bruggeman-mixing-rule" id="id63">Bruggeman mixing rule</a></p></li>
<li><p><a class="reference internal" href="#averaged-permittivity-mixing-rule" id="id64">Averaged-Permittivity mixing rule</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#particle-size-effects" id="id65">Particle size effects</a></p></li>
<li><p><a class="reference internal" href="#light-scattering-by-spherical-particles-using-mie-theory" id="id66">Light scattering by spherical particles using Mie theory</a></p></li>
<li><p><a class="reference internal" href="#calculation-of-atr-extinction-spectra" id="id67">Calculation of ATR Extinction Spectra</a></p></li>
<li><p><a class="reference internal" href="#scattering-effects-due-to-air-inclusions" id="id68">Scattering Effects due to Air Inclusions</a></p></li>
<li><p><a class="reference internal" href="#removing-baseline-artifacts-from-experiment" id="id69">Removing Baseline Artifacts from Experiment</a></p></li>
<li><p><a class="reference internal" href="#calculation-of-single-crystal-optics" id="id70">Calculation of Single Crystal Optics</a></p></li>
</ul>
</li>
</ul>
</div>
<section id="theory">
<h1><a class="toc-backref" href="#id55">Theory</a><a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<p>The theory underlying the Python package PDielec is described.  PDielec calculates the infrared absorption characteristics of a crystalline material supported in a non-absorbing medium.  PDielec post processes solid state quantum mechanical and molecular mechanical calculations of the phonons and dielectric response of the crystalline material. The molecular and solid state quantum mechanical (QM) calculations of response properties such as the frequencies and intensities of infrared (IR) and terahertz (THz) radiation absorption has become generally available in many molecular and solid state computer programs. A common approach is to assume the harmonic approximation and calculate the mass weighted force constant matrix (for molecules) or the dynamical matrix at the gamma point (for periodic solids). Diagonalisation of the matrix gives the frequencies for absorption and the normal modes (molecules) or phonon displacements (periodic solids). The calculation of the absorption intensity for each mode requires the calculation of the change in dipole moment caused by the displacement of the atoms for that mode. For solids where there is a large separation of charge, there can be a large coupling between a phonon mode and the internal field within a particle resulting from its morphology.</p>
<p>PDielec post processes the output of solid state quantum mechanical and molecular mechanics (MM) based codes such as VASP <span id="id1">[<a class="reference internal" href="zreferences.html#id56">1</a>]</span>, CASTEP <span id="id2">[<a class="reference internal" href="zreferences.html#id62">2</a>]</span>, CRYSTAL <span id="id3">[<a class="reference internal" href="zreferences.html#id15">3</a>]</span>, Abinit <span id="id4">[<a class="reference internal" href="zreferences.html#id14">4</a>]</span>, Quantum Espresso <span id="id5">[<a class="reference internal" href="zreferences.html#id13">5</a>]</span>, Phonopy <span id="id6">[<a class="reference internal" href="zreferences.html#id12">6</a>]</span>, and GULP <span id="id7">[<a class="reference internal" href="zreferences.html#id11">7</a>]</span> to predict the infrared absorption of crystalline insulator materials whose crystal size is small compared with the wavelength of the absorbing radiation. The package is suited for the calculation of the complex, frequency dependent permittivity and its associated absorption of infrared radiation for a finely ground crystalline material dispersed in a low loss dielectric medium such KBr or Polytetrafluoroethylene (PTFE). A particular feature of the program is its ability to take into account the constant permittivity of the supporting medium and the particle shape of the material of interest through an effective medium theory. The paper outlines the theory used by the program and gives some examples of the application of the program for ionic and molecular materials.</p>
<p>Equations <a class="reference internal" href="#equation-eq-beer1">(3)</a> and <a class="reference internal" href="#equation-eq-beer2">(4)</a> describe Beer-Lambert’s law <span id="id8">[<a class="reference internal" href="zreferences.html#id55">14</a>]</span> where <span class="math notranslate nohighlight">\(\alpha\)</span> is the (decadic) absorption coefficient (usually given in cm<sup>-1</sup>), <span class="math notranslate nohighlight">\(I\)</span> and <span class="math notranslate nohighlight">\(I_0\)</span> are the intensities after and before absorption respectively and <span class="math notranslate nohighlight">\(d\)</span> is the path length.</p>
<div class="math notranslate nohighlight" id="equation-eq-beer1">
<span class="eqno">(3)<a class="headerlink" href="#equation-eq-beer1" title="Permalink to this equation">¶</a></span>\[\frac{I}{I_{0}} = 10^{- \alpha d}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-beer2">
<span class="eqno">(4)<a class="headerlink" href="#equation-eq-beer2" title="Permalink to this equation">¶</a></span>\[log\left( \frac{I}{I_{0}} \right) = -\alpha d\]</div>
<p>It is common, especially in the chemistry community, when reporting infrared spectra to use a decadic molar absorption coefficient (<span class="math notranslate nohighlight">\(a\)</span>), which has units of L·mol<sup>-1</sup>·cm<sup>-1</sup>. The relationship between the absorption coefficient and the molar absorption coefficient <span id="id9">[<a class="reference internal" href="zreferences.html#id55">14</a>]</span> is;</p>
<div class="math notranslate nohighlight" id="equation-eq-ac">
<span class="eqno">(5)<a class="headerlink" href="#equation-eq-ac" title="Permalink to this equation">¶</a></span>\[\alpha = aC\]</div>
<p>where <span class="math notranslate nohighlight">\(C\)</span> is the concentration of the absorbing species.</p>
<section id="molecular-approach-to-absorption-intensity">
<h2><a class="toc-backref" href="#id56">Molecular approach to absorption intensity</a><a class="headerlink" href="#molecular-approach-to-absorption-intensity" title="Permalink to this headline">¶</a></h2>
<p>For molecules the transition intensity <span class="math notranslate nohighlight">\(I_k\)</span> of the <span class="math notranslate nohighlight">\(k^{th}\)</span> vibrational mode (calculated from the change in dipole moment along the mode displacement) can be converted to an integrated molar absorption coefficient, <span class="math notranslate nohighlight">\(A_k\)</span>, which can then be more readily compared with experiment. The theory for this is described by Wilson, Decius and Cross <span id="id10">[<a class="reference internal" href="zreferences.html#id43">15</a>]</span> and results in expressions such as those given in equations <a class="reference internal" href="#equation-eq-absorption1">(6)</a> and <a class="reference internal" href="#equation-eq-absorption2">(7)</a>.  The first expression shows the relationship between the integrated molar absorption coefficient and the transition intensity and uses the number of molecules per unit volume (<span class="math notranslate nohighlight">\(N\)</span>), the velocity of light (<span class="math notranslate nohighlight">\(c\)</span>) and the degeneracy of the mode (<span class="math notranslate nohighlight">\(g_k\)</span>). The second expression shows the appropriate conversion factors if the units for the integrated molar absorption coefficient are L·mol<sup>-1</sup>·cm<sup>-2</sup> (1 L·mol<sup>-1</sup>·cm<sup>-2</sup> = 0.01 km·mol<sup>-1</sup>) and the units for the transition intensity are D<sup>2</sup>Å<sup>-2</sup>amu<sup>-1</sup>, where D represents the Debye unit of dipole  moment and amu is an atomic mass unit. The factor <span class="math notranslate nohighlight">\(log_e10\)</span> arises due to the choice of a decadic Beer’s law.</p>
<div class="math notranslate nohighlight" id="equation-eq-absorption1">
<span class="eqno">(6)<a class="headerlink" href="#equation-eq-absorption1" title="Permalink to this equation">¶</a></span>\[ A_k =  \frac{N\pi}{3c^{2}\log_e10}g_kI_k\]</div>
<div class="math notranslate nohighlight" id="equation-eq-absorption2">
<span class="eqno">(7)<a class="headerlink" href="#equation-eq-absorption2" title="Permalink to this equation">¶</a></span>\[A_k =  \frac{Na\pi}{3000c^{2}2.302585}g_kI_k  = 4225.6I_k\]</div>
<p>The derivation of the above expressions assumes that the rotational levels are not quantised and that the vibrational levels are thermally occupied according to a Boltzmann distribution. In order to use the calculated molecular intensities to predict a spectrum it is usual to assume <span id="id11">[<a class="reference internal" href="zreferences.html#id43">15</a>]</span> that each transition is associated with a Lorentzian line shape with a full width at half maximum (FWHM) of <span class="math notranslate nohighlight">\(\sigma_k\)</span>. It is common, when reporting comparison between theoretical and experimental spectra, to assume that the line widths are the same for all modes <span id="id12">[<a class="reference internal" href="zreferences.html#id58">16</a>, <a class="reference internal" href="zreferences.html#id53">17</a>]</span>.  Recent work on terahertz absorption in crystalline pentaerythritol tetranitrate (PETN) using molecular dynamics calculations <span id="id13">[<a class="reference internal" href="zreferences.html#id32">18</a>]</span> in combination with the direct calculation of the cubic anharmonic couplings of the normal modes <span id="id14">[<a class="reference internal" href="zreferences.html#id32">18</a>]</span> has shown that the FWHM of the intense absorptions may vary between 10 and 25 cm<sup>-1</sup>. Assuming a Lorentzian line shape, the molar absorption coefficient for the <span class="math notranslate nohighlight">\(k^{th}\)</span> mode at wavenumber, <span class="math notranslate nohighlight">\({\bar{\nu}}_{k}\)</span>, can be written as a function of frequency or wavenumber (<span class="math notranslate nohighlight">\(\bar{\nu}\)</span>);</p>
<div class="math notranslate nohighlight" id="equation-eq-lorentzian">
<span class="eqno">(8)<a class="headerlink" href="#equation-eq-lorentzian" title="Permalink to this equation">¶</a></span>\[a_k(\bar{\nu}) = \frac{2A_k}{\pi}\frac{\sigma_k}{4\left( \bar{\nu} - {\bar{\nu}}_k \right)^{2} + \sigma_k^2}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-akmax">
<span class="eqno">(9)<a class="headerlink" href="#equation-eq-akmax" title="Permalink to this equation">¶</a></span>\[a_k^{max} = \frac{2A_k}{\pi\sigma_k}\]</div>
<p>The maximum height of the Lorentzian, <span class="math notranslate nohighlight">\(a_{k}^{\max}\)</span> clearly depends upon the value of <span class="math notranslate nohighlight">\(\sigma_k\)</span>. As can be seen in Equation <a class="reference internal" href="#equation-eq-integratedmolarintensity">(10)</a>, the choice of normalisation for the Lorentzian means that integration of the molar absorption coefficient over wavenumber returns the integrated molar absorption coefficient and a sum over all the bands provides the total molar absorption coefficient <span class="math notranslate nohighlight">\(a^{mol}(\bar{\nu})\)</span> as a function of wavenumber, calculated from the intensities of each band.  Equation <a class="reference internal" href="#equation-eq-molarabsorption">(12)</a> shows the relationship between the absorption and the molar absorption coefficients. <span class="math notranslate nohighlight">\(C\)</span> is the concentration usually expressed in mol·L<sup>-1</sup>.</p>
<div class="math notranslate nohighlight" id="equation-eq-integratedmolarintensity">
<span class="eqno">(10)<a class="headerlink" href="#equation-eq-integratedmolarintensity" title="Permalink to this equation">¶</a></span>\[A_k = \int{a_k(\bar{\nu})d\bar{\nu}}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-amol">
<span class="eqno">(11)<a class="headerlink" href="#equation-eq-amol" title="Permalink to this equation">¶</a></span>\[a^{mol}(\bar{\nu}) = \sum_k{a_k(\bar{\nu})}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-molarabsorption">
<span class="eqno">(12)<a class="headerlink" href="#equation-eq-molarabsorption" title="Permalink to this equation">¶</a></span>\[\alpha^{\text{mol}}(\bar{\nu}) = Ca^{\text{mol}}(\bar{\nu})\]</div>
<p>A comment should be made about the various units which can be used for these quantities. A common unit for the transition intensity is D<sup>2</sup>Å<sup>-2</sup>amu<sup>-1</sup>, another is km·mol<sup>-1</sup>. However, it should be pointed out that strictly speaking the latter unit refers to the integrated molar absorption coefficient as defined above in Equation <a class="reference internal" href="#equation-eq-integratedmolarintensity">(10)</a> and therefore relies on the assumptions made in its derivation. ( 1 D<sup>2</sup>Å<sup>-2</sup>amu<sup>-1</sup> is equivalent to 42.256 km·mol<sup>-1</sup> ).</p>
</section>
<section id="solid-state-approach-to-absorption-intensity">
<h2><a class="toc-backref" href="#id57">Solid state approach to absorption intensity</a><a class="headerlink" href="#solid-state-approach-to-absorption-intensity" title="Permalink to this headline">¶</a></h2>
<p>The optical properties of a solid are determined by its complex, frequency dependent relative permittivity,
<span class="math notranslate nohighlight">\(\boldsymbol{\varepsilon}(\bar{\nu})\)</span>, and in particular the real and imaginary components, <span class="math notranslate nohighlight">\(\boldsymbol{\kappa}\)</span> and <span class="math notranslate nohighlight">\(\mathbf{n}\)</span>, of the complex refractive index, <span class="math notranslate nohighlight">\(\tensorbf{N}{(\bar{\nu})}\)</span> where;</p>
<div class="math notranslate nohighlight" id="equation-eq-refractiveindex1">
<span class="eqno">(13)<a class="headerlink" href="#equation-eq-refractiveindex1" title="Permalink to this equation">¶</a></span>\[\tensorbf{N}({\bar{\nu}})^{2} = {\tensorbs{\varepsilon}}({\bar{\nu}})\]</div>
<div class="math notranslate nohighlight" id="equation-eq-refractiveindex2">
<span class="eqno">(14)<a class="headerlink" href="#equation-eq-refractiveindex2" title="Permalink to this equation">¶</a></span>\[\tensorbf{N}\left( \bar{\nu} \right) = {\tensorbf{n}}\left( \bar{\nu} \right) + i{\tensorbs{\kappa}}\left( \bar{\nu} \right)\]</div>
<p>The intensity of absorption is given by the imaginary component of the refractive index which for an isotropic material is <span id="id15">[<a class="reference internal" href="zreferences.html#id42">19</a>]</span>;</p>
<div class="math notranslate nohighlight" id="equation-eq-beerintensity">
<span class="eqno">(15)<a class="headerlink" href="#equation-eq-beerintensity" title="Permalink to this equation">¶</a></span>\[\begin{split}I = I_{0}e^{- \frac{4\pi\kappa(\bar{\nu})d}{\lambda}} \\
I = I_{0}e^{- 4\pi\bar{\nu}\kappa(\bar{\nu})d}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-logintensity">
<span class="eqno">(16)<a class="headerlink" href="#equation-eq-logintensity" title="Permalink to this equation">¶</a></span>\[\begin{split}- ln\left( \frac{I}{I_{0}} \right) = 4\pi\bar{\nu}\kappa(\bar{\nu})d \\
- log\left( \frac{I}{I_{0}} \right) = 4\pi\bar{\nu}\kappa(\bar{\nu})d \cdot log(e)\end{split}\]</div>
<p>Comparison with the definition of the absorption coefficient from Beer-Lambert’s law, Equation <a class="reference internal" href="#equation-eq-beer1">(3)</a>, and using Equation <a class="reference internal" href="#equation-eq-molarabsorption">(12)</a> gives;</p>
<div class="math notranslate nohighlight" id="equation-eq-alphasol">
<span class="eqno">(17)<a class="headerlink" href="#equation-eq-alphasol" title="Permalink to this equation">¶</a></span>\[\alpha^{sol}(\bar{\nu}) = 4\pi\bar{\nu}\kappa(\bar{\nu}) log(e)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-asol">
<span class="eqno">(18)<a class="headerlink" href="#equation-eq-asol" title="Permalink to this equation">¶</a></span>\[a^{sol}(\bar{\nu}) = \frac{\alpha^{\text{sol}}(\bar{\nu})}{C}\]</div>
<p>Since the refractive index is dimensionless, the absorption coefficient, <span class="math notranslate nohighlight">\(\alpha^\text{sol}\)</span> is specified in cm<sup>-1</sup>. The superscripts ‘sol,’ for solid, and ‘mol,’ for molecular, are used here to distinguish between the two methods of calculating the absorption (<span class="math notranslate nohighlight">\(\alpha\)</span>) and molar absorption coefficients (<span class="math notranslate nohighlight">\(a\)</span>).  In the calculation of the imaginary component of the refractive index it is necessary to choose the solution which gives a positive value. This is consistent with the Kramers-Kronig relationship between the real and imaginary components <span id="id16">[<a class="reference internal" href="zreferences.html#id37">20</a>]</span>.</p>
<p>In order to calculate the relationship between absorption and molar absorption coefficients it is necessary to know the concentration. For solid state calculations the required unit is; moles of unit cells per litre. One of the drawbacks of this molar absorption coefficient unit is that the number of molecules in a unit cell can change depending on whether a supercell, primitive or non primitive unit cell is being used. A more natural unit would be to use a mole of formula units, or a mole of molecules. In order to aid comparison between such calculations PDielec is able to calculate concentration in both moles of atoms and moles of molecules. However for the rest of this paper Equation <a class="reference internal" href="#equation-eq-concentration">(19)</a> will be used, where <span class="math notranslate nohighlight">\(V\)</span> is the volume of the unit cell, and therefore the concentration <span class="math notranslate nohighlight">\(C\)</span> is moles of unit cell/litre.</p>
<div class="math notranslate nohighlight" id="equation-eq-concentration">
<span class="eqno">(19)<a class="headerlink" href="#equation-eq-concentration" title="Permalink to this equation">¶</a></span>\[C = \frac{f \cdot 1000cm^{3}}{VN_{a}}\]</div>
<p>The volume fraction, <span class="math notranslate nohighlight">\(f\)</span>, of the dielectric material in a supporting matrix of non-absorbing material is included in the expression for the concentration as it will be useful when the theory for mixtures is developed.</p>
<p>For a periodic system the permittivity tensor can be calculated as a sum over Lorentz oscillators, incorporating an imaginary loss component through the damping factor <span class="math notranslate nohighlight">\(\sigma_k\)</span> <span id="id17">[<a class="reference internal" href="zreferences.html#id59">21</a>]</span>.  The frequencies of the oscillators are the transverse optic (TO) phonon frequencies of the system.</p>
<div class="math notranslate nohighlight" id="equation-eq-permittivity">
<span class="eqno">(20)<a class="headerlink" href="#equation-eq-permittivity" title="Permalink to this equation">¶</a></span>\[{\tensorbs{\varepsilon}}(v) = {{\tensorbs{\varepsilon}}}_{\infty} + \frac{4\pi}{V}\sum_{k}\frac{{{\tensorbf{S}}}_{k}}{\nu_{k}^{2} - \nu^{2} - i\sigma_{k}\nu}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-oscillatorstrength">
<span class="eqno">(21)<a class="headerlink" href="#equation-eq-oscillatorstrength" title="Permalink to this equation">¶</a></span>\[\tensorbf{S}_{k} = {\bar{\mathbf{Z}}}_{k}{\bar{\mathbf{Z}}}_{k}^\text{T}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-borncharges">
<span class="eqno">(22)<a class="headerlink" href="#equation-eq-borncharges" title="Permalink to this equation">¶</a></span>\[\bar{\mathbf{Z}}_{k} =  \sum_{a}{\tensorbf{Z^{a}}}{\bar{\mathbf{U^{a}}}}_{k}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-eigenvalues">
<span class="eqno">(23)<a class="headerlink" href="#equation-eq-eigenvalues" title="Permalink to this equation">¶</a></span>\[\begin{split}\tensorbf{D} {\bar{\mathbf{U}}}_{k} = \Lambda_{k}{\bar{\mathbf{U}}}_{k}\\
\nu_{k}^{2} = \Lambda_{k}\end{split}\]</div>
<div class="math notranslate nohighlight" id="equation-eq-intensity">
<span class="eqno">(24)<a class="headerlink" href="#equation-eq-intensity" title="Permalink to this equation">¶</a></span>\[I_{k} = tr\left( \tensorbf{S}_{k} \right)\]</div>
<p><span class="math notranslate nohighlight">\(V\)</span> is the volume of the unit cell, <span class="math notranslate nohighlight">\({\tensorbf{S}}_{k}\)</span> is the dipole oscillator strength tensor for the <span class="math notranslate nohighlight">\(k_{th}\)</span>  transition, with a TO frequency of <span class="math notranslate nohighlight">\(\nu_k\)</span> and <span class="math notranslate nohighlight">\(\tensor{\varepsilon}_{\infty}\)</span> the optical permittivity tensor, which represents the electronic contribution to the permittivity. The intensity of a transition, <span class="math notranslate nohighlight">\(I_k\)</span>, is given by the trace of the oscillator strength tensor, Equation <a class="reference internal" href="#equation-eq-intensity">(24)</a>.  The damping factor <span class="math notranslate nohighlight">\(\sigma_{k}\)</span> removes any discontinuities at the TO frequencies. Since the oscillator strengths and phonon frequencies can be calculated routinely in solid state quantum mechanical packages, the calculation of the frequency dependent complex permittivity using Equation <a class="reference internal" href="#equation-eq-permittivity">(20)</a> is straightforward.</p>
<p>In some cases, using Equations <a class="reference internal" href="#equation-eq-oscillatorstrength">(21)</a> and <a class="reference internal" href="#equation-eq-borncharges">(22)</a>, PDielec calculates the oscillator strengths from the Born charge matrix for atom <span class="math notranslate nohighlight">\(a\)</span> and its contributions to the <span class="math notranslate nohighlight">\(k_{th}\)</span> phonon mode <span id="id18">[<a class="reference internal" href="zreferences.html#id59">21</a>]</span>.  As shown in Equation <a class="reference internal" href="#equation-eq-eigenvalues">(23)</a>, at the <span class="math notranslate nohighlight">\(\Gamma\)</span> point the <span class="math notranslate nohighlight">\(k_{th}\)</span> phonon mode is described by the eigenvector, <span class="math notranslate nohighlight">\(\bar{\mathbf{U}}_{k},\)</span> and eigenvalue, <span class="math notranslate nohighlight">\(\Lambda_{k}\)</span>, of the mass weighted, dynamical matrix, <span class="math notranslate nohighlight">\(\tensorbf{D}\)</span>, which is a 3Nx3N matrix, where N is the number of atoms in the unit cell. The eigenvalues are the squared frequencies of the phonon modes, Equation <a class="reference internal" href="#equation-eq-eigenvalues">(23)</a>.  The displacement of each atom in the <span class="math notranslate nohighlight">\(k_{th}\)</span> is proportional to <span class="math notranslate nohighlight">\(m_{a}^{-1/2}\)</span>, where <span class="math notranslate nohighlight">\(m_a\)</span> is the mass of atom <span class="math notranslate nohighlight">\(a\)</span>. The dynamical matrix has 3N eigenvectors and eigenvalues, of which three should be zero due to translational invariance. If there are any negative eigenvalues the system is unstable to some displacement and therefore not at an energy minimum.</p>
<p>For ionic systems it is common practice in solid state QM and MM programs to include a long wave-length, non-analytic correction to the mass weighted dynamical matrix at the <span class="math notranslate nohighlight">\(\Gamma\)</span> point, which describes the coupling of the longitudinal optic (LO) modes to the induced field resulting from the vibration. This may be written for atoms <span class="math notranslate nohighlight">\(s\)</span> and <span class="math notranslate nohighlight">\(t\)</span> and their Cartesian components <span class="math notranslate nohighlight">\(\alpha\)</span> and <span class="math notranslate nohighlight">\(\beta\)</span> as <span id="id19">[<a class="reference internal" href="zreferences.html#id59">21</a>]</span>;</p>
<div class="math notranslate nohighlight" id="equation-eq-lodynamicalmatrix">
<span class="eqno">(25)<a class="headerlink" href="#equation-eq-lodynamicalmatrix" title="Permalink to this equation">¶</a></span>\[\left( \tensorbf{D}^\text{LO}_{\mathbf{q \rightarrow 0}} \right)_{s,\alpha;t,\beta} = \left( \tensorbf{D} \right)_{s,\alpha;t,\beta}\mathbf{+}\frac{4\pi}{V\sqrt{M_{s}M_{t}}}\mathbf{\ }\frac{\left( {\bar{\mathbf{q}}}^{\text{T}}{{\mathbf{\ }\tensorbf{Z}}}_{s} \right)_{\alpha}\left( {\bar{\mathbf{q}}}^{\text{T}}{\tensorbf{Z}}_t \right)_\beta}{{\bar{\mathbf{q}}}^{\text{T}}\mathbf{\cdot}{{\tensorbs{\varepsilon}}}_{\infty} \cdot \bar{\mathbf{q}}}\]</div>
<p>The mass weighting has been incorporated through the mass of the atoms, <span class="math notranslate nohighlight">\(M_s\)</span> and <span class="math notranslate nohighlight">\(M_t\)</span>.  The correction depends upon the direction, <span class="math notranslate nohighlight">\(\bar{\mathbf{q}}\)</span>, that the long wave-length limit is approached.  Diagonalisation of the corrected matrix gives the squared frequencies of N-1 LO modes and 2N-2 TO modes, Equation <a class="reference internal" href="#equation-eq-eigenvalues">(23)</a>.  In some of the examples given below the LO frequencies will be given for comparison with the TO frequencies.</p>
</section>
<section id="effect-of-particle-shape-on-infrared-absorption">
<h2><a class="toc-backref" href="#id58">Effect of particle shape on infrared absorption</a><a class="headerlink" href="#effect-of-particle-shape-on-infrared-absorption" title="Permalink to this headline">¶</a></h2>
<p>It has long been recognised that, especially for ionic materials, the local field within a crystal and its coupling with the transverse optical phonons has an important effect on the position and intensity of the absorption. Fröhlich <span id="id20">[<a class="reference internal" href="zreferences.html#id36">22</a>]</span> was one of the first to point out that the frequency of absorption of a small ionic sphere embedded in a low dielectric medium is shifted to lie between the transverse and longitudinal optical frequencies of the material making up the sphere.</p>
<p>In the development of the theory used in PDielec an important assumption is that the particle size of the crystallites in the sample is small compared with the wavelength of light.  Using this approach Genzel and Martin <span id="id21">[<a class="reference internal" href="zreferences.html#id49">23</a>]</span> were able to explain the observed infrared absorption of small spheres of MgO crystallites and the effect of the permittivity of the supporting medium on the spectrum.  Studies of the infrared absorption by small particles of α-Fe<sub>2</sub>O<sub>3</sub> using an effective medium theory and an absorption/scattering theory <span id="id22">[<a class="reference internal" href="zreferences.html#id24">24</a>, <a class="reference internal" href="zreferences.html#id23">25</a>]</span> showed that in order to fit the experimental spectra it was necessary to adjust not only the damping factors in Equation <a class="reference internal" href="#equation-eq-permittivity">(20)</a> but also the permittivity of the matrix and the volume fraction of the dielectric medium. The latter was used to account for aggregation effects as the volume fraction increased. It was also shown that effective medium theories were only applicable for particles smaller than the wavelength of light. For larger particles the
scattering from the particles becomes increasingly important.</p>
<p>More recently Balan and others in a series of papers <span id="id23">[<a class="reference internal" href="zreferences.html#id46">26</a>, <a class="reference internal" href="zreferences.html#id54">27</a>, <a class="reference internal" href="zreferences.html#id25">28</a>]</span> used density functional calculations together with an effective medium theory to calculate the infrared absorption of several minerals incorporating information about the crystallite shape.  In an experimental and theoretical study of irradiated kaolinite  <span id="id24">[<a class="reference internal" href="zreferences.html#id25">28</a>]</span> it was shown that exposure to radiation resulted in shifts in the infrared spectrum which could be accounted for by increasing the polarisability of the particles through
an increase in the optical permittivity tensor.</p>
<p>The underlying theory adopted by PDielec is based on similar premises to the work described above, namely that the dielectric response of small spherical, ellipsoidal, slab-like or needle-like crystallites randomly distributed in a non-absorbing medium such as PTFE, KBr or Nujol, is the same as that of an effective medium material whose frequency dependent dielectric response can be calculated from the frequency dependent permittivity tensor of the crystal (as calculated by solid state QM or MM calculations), the shape of the crystallites and the permittivity of the non-absorbing medium (taken to be a constant over the frequency range of interest).</p>
<p>The development of the theory reported here closely follows the work of Sihvola <span id="id25">[<a class="reference internal" href="zreferences.html#id47">29</a>]</span>.  It will be assumed that the inclusion particles, which may be non-isotropic, ellipsoidal (including spherical, needle-like and plate-like), are randomly orientated in an embedding, non-absorbing medium such as PTFE, KBr or Nujol. It should be emphasized that whilst PDielec can take account of particle shape, particle and matrix permittivity there are many additional aspects of infrared absorption which need to be considered when comparing calculated and experimental results. Most notable of these are; the coupling between phonons and mobile electrons or holes (so called phonon-polariton coupling) <span id="id26">[<a class="reference internal" href="zreferences.html#id44">30</a>]</span>, the scattering which starts to dominate as the particles get larger <span id="id27">[<a class="reference internal" href="zreferences.html#id25">28</a>]</span> and the agglomeration of particles as the volume fraction increases.</p>
<section id="the-polarisability-of-an-isolated-particle">
<h3><a class="toc-backref" href="#id59">The polarisability of an isolated particle</a><a class="headerlink" href="#the-polarisability-of-an-isolated-particle" title="Permalink to this headline">¶</a></h3>
<p>Figure <a class="reference internal" href="#fig-polarisation"><span class="std std-numref">Fig. 11</span></a> shows a schematic of the field and polarisation inside an inclusion with non-isotropic permittivity <span class="math notranslate nohighlight">\(\tensor{\varepsilon}_{i}\)</span> embedded in a supporting medium with permittivity, <span class="math notranslate nohighlight">\(\varepsilon_e\)</span>.  The internal field within the inclusion is indicated by <span class="math notranslate nohighlight">\(\fieldbf{E}_{i}\)</span> the external, applied field is indicated by <span class="math notranslate nohighlight">\(\fieldbf{E}_{e}\)</span> and the induced polarisation in the inclusion is shown by <span class="math notranslate nohighlight">\(\fieldbf{P}\)</span>.</p>
<figure class="align-default" id="id54">
<span id="fig-polarisation"></span><a class="reference internal image-reference" href="_images/Polarisation_Schematic.png"><img alt="_images/Polarisation_Schematic.png" src="_images/Polarisation_Schematic.png" style="width: 450.0px; height: 541.8000000000001px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 11 </span><span class="caption-text">Schematic showing the various terms used to define the effective medium of an inclusion</span><a class="headerlink" href="#id54" title="Permalink to this image">¶</a></p>
</figcaption>
</figure>
<p>The figure show the field and polarisation inside an inclusion with non-isotropic permittivity <span class="math notranslate nohighlight">\({\tensorbf{\varepsilon}}_{i}\)</span> embedded in a supporting medium with permittivity <span class="math notranslate nohighlight">\(\varepsilon_e\)</span>. The internal field within the inclusion is indicated by <span class="math notranslate nohighlight">\(\fieldbf{E}_i\)</span>, the external, applied field is indicated by <span class="math notranslate nohighlight">\(\fieldbf{E}_e\)</span> and the induced polarisation in the inclusion is shown by <span class="math notranslate nohighlight">\(\fieldbf{P}\)</span></p>
<p>The electric field internal to the inclusion gives rise to a polarisation density which is no longer necessarily aligned with the field because the material is non-isotropic. The polarisation density in the inclusion can be expressed as the tensor product of the permittivity contrast between the inclusion and the supporting medium and the (as yet unknown) internal field.</p>
<div class="math notranslate nohighlight" id="equation-eq-polarisationdensity">
<span class="eqno">(26)<a class="headerlink" href="#equation-eq-polarisationdensity" title="Permalink to this equation">¶</a></span>\[\fieldbf{P} = \left( \tensorbs{\varepsilon}_{i} - \varepsilon_{e}{\tensorbf{1}} \right){\fieldbf{E}}_{i}\]</div>
<p>For any ellipsoidal shape (including sphere, slab and needle) with volume <em>V</em>, the polarisation density throughout the particle is uniform and integrating over all space gives the field induced dipole moment of the inclusion, <span class="math notranslate nohighlight">\(\fieldbf{p}\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-polar1">
<span class="eqno">(27)<a class="headerlink" href="#equation-eq-polar1" title="Permalink to this equation">¶</a></span>\[\fieldbf{p} = V\fieldbf{P} = V\left( \tensorbs{\varepsilon}_{i} - \varepsilon_{e}\tensorbf{1} \right)\fieldbf{E}_{i}\]</div>
<p>The dipole and the external field, <span class="math notranslate nohighlight">\({\fieldbf{E}}_{e}\)</span>, are related by the polarisability tensor, <span class="math notranslate nohighlight">\(\tensorbs{\alpha}\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-polar2">
<span class="eqno">(28)<a class="headerlink" href="#equation-eq-polar2" title="Permalink to this equation">¶</a></span>\[\fieldbf{p} = \tensorbf{\alpha}\fieldbf{E}_{e}\]</div>
<p>Equations <a class="reference internal" href="#equation-eq-polar1">(27)</a> and <a class="reference internal" href="#equation-eq-polar2">(28)</a> allow the determination of the polarisability, once the field internal to the inclusion has been expressed in terms of the shape of the inclusion and its permittivity. The polarisation within the inclusion gives rise to a depolarisation field, <span class="math notranslate nohighlight">\(\fieldbf{E}_{d}\)</span>, which depends on the shape of the inclusion through the symmetric and unit-trace depolarisation tensor, <span class="math notranslate nohighlight">\(\tensorbf{L}\)</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-depolarisationfield">
<span class="eqno">(29)<a class="headerlink" href="#equation-eq-depolarisationfield" title="Permalink to this equation">¶</a></span>\[\fieldbf{E}_d = - \frac{1}{\varepsilon_e}\tensorbf{L} \cdot \fieldbf{P}\]</div>
<p>The internal field is the sum of the external field and the depolarisation field.</p>
<div class="math notranslate nohighlight" id="equation-eq-internalfield">
<span class="eqno">(30)<a class="headerlink" href="#equation-eq-internalfield" title="Permalink to this equation">¶</a></span>\[\fieldbf{E}_{i} = \fieldbf{E}_{e} + \fieldbf{E}_{d}\]</div>
<p>The depolarisation matrix is determined from the shape of the crystallite.  For an ellipse, slab or needle a unique axis [hkl] using the crystal axes of the unit cell is specified. PDielec transforms these to a cartesian coordinate system using the unit cell lattice vectors. In the case of a slab morphology the unique direction is a normal to the surface specified by its Miller indices (hkl). The definitions of the various depolarisation tensors are indicated in Table below.</p>
<table class="styled-table docutils align-left" id="tab-depolarisation">
<caption><span class="caption-number">Table 5 </span><span class="caption-text">Definitions used for the depolarisation tensor</span><a class="headerlink" href="#tab-depolarisation" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 7%" />
<col style="width: 93%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="left-align head"><p>Shape</p></th>
<th class="left-align head"><p>Depolarisation Tensor</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td class="left-align"><p>Sphere</p></td>
<td class="left-align"><p><span class="math notranslate nohighlight">\(\tensorbf{L} =\frac{1}{3}\left( \fieldbf{V}_1 \fieldbf{V}_1^T + \fieldbf{V}_2 \fieldbf{V}_2^T+\fieldbf{V}_3 \fieldbf{V}_3^T \right)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>Slab</p></td>
<td class="left-align"><p><span class="math notranslate nohighlight">\(\tensorbf{L}=\fieldbf{V}_1 \fieldbf{V}_1^T\)</span></p></td>
</tr>
<tr class="row-even"><td class="left-align"><p>Needle</p></td>
<td class="left-align"><p><span class="math notranslate nohighlight">\(\tensorbf{L}=\frac{1}{2}\left( \fieldbf{V}_2\fieldbf{V}_2^T + \fieldbf{V}_3 \fieldbf{V}_3^T \right)\)</span></p></td>
</tr>
<tr class="row-odd"><td class="left-align"><p>Ellipsoid</p></td>
<td class="left-align"><p><span class="math notranslate nohighlight">\(\tensorbf{L}=a\fieldbf{V}_1 \fieldbf{V}_1^T + b\fieldbf{V}_2 \fieldbf{V}_2^T + b\fieldbf{V}_3 \fieldbf{V}_3^T\)</span></p></td>
</tr>
</tbody>
</table>
<p>The three directions defined by <span class="math notranslate nohighlight">\(\fieldbf{V}_1, \fieldbf{V}_2 \text{and} \fieldbf{V}_3\)</span> are mutually orthogonal cartesian vectors calculated from [hkl] for an ellipse  or needle and (hkl) for a slab. In the case of a slab, needle or ellipsoid, <span class="math notranslate nohighlight">\({\bar{V}}_{1}\)</span> defines the unique direction and the other vectors are orthogonal to it. For the case of an ellipsoid, the parameters <em>a</em> and <em>b</em> in Table depend on the ratio, <span class="math notranslate nohighlight">\(z\)</span>, of the length of unique axis length over the length of an axis perpendicular to it <span id="id28">[<a class="reference internal" href="zreferences.html#id47">29</a>]</span>.</p>
<p>For z &gt; 1 the ellipsoid is prolate;</p>
<div class="math notranslate nohighlight" id="equation-eq-prolate">
<span class="eqno">(31)<a class="headerlink" href="#equation-eq-prolate" title="Permalink to this equation">¶</a></span>\[e = \sqrt{1 - z^{- 2}},\ a = \frac{\left( 1 - e^{2} \right)}{2e^{3}}\left( \log\frac{1 + e}{1 - e} - 2e \right),\ b = \frac{1}{2}\left( 1 - a \right)\]</div>
<p>For z &lt; 1 the ellipsoid is oblate</p>
<div class="math notranslate nohighlight" id="equation-eq-oblate">
<span class="eqno">(32)<a class="headerlink" href="#equation-eq-oblate" title="Permalink to this equation">¶</a></span>\[ e = \sqrt{z^{- 2} - 1},\ a = \frac{\left( 1 + e^{2} \right)}{e^{3}}\left( e - \operatorname{}e \right),\ b = \frac{1}{2}\left( 1 - a \right)\]</div>
<p>The depolarisation tensor acts as a projection or screening operator describing the effect of the geometry of the inclusion on the depolarisation field which results from its polarisation. For instance, in the case of a needle, only polarisation perpendicular to the needle axis contributes to the depolarizing field, whilst for a slab only polarization perpendicular to the slab face may contribute. Similarly for a sphere, all directions contribute and so the depolarisation matrix is diagonal with a value of 1/3 for each diagonal element, as the trace of the depolarisation tensor must be 1. It follows from Equations <a class="reference internal" href="#equation-eq-polarisationdensity">(26)</a>, <a class="reference internal" href="#equation-eq-depolarisationfield">(29)</a> and <a class="reference internal" href="#equation-eq-internalfield">(30)</a> that;</p>
<div class="math notranslate nohighlight" id="equation-eq-internalfield2">
<span class="eqno">(33)<a class="headerlink" href="#equation-eq-internalfield2" title="Permalink to this equation">¶</a></span>\[\fieldbf{E}_i = \fieldbf{E}_e - \frac{1}{\varepsilon_e} \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e{\tensorbf{1}} \right){\fieldbf{E}}_i\]</div>
<p>Rearrangement allows the internal field of the inclusion to be expressed in terms of the known permittivities, the shape of the inclusion and the external field.</p>
<div class="math notranslate nohighlight" id="equation-eq-internalfield3">
<span class="eqno">(34)<a class="headerlink" href="#equation-eq-internalfield3" title="Permalink to this equation">¶</a></span>\[\fieldbf{E}_i \left( \varepsilon_e{\tensorbf{1}} + \tensorbf{L}  \left( \tensorbs{\varepsilon}_i - \varepsilon_e{\tensorbf{1}} \right) \right) = \varepsilon_e\fieldbf{E}_e\]</div>
<div class="math notranslate nohighlight" id="equation-eq-internalfield4">
<span class="eqno">(35)<a class="headerlink" href="#equation-eq-internalfield4" title="Permalink to this equation">¶</a></span>\[\fieldbf{E}_i = \varepsilon_e{\fieldbf{E}}_e\left( \varepsilon_e\tensorbf{1} + \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e \tensorbf{1} \right) \right)^{- 1}\]</div>
<p>Substituting the internal field expression, <a class="reference internal" href="#equation-eq-internalfield2">(33)</a>, into Equation <a class="reference internal" href="#equation-eq-polar1">(27)</a> for the dipole moment and requiring the dipole moments calculated using the polarisation density to equal those calculated from the polarisability allows the polarisability to be written;</p>
<div class="math notranslate nohighlight" id="equation-eq-polarisation">
<span class="eqno">(36)<a class="headerlink" href="#equation-eq-polarisation" title="Permalink to this equation">¶</a></span>\[\tensorbs{\alpha} = V\varepsilon_e\left( \tensorbs{\varepsilon}_i - \varepsilon_e\tensor{1} \right)\left( \varepsilon_e\tensorbf{1} + \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e\tensorbf{1} \right) \right)^{- 1}\]</div>
<p>Although it has not been specified explicitly the permittivity of the inclusion, and therefore the polarisability tensor, are frequency dependent through the oscillator strengths of each phonon mode contributing to the permittivity according to Equation <a class="reference internal" href="#equation-eq-permittivity">(20)</a>.  The calculation of the complex, frequency dependent polarisability tensor of the composite material is the key step in the calculation of its effective permittivity.</p>
</section>
<section id="the-effective-permittivity-of-a-mixture">
<h3><a class="toc-backref" href="#id60">The effective permittivity of a mixture</a><a class="headerlink" href="#the-effective-permittivity-of-a-mixture" title="Permalink to this headline">¶</a></h3>
<p>To extend this approach to include the effect of a number of inclusions
we need to introduce the concept of an effective permittivity, <span class="math notranslate nohighlight">\(\tensorbf{\varepsilon}_{eff}\)</span>, which describes the behaviour of an average field, <span class="math notranslate nohighlight">\(\left\langle \fieldbf{E} \right\rangle\)</span>, where the angle brackets indicate an average over a volume of the composite material. It is required that the average electric flux density <span class="math notranslate nohighlight">\(\left\langle \fieldbf{D} \right\rangle\)</span> is the same in the effective medium as in the composite medium;</p>
<div class="math notranslate nohighlight" id="equation-eq-averagefluxdensity">
<span class="eqno">(37)<a class="headerlink" href="#equation-eq-averagefluxdensity" title="Permalink to this equation">¶</a></span>\[\left\langle \fieldbf{D} \right\rangle = \tensorbs{\varepsilon}_{eff}\left\langle \fieldbf{E} \right\rangle = \varepsilon_e\left\langle \fieldbf{E} \right\rangle + \left\langle \fieldbf{P} \right\rangle\]</div>
<p>The averaging is necessary because the polarisation within a given inclusion has an effect on the field in other inclusions. The local field in the cavity left by a single inclusion embedded in the average polarisation field is given by;</p>
<div class="math notranslate nohighlight" id="equation-eq-localfield">
<span class="eqno">(38)<a class="headerlink" href="#equation-eq-localfield" title="Permalink to this equation">¶</a></span>\[\fieldbf{E}_L = \left\langle \fieldbf{E} \right\rangle + \frac{1}{\varepsilon_e}\tensorbf{L}\left\langle \fieldbf{P} \right\rangle\]</div>
<p>The local field ‘excites’ the inclusion resulting in a dipole moment <span class="math notranslate nohighlight">\(\mathbf{p}_{mix}\)</span> that is related to the polarisation through the number density of inclusions, <span class="math notranslate nohighlight">\(n\)</span>, and through the polarisability of the inclusion, which is already known from Equation <a class="reference internal" href="#equation-eq-polarisation">(36)</a>.</p>
<div class="math notranslate nohighlight" id="equation-eq-polarisationfield">
<span class="eqno">(39)<a class="headerlink" href="#equation-eq-polarisationfield" title="Permalink to this equation">¶</a></span>\[\left\langle \fieldbf{P} \right\rangle = n{\fieldbf{p}}_{mix} = n\left\langle \tensorbs{\alpha}\fieldbf{E}_{L} \right\rangle\]</div>
<p>The angle brackets around the product of the polarisability and the local field indicate that it is necessary to average the polarisation according to the distribution of alignments of inclusions. In this work it will be assumed that the inclusions are randomly aligned.  Substituting the expression for the local field, Equation <a class="reference internal" href="#equation-eq-localfield">(38)</a>, gives;</p>
<div class="math notranslate nohighlight" id="equation-eq-averagepolarisation">
<span class="eqno">(40)<a class="headerlink" href="#equation-eq-averagepolarisation" title="Permalink to this equation">¶</a></span>\[\left\langle \fieldbf{P} \right\rangle = \left( \tensorbf{1}
- \frac{n\left\langle \tensorbf{\alpha}\tensorbf{L} \right\rangle} {\varepsilon_e} \right)^{- 1}
n\left\langle \tensorbs{\alpha} \right\rangle\left\langle \tensorbf{E} \right\rangle\]</div>
</section>
<section id="mixing-rules">
<h3><a class="toc-backref" href="#id61">Mixing rules</a><a class="headerlink" href="#mixing-rules" title="Permalink to this headline">¶</a></h3>
<p>There are many mixing rules which have been proposed to describe the homogenization of composite materials and a lot of work has been done in comparing their accuracy. Here two methods will be used. The first and the most commonly used method is the Maxwell-Garnett mixing rule <span id="id29">[<a class="reference internal" href="zreferences.html#id47">29</a>]</span>.  Indeed this has been implied by the use of Equation <a class="reference internal" href="#equation-eq-averagefluxdensity">(37)</a> to define the effective permittivity. The other commonly used method is the Bruggeman mixing rule <span id="id30">[<a class="reference internal" href="zreferences.html#id47">29</a>]</span>, which differs substantially in the way the two components of the system are treated. It is usually stated that the Maxwell-Garnet mixing rule is good for low volume fractions of the inclusion and the Bruggeman approach should be better for higher volume fractions <span id="id31">[<a class="reference internal" href="zreferences.html#id52">31</a>]</span>.  In addition to these mixing rules one other approach will be described, namely the Averaged Permittivity (AP) mixing rule, which calculates the absorption spectrum ignoring the effects of the internal field on the absorption and can therefore be used as an indicator of the shifts in frequency and intensity which have occurred owing to the effect of particle shape.</p>
</section>
<section id="maxwell-garnett-mixing-rule">
<h3><a class="toc-backref" href="#id62">Maxwell-Garnett mixing rule</a><a class="headerlink" href="#maxwell-garnett-mixing-rule" title="Permalink to this headline">¶</a></h3>
<p>The Maxwell-Garnett approach for treating the properties of heterogeneous mixtures assumes that the average field and the average flux density result from volume fraction weighted sums. Substituting Equation <a class="reference internal" href="#equation-eq-averagepolarisation">(40)</a> into Equation <a class="reference internal" href="#equation-eq-averagefluxdensity">(37)</a> gives the Maxwell-Garnett effective permittivity;</p>
<div class="math notranslate nohighlight" id="equation-eq-mg">
<span class="eqno">(41)<a class="headerlink" href="#equation-eq-mg" title="Permalink to this equation">¶</a></span>\[\tensorbs{\varepsilon}_{mg} = \tensorbf{1} + \left( \tensorbf{1} - \frac{n\left\langle {\tensorbs{\alpha}}{\tensorbf{L}} \right\rangle}{\varepsilon_e} \right)^{- 1}n\left\langle \tensorbs{\alpha} \right\rangle\]</div>
<p>The fact that the polarisability tensor has a volume term in it (Equation <a class="reference internal" href="#equation-eq-polarisation">(36)</a>) means that the terms in Equation <a class="reference internal" href="#equation-eq-mg">(41)</a> containing <span class="math notranslate nohighlight">\(n\tensorbs{\alpha}\)</span> depend on the volume fraction <span class="math notranslate nohighlight">\(f\)</span>. Although written as a tensor, because the assumption has been made that the inclusions are randomly orientated, the effective permittivity has to be diagonal with equal complex values. Since the polarisability is complex and frequency dependent the effective permittivity is also and its calculation using Equations <a class="reference internal" href="#equation-eq-mg">(41)</a> and <a class="reference internal" href="#equation-eq-polarisation">(36)</a> need to be calculated over the frequency range of interest.</p>
</section>
<section id="bruggeman-mixing-rule">
<h3><a class="toc-backref" href="#id63">Bruggeman mixing rule</a><a class="headerlink" href="#bruggeman-mixing-rule" title="Permalink to this headline">¶</a></h3>
<p>In the Maxwell-Garnett mixing formalism there is a distinction between the inclusion and the supporting medium which results in an asymmetry in the treatment of the two species in the mixture. Instead the Bruggeman mixing rule assumes that each species is polarized against the background of the effective medium and therefore the polarisation in the two components cancel each other out;</p>
<div class="math notranslate nohighlight" id="equation-eq-equalpolarisation">
<span class="eqno">(42)<a class="headerlink" href="#equation-eq-equalpolarisation" title="Permalink to this equation">¶</a></span>\[\left\langle \fieldbf{P}_1 \right\rangle + \left\langle \fieldbf{P}_2 \right\rangle = 0\]</div>
<p>where the components are now labeled 1 and 2 rather than external and internal. The polarisation for species 1 and 2 with a number density of species represented by <span class="math notranslate nohighlight">\(n_1\)</span>  and <span class="math notranslate nohighlight">\(n_2\)</span> can be obtained from the polarisability of the species (Equation <a class="reference internal" href="#equation-eq-equalpolarisation">(42)</a>);</p>
<div class="math notranslate nohighlight" id="equation-eq-polarisation1">
<span class="eqno">(43)<a class="headerlink" href="#equation-eq-polarisation1" title="Permalink to this equation">¶</a></span>\[\left\langle \fieldbf{P}_1 \right\rangle = n_1 \left\langle \tensorbs{\alpha}_1 \right\rangle\fieldbf{E}\]</div>
<p>Substituting Equation <a class="reference internal" href="#equation-eq-polarisation1">(43)</a> into Equation <a class="reference internal" href="#equation-eq-equalpolarisation">(42)</a> leads to the requirement that;</p>
<div class="math notranslate nohighlight" id="equation-eq-bruggemanpolarisability1">
<span class="eqno">(44)<a class="headerlink" href="#equation-eq-bruggemanpolarisability1" title="Permalink to this equation">¶</a></span>\[n_1\left\langle \tensorbs{\alpha}_1 \right\rangle + n_2\left\langle \tensorbs{\alpha}_2 \right\rangle = 0\]</div>
<p>Taking Equation 19 and generalizing it for species <span class="math notranslate nohighlight">\(i\)</span>, (where <span class="math notranslate nohighlight">\(i\)</span> is 1 or 2) embedded in an effective permittivity given by <span class="math notranslate nohighlight">\(\tensorbs{\varepsilon}_{br}\)</span>;</p>
<div class="math notranslate nohighlight" id="equation-eq-bruggemanpolarisability2">
<span class="eqno">(45)<a class="headerlink" href="#equation-eq-bruggemanpolarisability2" title="Permalink to this equation">¶</a></span>\[\tensorbs{\alpha}_i = V_i \tensorbs{\varepsilon}_{br} \left( \tensorbs{\varepsilon}_i - \tensorbs{\varepsilon}_{br} \right)
\left( \tensorbs{\varepsilon}_{br} + \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \tensorbs{\varepsilon}_{br} \right) \right)^{- 1}\]</div>
<p>Equation <a class="reference internal" href="#equation-eq-bruggemanpolarisability1">(44)</a> has to be solved for:math:<cite>tensorbs{varepsilon}_{br}</cite>. Since the systems considered here are isotropic with random inclusions, a solution has to be found for a complex value of the Bruggeman permittivity at each frequency considered.  An issue in the use of Equation <a class="reference internal" href="#equation-eq-bruggemanpolarisability2">(45)</a> is that the same depolarisation matrix is being used for both species, which is clearly not always appropriate. The solution of Equation <a class="reference internal" href="#equation-eq-bruggemanpolarisability1">(44)</a> can be achieved either by iteration or by casting the equation as a minimization problem. The iterative approach implemented in PDielec involves repeated application of Equation 29 until convergence <span id="id32">[<a class="reference internal" href="zreferences.html#id57">32</a>]</span>.  The starting point for the iterations is taken as the Maxwell-Garnett solution for the first frequency and then the solution at the previous
frequency is used to start the iterations.</p>
<div class="math notranslate nohighlight" id="equation-eq-br">
<span class="eqno">(46)<a class="headerlink" href="#equation-eq-br" title="Permalink to this equation">¶</a></span>\[\tensorbs{\varepsilon}_{br} = \frac{f_1{ {\tensorbs{\varepsilon}}}_1\left\lbrack {\tensorbf{1}} + {\tensorbf{L}}\left( {\tensorbs{\varepsilon}}_1 - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1} +
f_2\tensorbs{\varepsilon}_2\left\lbrack \tensorbf{1} + \tensorbf{L}\left( \tensorbs{\varepsilon}_{2} - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1}}
{f_{1}\left\lbrack \tensorbf{1} +{\tensorbf{L}}\left( \tensorbf{\varepsilon}_1 - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1} +
f_{2}\left\lbrack \tensorbf{1} + \tensorbf{L}\left( \tensorbs{\varepsilon}_2 - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1}}\]</div>
<p>Although the Bruggeman permittivity is written here as a tensor, the polarisabilities in Equation <a class="reference internal" href="#equation-eq-bruggemanpolarisability1">(44)</a> have to be averaged over the random orientation of the inclusions and therefore the homogenized material is isotropic with a single complex value for the diagonal tensor.  Also, as with the Maxwell-Garnett mixing rule, since the polarisability is complex and frequency dependent, the effective permittivity is also, and its calculation using Equation <a class="reference internal" href="#equation-eq-mg">(41)</a> needs to be performed over the frequency range of interest.</p>
<p>The choice between using the Bruggeman or Maxwell-Garnett model is often governed by the assumption that the Maxwell-Garnett model works well at low concentrations and the Bruggeman model works better at higher concentrations. Work by Karkkainen <em>et al</em>. using a finite difference method for random mixtures of non-absorbing materials indicated that the Bruggeman approximation works best when there is some clustering of the inclusions and the Maxwell Garnett model works best when there is no clustering <span id="id33">[<a class="reference internal" href="zreferences.html#id26">33</a>]</span>.</p>
<p>The Bruggeman solution has been shown to be unphysical in certain circumstances <span id="id34">[<a class="reference internal" href="zreferences.html#id51">34</a>]</span>.  In particular when the real components of the permittivity have different signs and when the absolute values of the real components are much larger than those of the imaginary components. Unfortunately, it may be that these conditions will apply to modelling infrared absorption. As a result only a few of the examples discussed below will include results using the Bruggeman mixing rule; the majority will use the Maxwell-Garnett mixing rule.</p>
</section>
<section id="averaged-permittivity-mixing-rule">
<h3><a class="toc-backref" href="#id64">Averaged-Permittivity mixing rule</a><a class="headerlink" href="#averaged-permittivity-mixing-rule" title="Permalink to this headline">¶</a></h3>
<p>It is useful to be able to compare the effective medium theories with the absorption predicted using no shape information, that is using only the TO frequencies.</p>
<div class="math notranslate nohighlight" id="equation-eq-ap">
<span class="eqno">(47)<a class="headerlink" href="#equation-eq-ap" title="Permalink to this equation">¶</a></span>\[\tensorbs{\varepsilon}_{TO} = f\left\langle \tensorbs{\varepsilon}_i \right\rangle + \left( 1 - f \right)\varepsilon_e\]</div>
<p>Equation <a class="reference internal" href="#equation-eq-ap">(47)</a> defines an isotropic permittivity which can be used to calculate such an absorption coefficient. The angle brackets indicate an average of orientation. This mixing rule provides a useful comparison between the absorption calculated without any shape effects and that calculated including shape effects using the other mixing rules presented above. At low concentrations the peak positions of the AP mixing rule will be at the TO frequencies.</p>
</section>
</section>
<section id="particle-size-effects">
<h2><a class="toc-backref" href="#id65">Particle size effects</a><a class="headerlink" href="#particle-size-effects" title="Permalink to this headline">¶</a></h2>
<p>Meier and Wokaun <span id="id35">[<a class="reference internal" href="zreferences.html#id19">35</a>]</span> outlined an approach to treating large (metal) spherical particles, where particle size is incorporating terms up to 3^rd^ order in the wave vector <em>k</em>. Using Equations <a class="reference internal" href="#equation-eq-polarisationdensity">(26)</a> and <a class="reference internal" href="#equation-eq-internalfield">(30)</a> we can write;</p>
<div class="math notranslate nohighlight" id="equation-eq-polarisationwithsize">
<span class="eqno">(48)<a class="headerlink" href="#equation-eq-polarisationwithsize" title="Permalink to this equation">¶</a></span>\[\fieldbf{P} = \left( \tensorbs{\varepsilon}_i - \varepsilon_e \tensorbf{1} \right)\left( \fieldbf{E}_e + \fieldbf{E}_d \right)\]</div>
<div class="math notranslate nohighlight" id="equation-eq-fieldwithsize">
<span class="eqno">(49)<a class="headerlink" href="#equation-eq-fieldwithsize" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\fieldbf{E}_d &amp;= - \frac{\left( 1 - x^2 - i\frac{2}{3}x^3 \right)}{\varepsilon_e}{\tensorbf{L}} \fieldbf{P} \\
x &amp;= ak = \frac{2\pi a}{\lambda}
\end{aligned}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(a\)</span> is the radius of thespherical particle and <span class="math notranslate nohighlight">\(x\)</span> is the dimensionless ‘size’ of the particle with respect to the wavelength of the incident light. The first term relating the depolarisation field to the polarisability is the same as that used above in Equation <a class="reference internal" href="#equation-eq-depolarisationfield">(29)</a>. The second term is a dynamic depolarisation term and the third term is a radiation damping correction to the electrostatic solution <span id="id36">[<a class="reference internal" href="zreferences.html#id19">35</a>]</span>.</p>
<p>A slightly different, but related, approach is presented by <span id="id37">[<a class="reference internal" href="zreferences.html#id47">29</a>]</span>.  Starting from Equation <a class="reference internal" href="#equation-eq-internalfield2">(33)</a>, a size dependent term <span class="math notranslate nohighlight">\(G(x)\)</span> is introduced as indicated by the work of Peltoniemi <span id="id38">[<a class="reference internal" href="zreferences.html#id17">36</a>]</span>;</p>
<div class="math notranslate nohighlight" id="equation-eq-sizeterms">
<span class="eqno">(50)<a class="headerlink" href="#equation-eq-sizeterms" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
G\left( x \right) &amp;= G_1\left( x \right) + G_2\left( x \right) \\
G_{1}\left( x \right) &amp;= \ \frac{2}{3}\left\lbrack \left( 1 + ix\right)e^{- ix} - 1 \right\rbrack \\
G_{2}\left( x \right) &amp;= \ \left ( 1 + ix - \frac{7}{15}x^{2} - i\frac{2}{15}x^{3} \right)e^{- ix}-1
\end{aligned}\end{split}\]</div>
<p>The modified equation for the relationship between the internal field and the external field based on equation <a class="reference internal" href="#equation-eq-internalfield2">(33)</a> becomes;</p>
<div class="math notranslate nohighlight" id="equation-eq-modifiedinternalfield">
<span class="eqno">(51)<a class="headerlink" href="#equation-eq-modifiedinternalfield" title="Permalink to this equation">¶</a></span>\[\fieldbf{E}_i = \fieldbf{E}_e - \frac{\left( 1 - G\left( x \right) \right)}{\varepsilon_e}\tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e\tensorbf{ 1} \right)\fieldbf{E}_i\]</div>
<p>This leads to a modified equation for the polarisability of spherical particles;</p>
<div class="math notranslate nohighlight" id="equation-eq-modifiedpolarisability">
<span class="eqno">(52)<a class="headerlink" href="#equation-eq-modifiedpolarisability" title="Permalink to this equation">¶</a></span>\[\tensorbs{\alpha}\left( x \right) = V\varepsilon_e\left( \tensorbs{\varepsilon}_i -
\varepsilon_e\tensorbf{1} \right)\left( \varepsilon_e\mathbf{1} +
\left( 1 - G\left( x\right) \right)\tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_{e}\mathbf{1} \right) \right)^{- 1}\]</div>
<p>Using the modified, sized dependent polarisability all the Bruggeman and Maxwell mixing schemes can be implemented in a way that incorporates size effects.  Generally speaking the on-set of changes in the calculated absorption is an indication that size effects are important and should be treated properly.</p>
</section>
<section id="light-scattering-by-spherical-particles-using-mie-theory">
<h2><a class="toc-backref" href="#id66">Light scattering by spherical particles using Mie theory</a><a class="headerlink" href="#light-scattering-by-spherical-particles-using-mie-theory" title="Permalink to this headline">¶</a></h2>
<p>For particles which are comparable in size to the wavelength of light, the theory developed by Mie and described fully by van de Hulst <span id="id39">[<a class="reference internal" href="zreferences.html#id42">19</a>]</span> can be used. Unfortunately this theory is only applicable to spherical, isotropic particles where the separation between the particles is large compared with the wavelength of light.</p>
<p>PDielec implements a form of Mie theory using the Python library PyMieScatt <span id="id40">[<a class="reference internal" href="zreferences.html#id16">37</a>]</span>. In order to treat systems which are anisotropic, PDielec first of all calculates the Maxwell-Garnett permittivity for the anisotropic sphere embedded with random orientation in the supporting matrix.  The program then calculates the required permittivity of an isotropic sphere which would give the same Maxwell-Garnett permittivity as the anisotropic system.  The Mie scattering is then performed on this isotropic sphere.</p>
<p>An alternative method which diagonalises the real permittivity and then transforms the complex permittivity into the new basis was found to cause anomolous absorptions at the TO frequencies and so the method is no longer used.  However, the theory is given here in case it ever has to be revived.</p>
<div class="math notranslate nohighlight" id="equation-eq-transform1">
<span class="eqno">(53)<a class="headerlink" href="#equation-eq-transform1" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
&amp; {\tensorbf{U}^{\text{T}}} \tensorbs{\varepsilon}^{real} \tensorbf{U} = \tensorbs{\varepsilon}^{diagonal} \\
&amp; {\tensorbs{\varepsilon}}^{new} = \tensorbf{U}^\text{T} \tensorbs{\varepsilon}^{full}\tensorbf{U}
\end{aligned}\end{split}\]</div>
<p>The core of Mie theory is the calculation of efficiency factors S1(θ) and S2(θ) (page 125 in reference <span id="id41">[<a class="reference internal" href="zreferences.html#id42">19</a>]</span>.  These factors depend upon the size of the particle with relative to the wavelength of the light (<span class="math notranslate nohighlight">\(x\)</span>) and the refractive index of infrared active material (<span class="math notranslate nohighlight">\(m_1\)</span>) relative to that of the supporting medium (<span class="math notranslate nohighlight">\(m_2\)</span>). Both refractive indices are scalars, <span class="math notranslate nohighlight">\(m_1\)</span> is complex as light is absorbed by the material and <span class="math notranslate nohighlight">\(m_2\)</span> is assumed to be real.</p>
<p>For each of the three diagonal elements of <span class="math notranslate nohighlight">\(\tensorbs{\varepsilon}_{new}\)</span> the relative refractive index, <span class="math notranslate nohighlight">\(m\)</span> is calculated;</p>
<div class="math notranslate nohighlight" id="equation-eq-mievariables">
<span class="eqno">(54)<a class="headerlink" href="#equation-eq-mievariables" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
m_1 &amp;= \tensorbs{\varepsilon}_{w,w}^{new} \\
m &amp;= \frac{m_{1}}{m_{2}} \\
x &amp;= \frac{2\pi a}{\lambda} \\
\lambda &amp;= \frac{\lambda_{\text{ vac}}}{m_{2}}
\end{aligned}\end{split}\]</div>
<p>The size parameter depends upon the refractive index of the supporting medium because the wavelength of light is smaller than its vacuum value in a medium with a refractive index greater than one. The subscript <span class="math notranslate nohighlight">\(w\)</span> indicates one of the three directions x, y or z in the basis which diagonalises the real permittivity tensor.</p>
<p>Using the routines available in PyMieScatt <span id="id42">[<a class="reference internal" href="zreferences.html#id16">37</a>]</span> the efficiency factor <span class="math notranslate nohighlight">\(S(0)\)</span>, where <span class="math notranslate nohighlight">\(S(0) = S1(0) = S2(0)\)</span>, is calculated from <span class="math notranslate nohighlight">\(m\)</span> and <span class="math notranslate nohighlight">\(x\)</span>. The extinction (this includes absorption and scattering) along with retardation are reflected in the overall complex refractive index, page 129 in reference <span id="id43">[<a class="reference internal" href="zreferences.html#id42">19</a>]</span>;</p>
<div class="math notranslate nohighlight" id="equation-eq-mievariable2">
<span class="eqno">(55)<a class="headerlink" href="#equation-eq-mievariable2" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\widetilde{m}_w &amp;= m_2\left( 1 + iS\left( 0 \right)2\pi Nk^{- 3} \right) \\
N &amp;= \frac{f}{V_{sphere}}  \\
V_{sphere} &amp;= \frac{4}{3} \pi a^{3} \\
k &amp;= \frac{2\pi}{\lambda}
\end{aligned}\end{split}\]</div>
<p>Here <span class="math notranslate nohighlight">\(N\)</span> is the number density of particles and <span class="math notranslate nohighlight">\(k\)</span> is the wave-vector of the light in the surrounding medium. The subscript <span class="math notranslate nohighlight">\(w\)</span> indicates that there are three values for the effective refractive index, depending on which diagonal value of the permittivity tensor is taken. There is a change in sign from the expressions given by Hulst, this to make the imaginary component compatible with the effective permittivities.  Once the effective refractive index is known in each direction the effective permittivity can be calculated using the one third rule <span id="id44">[<a class="reference internal" href="zreferences.html#id18">38</a>]</span>;</p>
<div class="math notranslate nohighlight" id="equation-eq-effectiveri">
<span class="eqno">(56)<a class="headerlink" href="#equation-eq-effectiveri" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
\widetilde{m}_{eff} &amp;=  \frac{1}{3}\sum_w{\widetilde{m}}_w \\
\varepsilon_{eff} &amp;= \widetilde{m}_{eff}^2
\end{aligned}\end{split}\]</div>
<p>This approach to taking anisotropy into account when the embedded particles are anisotropic but randomly oriented is approximate, but has been shown to have a reasonably wide range of application <span id="id45">[<a class="reference internal" href="zreferences.html#id18">38</a>]</span>.</p>
</section>
<section id="calculation-of-atr-extinction-spectra">
<span id="atr-theory"></span><h2><a class="toc-backref" href="#id67">Calculation of ATR Extinction Spectra</a><a class="headerlink" href="#calculation-of-atr-extinction-spectra" title="Permalink to this headline">¶</a></h2>
<p>Attenuated total reflectance spectroscopy (ATR) uses a medium of high refractive index contrast to modify the reflectance and transmission of the infrared radiation.  Balan has reported the calculation of the ATR spectrum of apatite <span id="id46">[<a class="reference internal" href="zreferences.html#id65">39</a>]</span> and chrysotile <span id="id47">[<a class="reference internal" href="zreferences.html#id66">40</a>]</span>.
A similar approach is adopted by the PDielec package.  Denoting the angle of incidence by <span class="math notranslate nohighlight">\(\theta\)</span> and the refractive index of high index, non-absorbing material by <span class="math notranslate nohighlight">\(n_0\)</span> and that of the absorbing material by <span class="math notranslate nohighlight">\(n_s\)</span>, the Fresnel amplitudes for reflection in the direction parallel (<span class="math notranslate nohighlight">\(r_p\)</span>) and perpendicular (<span class="math notranslate nohighlight">\(r_s\)</span>) to the incident radiation. <span id="id48">[<a class="reference internal" href="zreferences.html#id67">41</a>]</span></p>
<div class="math notranslate nohighlight" id="equation-eq-fresnel">
<span class="eqno">(57)<a class="headerlink" href="#equation-eq-fresnel" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
r_s &amp;= \frac{ -n_0 \cos{\theta} + \sqrt{n_s^2 - n_0^2 \sin^2{\theta}}}{n_0 \cos{\theta} + \sqrt{n_s^2 - n_0^2 \sin^2{\theta}}} \\
r_p &amp;= \frac{ \frac{n_s^2}{n_0} \cos{\theta} + \sqrt{n_s^2 - n_0^2 \sin^2{\theta}}}{\frac{n_s^2}{n_0} \cos{\theta} + \sqrt{n_s^2 - n_0^2 \sin^2{\theta}}}
\end{aligned}\end{split}\]</div>
<p>Using <span class="math notranslate nohighlight">\(f_p\)</span> and <span class="math notranslate nohighlight">\(f_s\)</span> as the fractions of P and S polarized incident light, the extinction is expressed in absorbance units as;</p>
<div class="math notranslate nohighlight" id="equation-eq-fresnel-extinction">
<span class="eqno">(58)<a class="headerlink" href="#equation-eq-fresnel-extinction" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
e_s &amp;= -log_{10}( r_s^*r_s ) \\
e_p &amp;= -log_{10}( r_p^*r_p ) \\
e_{total} &amp;= -log_{10}( f_p r_p^*r_p + f_s r_s^*r_s ) \\
\end{aligned}\end{split}\]</div>
<p>The approach adopted by Balan and in the PDielec package is to use the calculated effective permittivity to determine the (complex) refractive index of the material being studied.  ATR measurements are taken with compressed powders of the material, so the appropriate effective medium can be determined from a high volume fraction of the crystal in air.</p>
</section>
<section id="scattering-effects-due-to-air-inclusions">
<h2><a class="toc-backref" href="#id68">Scattering Effects due to Air Inclusions</a><a class="headerlink" href="#scattering-effects-due-to-air-inclusions" title="Permalink to this headline">¶</a></h2>
<p>A common method for taking a terahertz spectrum is to dilute the active dielectric material in a transparent material such as polyethylene or PTFE spheres and then compress the composite material.  This leads to the presence of large air inclusions, or bubbles in the sample material.  The size of these inclusions can vary in size from 10 to 100 microns and is therefore capable of scattering terahertz radiation.  To account for this  the effective dielectric constant of the supporting matrix can include these scattering effects using Waterman-Truell scattering theory <span id="id49">[<a class="reference internal" href="zreferences.html#id69">42</a>]</span>.</p>
<div class="math notranslate nohighlight" id="equation-eq-truell">
<span class="eqno">(59)<a class="headerlink" href="#equation-eq-truell" title="Permalink to this equation">¶</a></span>\[K = \sqrt{ k^2 [ 1 + \frac{ 2 \pi N f(0)}{k^2} ]^2 - [ \frac { 2 \pi N f(\pi)}{k^2} ]^2 }\]</div>
<p>Where <span class="math notranslate nohighlight">\(N\)</span> is the number density of voids, <span class="math notranslate nohighlight">\(K\)</span> is the effective wavenumber of the wave in the material, <span class="math notranslate nohighlight">\(k\)</span> is the wavenumber of the wave in the support without air inclusions and  <span class="math notranslate nohighlight">\(f(0)\)</span> and <span class="math notranslate nohighlight">\(f(\pi)\)</span> are the forward and backwared amplitude scattering factors.</p>
<div class="math notranslate nohighlight" id="equation-eq-amplitudes">
<span class="eqno">(60)<a class="headerlink" href="#equation-eq-amplitudes" title="Permalink to this equation">¶</a></span>\[f(\theta) = \frac{i}{k} S(\theta)\]</div>
<p>The scattering factors are determined using Mie theory, where it is assumed that there are spherical voids in the matrix, which are large enough to scatter light.</p>
<div class="math notranslate nohighlight" id="equation-eq-refractive-index">
<span class="eqno">(61)<a class="headerlink" href="#equation-eq-refractive-index" title="Permalink to this equation">¶</a></span>\[\begin{split}\begin{aligned}
m_2 &amp;= \frac{K \lambda} {2 \pi} \\
\epsilon_e &amp;= m_2^2 \\
\end{aligned}\end{split}\]</div>
<p>The effective permittivity of the matrix with voids is then used in the calculation of the effective medium theory for the dielectric material.  The calculation proceeds as it did in the case with no scattering, only now a complex permittivity is used to describe the supporting matrix.</p>
</section>
<section id="removing-baseline-artifacts-from-experiment">
<h2><a class="toc-backref" href="#id69">Removing Baseline Artifacts from Experiment</a><a class="headerlink" href="#removing-baseline-artifacts-from-experiment" title="Permalink to this headline">¶</a></h2>
<p>In the process of reproducing experimental spectra using calculated information it is often necessary to remove any baseline artifacts from the experimental data.  A reatlively straightforward approach is adopted by <em>PDielec</em> using a Hodrick-Prescott filter.  The approach is also called asymmetric least squares smoothing.</p>
<p>If there is a data sequence <span class="math notranslate nohighlight">\(y\)</span>, sampled at regular intervals we want to determine the baseline sequence <span class="math notranslate nohighlight">\(y\)</span> such that x and y are as close as possible to each other with the requirement that x is as smooth as required.</p>
<p>It can be shown <span id="id50">[<a class="reference internal" href="zreferences.html#id70">43</a>]</span> that this can be acheived by an iterative solution for <span class="math notranslate nohighlight">\(x\)</span> of ;</p>
<div class="math notranslate nohighlight" id="equation-eq-hodrick-rescott">
<span class="eqno">(62)<a class="headerlink" href="#equation-eq-hodrick-rescott" title="Permalink to this equation">¶</a></span>\[( \tensorbf{W} + \lambda \tensorbf{D}^T \tensorbf{D}) x = \tensorbf{W} y\]</div>
<p>where <span class="math notranslate nohighlight">\(\tensorbf{W}\)</span> is a diagonal matrix of weights modified during the iterations to make values of <span class="math notranslate nohighlight">\(x\)</span> lie below those of <span class="math notranslate nohighlight">\(y\)</span> and <span class="math notranslate nohighlight">\(\tensorbf{D}\)</span> is a 3rd order differencing matrix.  Since the differencing matrix is very sparse, sparse matrix routines are used to solve the equations.</p>
<p>In <em>PDGui</em> the value of <span class="math notranslate nohighlight">\(\lambda\)</span> is supplied as <span class="math notranslate nohighlight">\(\log \lambda\)</span>.</p>
</section>
<section id="calculation-of-single-crystal-optics">
<h2><a class="toc-backref" href="#id70">Calculation of Single Crystal Optics</a><a class="headerlink" href="#calculation-of-single-crystal-optics" title="Permalink to this headline">¶</a></h2>
<p>The <em>SingleCrystal tab</em> enables the calculation of the optical behaviour of a single crystal (thick slab or film).  The method uses the pyGTM code available on GitHub <span id="id51">[<a class="reference internal" href="zreferences.html#id6">8</a>]</span>.  This code implements a generalized transfer matrix method described by Passler et al. <span id="id52">[<a class="reference internal" href="zreferences.html#id71">9</a>]</span> and which builds on previous publications <span id="id53">[<a class="reference internal" href="zreferences.html#id72">10</a>, <a class="reference internal" href="zreferences.html#id73">11</a>]</span></p>
<p>There are two coordinate systems to consider.  The first is the laboratory coordinate system (X,Y,Z).
It is assumed that the normal to the crystal surface is aligned with the Z-axis and that the incident radiation is in the X-Z plane.  P-polarised light is polarised parallel to this plane and S-polarised perpendicular (senkrecht) to this plane.</p>
<p>The other coordinate system of interest is that of the crystal.  The calculation of the permittivity tensor is performed in the crystal coordinate system (x,y,z).  The crystal place is defined by a set of miller indices (hkl) and the normal to the crystal surface is rotated to align the laboratory Z-axis.  Finally in the laboratory frame the crystal may be rotated around the Z-axis by the azimuthal angle <span class="math notranslate nohighlight">\(\phi\)</span>.</p>
<p>The calculation mode referred to as a “thick slab” assumes that there are only two media.  The media through which the incident light travels and the crystalline media by which it is reflected.  Transmission is not of interest in this case, as in the case of the a thick crystal it assumed that no absorption will take place and that there will be no internal reflection within the crystal.
This mode is similar to a standard Fresnel calculation of reflectance but is appropriate for general permittivity tensors.</p>
<p>The other modes of operation refer to a thin film and in these cases there are three media, an isotropic medium for the incident light, the crystal film (which now has a thickness) and the isotropic medium in which there is a detector.  In the case transmittance, reflectance and absorptance are all relevant.</p>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Theory</a><ul>
<li><a class="reference internal" href="#molecular-approach-to-absorption-intensity">Molecular approach to absorption intensity</a></li>
<li><a class="reference internal" href="#solid-state-approach-to-absorption-intensity">Solid state approach to absorption intensity</a></li>
<li><a class="reference internal" href="#effect-of-particle-shape-on-infrared-absorption">Effect of particle shape on infrared absorption</a><ul>
<li><a class="reference internal" href="#the-polarisability-of-an-isolated-particle">The polarisability of an isolated particle</a></li>
<li><a class="reference internal" href="#the-effective-permittivity-of-a-mixture">The effective permittivity of a mixture</a></li>
<li><a class="reference internal" href="#mixing-rules">Mixing rules</a></li>
<li><a class="reference internal" href="#maxwell-garnett-mixing-rule">Maxwell-Garnett mixing rule</a></li>
<li><a class="reference internal" href="#bruggeman-mixing-rule">Bruggeman mixing rule</a></li>
<li><a class="reference internal" href="#averaged-permittivity-mixing-rule">Averaged-Permittivity mixing rule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#particle-size-effects">Particle size effects</a></li>
<li><a class="reference internal" href="#light-scattering-by-spherical-particles-using-mie-theory">Light scattering by spherical particles using Mie theory</a></li>
<li><a class="reference internal" href="#calculation-of-atr-extinction-spectra">Calculation of ATR Extinction Spectra</a></li>
<li><a class="reference internal" href="#scattering-effects-due-to-air-inclusions">Scattering Effects due to Air Inclusions</a></li>
<li><a class="reference internal" href="#removing-baseline-artifacts-from-experiment">Removing Baseline Artifacts from Experiment</a></li>
<li><a class="reference internal" href="#calculation-of-single-crystal-optics">Calculation of Single Crystal Optics</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="software.html"
                        title="previous chapter">Software components</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="analysis.html"
                        title="next chapter">Phonon Analysis</a></p>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/theory.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" />
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>  
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="analysis.html" title="Phonon Analysis"
             >next</a> |</li>
        <li class="right" >
          <a href="software.html" title="Software components"
             >previous</a> |</li>
          <li><img src="_static/py.svg" alt="python logo" style="vertical-align: middle; margin-top: -1px"/></li>
          <li><a href="https://www.python.org/">Python</a> &#187;</li>
          <li class="switchers">
            <div class="language_switcher_placeholder"></div>
            <div class="version_switcher_placeholder"></div>
          </li>
          <li>
              
              <a href="index.html">PDielec: John Kendrick & Andrew Burnett</a> &#187;
              
          </li>
        <li class="nav-item nav-item-this"><a href="">Theory</a></li>
                <li class="right">
                    

    <div class="inline-search" role="search">
        <form class="inline-search" action="search.html" method="get">
          <input placeholder="Quick search" aria-label="Quick search" type="text" name="q" />
          <input type="submit" value="Go" />
          <input type="hidden" name="check_keywords" value="yes" />
          <input type="hidden" name="area" value="default" />
        </form>
    </div>
                     |
                </li>
            
      </ul>
    </div>  
    <div class="footer">
    &copy; Copyright 2018, John Kendrick and Andrew Burnett.
    <br />
    This page is licensed under the Python Software Foundation License Version 2.
    <br />
    Examples, recipes, and other code in the documentation are additionally licensed under the Zero Clause BSD License.
    <br />
    See <a href="">History and License</a> for more information.
    <br /><br />

    The Python Software Foundation is a non-profit corporation.
<a href="https://www.python.org/psf/donations/">Please donate.</a>
<br />
    <br />

    Last updated on None.
    
    <br />

    Created using <a href="https://www.sphinx-doc.org/">Sphinx</a> 4.0.2.
    </div>

  </body>
</html>