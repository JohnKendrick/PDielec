
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>INTRODUCTION &#8212; PDielec 4.0 documentation</title>
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="_static/mathjax.js"></script>
    <script type="text/javascript" src="_static/mathjax.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&lt;no title&gt;" href="preader.html" />
    <link rel="prev" title="&lt;no title&gt;" href="pdgui.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="toctree-wrapper compound">
</div>
<div class="section" id="introduction">
<h1>INTRODUCTION<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h1>
<p>The theory underlying the Python package PDielec is described.  PDielec calculates the infrared absorption characteristics of a crystalline material supported in a non-absorbing medium.  PDielec post processes solid state quantum mechanical and molecular mechanical calculations of the phonons and dielectric response of the crystalline material. The molecular and solid state quantum mechanical (QM) calculations of response properties such as the frequencies and intensities of infrared (IR) and terahertz (THz) radiation absorption has become generally available in many molecular and solid state computer programs. A common approach is to assume the harmonic approximation and calculate the mass weighted force constant matrix (for molecules) or the dynamical matrix at the gamma point (for periodic solids). Diagonalisation of the matrix gives the frequencies for absorption and the normal modes (molecules) or phonon displacements (periodic solids). The calculation of the absorption intensity for each mode requires the calculation of the change in dipole moment caused by the displacement of the atoms for that mode. For solids where there is a large separation of charge, there can be a large coupling between a phonon mode and the internal field within a particle resulting from its morphology.</p>
<p>PDielec post processes the output of solid state quantum mechanical and molecular mechanics (MM) based codes such as VASP <a class="reference internal" href="theory.html#hafner2008c" id="id1">[18]</a>, CASTEP <a class="reference internal" href="theory.html#clark2005d" id="id2">[8]</a>, CRYSTAL <a class="reference internal" href="theory.html#dovesi2014" id="id3">[9]</a>, Abinit <a class="reference internal" href="theory.html#gonze2016" id="id4">[16]</a> , Quantum Espresso <a class="reference internal" href="theory.html#giannozzi2009" id="id5">[14]</a>, Phonopy <a class="reference internal" href="theory.html#togo2015" id="id6">[33]</a>, and GULP <a class="reference internal" href="theory.html#gale2003" id="id7">[12]</a> to predict the infrared absorption of crystalline insulator materials whose crystal size is small compared with the wavelength of the absorbing radiation. The package is suited for the calculation of the complex, frequency dependent permittivity and its associated absorption of infrared radiation for a finely ground crystalline material dispersed in a low loss dielectric medium such KBr or Polytetrafluoroethylene (PTFE). A particular feature of the program is its ability to take into account the constant permittivity of the supporting medium and the particle shape of the material of interest through an effective medium theory. The paper outlines the theory used by the program and gives some examples of the application of the program for ionic and molecular materials.</p>
</div>
<div class="section" id="theory">
<h1>THEORY<a class="headerlink" href="#theory" title="Permalink to this headline">¶</a></h1>
<p>Equations <a class="reference internal" href="theory.html#equation-eq-beer1">(1)</a> and <a class="reference internal" href="theory.html#equation-eq-beer2">(2)</a> describe Beer-Lambert’s law <a class="reference internal" href="theory.html#bertie2006" id="id8">[6]</a> where <span class="math notranslate">\(\alpha\)</span> is the (decadic) absorption coefficient (usually given in cm<sup>-1</sup>), <span class="math notranslate">\(I\)</span> and <span class="math notranslate">\(I_0\)</span> are the intensities after and before absorption respectively and <span class="math notranslate">\(d\)</span> is the path length.</p>
<div class="math notranslate">
\[\frac{I}{I_{0}} = 10^{- \alpha d}\]</div>
<div class="math notranslate">
\[log\left( \frac{I}{I_{0}} \right) = -\alpha d\]</div>
<p>It is common, especially in the chemistry community, when reporting infrared spectra to use a decadic molar absorption coefficient (<span class="math notranslate">\(a\)</span>), which has units of L·mol<sup>-1</sup>·cm<sup>-1</sup>. The relationship between the absorption coefficient and the molar absorption coefficient <a class="reference internal" href="theory.html#bertie2006" id="id9">[6]</a> is;</p>
<div class="math notranslate">
\[\alpha = aC\]</div>
<p>where <span class="math notranslate">\(C\)</span> is the concentration of the absorbing species.</p>
<div class="section" id="molecular-approach-to-absorption-intensity">
<h2>Molecular Approach to Absorption Intensity<a class="headerlink" href="#molecular-approach-to-absorption-intensity" title="Permalink to this headline">¶</a></h2>
<p>For molecules the transition intensity <span class="math notranslate">\(I_k\)</span> of the <span class="math notranslate">\(k^{th}\)</span> vibrational mode (calculated from the change in dipole moment along the mode displacement) can be converted to an integrated molar absorption coefficient, <span class="math notranslate">\(A_k\)</span>, which can then be more readily compared with experiment. The theory for this is described by Wilson, Decius and Cross <a class="reference internal" href="theory.html#wilson1955" id="id10">[34]</a> and results in expressions such as those given in equations <a class="reference internal" href="theory.html#equation-eq-absorption1">(4)</a> and <a class="reference internal" href="theory.html#equation-eq-absorption2">(5)</a>.  The first expression shows the relationship between the integrated molar absorption coefficient and the transition intensity and uses the number of molecules per unit volume (<span class="math notranslate">\(N\)</span>), the velocity of light (<span class="math notranslate">\(c\)</span>) and the degeneracy of the mode (<span class="math notranslate">\(g_k\)</span>). The second expression shows the appropriate conversion factors if the units for the integrated molar absorption coefficient are L·mol<sup>-1</sup>·cm<sup>-2</sup> (1 L·mol<sup>-1</sup>·cm<sup>-2</sup> = 0.01 km·mol<sup>-1</sup>) and the units for the transition intensity are D<sup>2</sup>Å<sup>-2</sup>amu<sup>-1</sup>, where D represents the Debye unit of dipole  moment and amu is an atomic mass unit. The factor <span class="math notranslate">\(log_e10\)</span> arises due to the choice of a decadic Beer’s law.</p>
<div class="math notranslate">
\[ A_k =  \frac{N\pi}{3c^{2}\log_e10}g_kI_k\]</div>
<div class="math notranslate">
\[A_k =  \frac{Na\pi}{3000c^{2}2.302585}g_kI_k  = 4225.6I_k\]</div>
<p>The derivation of the above expressions assumes that the rotational levels are not quantised and that the vibrational levels are thermally occupied according to a Boltzmann distribution. In order to use the calculated molecular intensities to predict a spectrum it is usual to assume <a class="reference internal" href="theory.html#wilson1955" id="id11">[34]</a> that each transition is associated with a Lorentzian line shape with a full width at half maximum (FWHM) of <span class="math notranslate">\(\sigma_k\)</span>. It is common, when reporting comparison between theoretical and experimental spectra, to assume that the line widths are the same for all modes <a class="reference internal" href="theory.html#juliano2013" id="id12">[21]</a><a class="reference internal" href="theory.html#burnett2013" id="id13">[7]</a>.  Recent work on terahertz absorption in crystalline pentaerythritol tetranitrate (PETN) using molecular dynamics calculations <a class="reference internal" href="theory.html#pereverzev2011b" id="id14">[27]</a> in combination with the direct calculation of the cubic anharmonic couplings of the normal modes <a class="reference internal" href="theory.html#pereverzev2011b" id="id15">[27]</a> has shown that the FWHM of the intense absorptions may vary between 10 and 25 cm<sup>-1</sup>. Assuming a Lorentzian line shape, the molar absorption coefficient for the <span class="math notranslate">\(k^{th}\)</span> mode at wavenumber, <span class="math notranslate">\({\bar{\nu}}_{k}\)</span>, can be written as a function of frequency or wavenumber (<span class="math notranslate">\(\bar{\nu}\)</span>);</p>
<div class="math notranslate">
\[a_k(\bar{\nu}) = \frac{2A_k}{\pi}\frac{\sigma_k}{4\left( \bar{\nu} - {\bar{\nu}}_k \right)^{2} + \sigma_k^2}\]</div>
<div class="math notranslate">
\[a_k^{max} = \frac{2A_k}{\pi\sigma_k}\]</div>
<p>The maximum height of the Lorentzian, <span class="math notranslate">\(a_{k}^{\max}\)</span> clearly depends upon the value of <span class="math notranslate">\(\sigma_k\)</span>. As can be seen in Equation <a class="reference internal" href="theory.html#equation-eq-integratedmolarintensity">(8)</a>, the choice of normalisation for the Lorentzian means that integration of the molar absorption coefficient over wavenumber returns the integrated molar absorption coefficient and a sum over all the bands provides the total molar absorption coefficient <span class="math notranslate">\(a^{mol}(\bar{\nu})\)</span> as a function of wavenumber, calculated from the intensities of each band.  Equation <a class="reference internal" href="theory.html#equation-eq-molarabsorption">(10)</a> shows the relationship between the absorption and the molar absorption coefficients. <span class="math notranslate">\(C\)</span> is the concentration usually expressed in mol·L<sup>-1</sup>.</p>
<div class="math notranslate">
\[A_k = \int{a_k(\bar{\nu})d\bar{\nu}}\]</div>
<div class="math notranslate">
\[a^{mol}(\bar{\nu}) = \sum_k{a_k(\bar{\nu})}\]</div>
<div class="math notranslate">
\[\alpha^{\text{mol}}(\bar{\nu}) = Ca^{\text{mol}}(\bar{\nu})\]</div>
<p>A comment should be made about the various units which can be used for these quantities. A common unit for the transition intensity is D<sup>2</sup>Å<sup>-2</sup>amu<sup>-1</sup>, another is km·mol<sup>-1</sup>. However, it should be pointed out that strictly speaking the latter unit refers to the integrated molar absorption coefficient as defined above in Equation <a class="reference internal" href="theory.html#equation-eq-integratedmolarintensity">(8)</a> and therefore relies on the assumptions made in its derivation. (&nbsp;1&nbsp;D<sup>2</sup>Å<sup>-2</sup>amu<sup>-1</sup> is equivalent to 42.256 km·mol<sup>-1</sup> ).</p>
</div>
<div class="section" id="solid-state-approach-to-absorption-intensity">
<h2>Solid State Approach to Absorption Intensity<a class="headerlink" href="#solid-state-approach-to-absorption-intensity" title="Permalink to this headline">¶</a></h2>
<p>The optical properties of a solid are determined by its complex, frequency dependent relative permittivity,
<span class="math notranslate">\(\boldsymbol{\varepsilon}(\bar{\nu})\)</span>, and in particular the real and imaginary components, <span class="math notranslate">\(\boldsymbol{\kappa}\)</span> and <span class="math notranslate">\(\mathbf{n}\)</span>, of the complex refractive index, <span class="math notranslate">\(\tensorbf{N}{(\bar{\nu})}\)</span> where;</p>
<div class="math notranslate">
\[\tensorbf{N}({\bar{\nu}})^{2} = {\tensorbs{\varepsilon}}({\bar{\nu}})\]</div>
<div class="math notranslate">
\[\tensorbf{N}\left( \bar{\nu} \right) = {\tensorbf{n}}\left( \bar{\nu} \right) + i{\tensorbs{\kappa}}\left( \bar{\nu} \right)\]</div>
<p>The intensity of absorption is given by the imaginary component of the refractive index which for an isotropic material is <a class="reference internal" href="theory.html#vandehulst1981" id="id16">[36]</a>;</p>
<div class="math notranslate">
\[\begin{split}I = I_{0}e^{- \frac{4\pi\kappa(\bar{\nu})d}{\lambda}} \\
I = I_{0}e^{- 4\pi\bar{\nu}\kappa(\bar{\nu})d}\end{split}\]</div>
<div class="math notranslate">
\[\begin{split}- ln\left( \frac{I}{I_{0}} \right) = 4\pi\bar{\nu}\kappa(\bar{\nu})d \\
- log\left( \frac{I}{I_{0}} \right) = 4\pi\bar{\nu}\kappa(\bar{\nu})d \cdot log(e)\end{split}\]</div>
<p>Comparison with the definition of the absorption coefficient from Beer-Lambert’s law, Equation <a class="reference internal" href="theory.html#equation-eq-beer1">(1)</a>, and using Equation <a class="reference internal" href="theory.html#equation-eq-molarabsorption">(10)</a> gives;</p>
<div class="math notranslate">
\[\alpha^{sol}(\bar{\nu}) = 4\pi\bar{\nu}\kappa(\bar{\nu}) log(e)\]</div>
<div class="math notranslate">
\[a^{sol}(\bar{\nu}) = \frac{\alpha^{\text{sol}}(\bar{\nu})}{C}\]</div>
<p>Since the refractive index is dimensionless, the absorption coefficient, <span class="math notranslate">\(\alpha^\text{sol}\)</span> is specified in cm<sup>-1</sup>. The superscripts ‘sol,’ for solid, and ‘mol,’ for molecular, are used here to distinguish between the two methods of calculating the absorption (<span class="math notranslate">\(\alpha\)</span>) and molar absorption coefficients (<span class="math notranslate">\(a\)</span>).  In the calculation of the imaginary component of the refractive index it is necessary to choose the solution which gives a positive value. This is consistent with the Kramers-Kronig relationship between the real and imaginary components <a class="reference internal" href="theory.html#wooten1972" id="id17">[35]</a>.</p>
<p>In order to calculate the relationship between absorption and molar absorption coefficients it is necessary to know the concentration. For solid state calculations the required unit is; moles of unit cells per litre. One of the drawbacks of this molar absorption coefficient unit is that the number of molecules in a unit cell can change depending on whether a supercell, primitive or non primitive unit cell is being used. A more natural unit would be to use a mole of formula units, or a mole of molecules. In order to aid comparison between such calculations PDielec is able to calculate concentration in both moles of atoms and moles of molecules. However for the rest of this paper Equation <a class="reference internal" href="theory.html#equation-eq-concentration">(17)</a> will be used, where <span class="math notranslate">\(V\)</span> is the volume of the unit cell, and therefore the concentration <span class="math notranslate">\(C\)</span> is moles of unit cell/litre.</p>
<div class="math notranslate">
\[C = \frac{f \cdot 1000cm^{3}}{VN_{a}}\]</div>
<p>The volume fraction, <span class="math notranslate">\(f\)</span>, of the dielectric material in a supporting matrix of non-absorbing material is included in the expression for the concentration as it will be useful when the theory for mixtures is developed.</p>
<p>For a periodic system the permittivity tensor can be calculated as a sum over Lorentz oscillators, incorporating an imaginary loss component through the damping factor <span class="math notranslate">\(\sigma_k\)</span> <a class="reference internal" href="theory.html#gonze1997" id="id18">[17]</a>.  The frequencies of the oscillators are the transverse optic (TO) phonon frequencies of the system.</p>
<div class="math notranslate">
\[{\tensorbs{\varepsilon}}(v) = {{\tensorbs{\varepsilon}}}_{\infty} + \frac{4\pi}{V}\sum_{k}\frac{{{\tensorbf{S}}}_{k}}{\nu_{k}^{2} - \nu^{2} - i\sigma_{k}\nu}\]</div>
<div class="math notranslate">
\[\tensorbf{S}_{k} = {\bar{\mathbf{Z}}}_{k}{\bar{\mathbf{Z}}}_{k}^\text{T}\]</div>
<div class="math notranslate">
\[\bar{\mathbf{Z}}_{k} =  \sum_{a}{\tensorbf{Z^{a}}}{\bar{\mathbf{U^{a}}}}_{k}\]</div>
<div class="math notranslate">
\[\begin{split}\tensorbf{D} {\bar{\mathbf{U}}}_{k} = \Lambda_{k}{\bar{\mathbf{U}}}_{k}\\
\nu_{k}^{2} = \Lambda_{k}\end{split}\]</div>
<div class="math notranslate">
\[I_{k} = tr\left( \tensorbf{S}_{k} \right)\]</div>
<p><span class="math notranslate">\(V\)</span> is the volume of the unit cell, <span class="math notranslate">\({\tensorbf{S}}_{k}\)</span> is the dipole oscillator strength tensor for the <span class="math notranslate">\(k_{th}\)</span>  transition, with a TO frequency of <span class="math notranslate">\(\nu_k\)</span> and <span class="math notranslate">\(\tensor{\varepsilon}_{\infty}\)</span> the optical permittivity tensor, which represents the electronic contribution to the permittivity. The intensity of a transition, <span class="math notranslate">\(I_k\)</span>, is given by the trace of the oscillator strength tensor, Equation <a class="reference internal" href="theory.html#equation-eq-intensity">(22)</a>.  The damping factor <span class="math notranslate">\(\sigma_{k}\)</span> removes any discontinuities at the TO frequencies. Since the oscillator strengths and phonon frequencies can be calculated routinely in solid state quantum mechanical packages, the calculation of the frequency dependent complex permittivity using Equation <a class="reference internal" href="theory.html#equation-eq-permittivity">(18)</a> is straightforward.</p>
<p>In some cases, using Equations <a class="reference internal" href="theory.html#equation-eq-oscillatorstrength">(19)</a> and <a class="reference internal" href="theory.html#equation-eq-borncharges">(20)</a>, PDielec calculates the oscillator strengths from the Born charge matrix for atom <span class="math notranslate">\(a\)</span> and its contributions to the <span class="math notranslate">\(k_{th}\)</span> phonon mode <a class="reference internal" href="theory.html#gonze1997" id="id19">[17]</a>.  As shown in Equation <a class="reference internal" href="theory.html#equation-eq-eigenvalues">(21)</a>, at the <span class="math notranslate">\(\Gamma\)</span> point the <span class="math notranslate">\(k_{th}\)</span> phonon mode is described by the eigenvector, <span class="math notranslate">\(\bar{\mathbf{U}}_{k},\)</span> and eigenvalue, <span class="math notranslate">\(\Lambda_{k}\)</span>, of the mass weighted, dynamical matrix, <span class="math notranslate">\(\tensorbf{D}\)</span>, which is a 3Nx3N matrix, where N is the number of atoms in the unit cell. The eigenvalues are the squared frequencies of the phonon modes, Equation <a class="reference internal" href="theory.html#equation-eq-eigenvalues">(21)</a>.  The displacement of each atom in the <span class="math notranslate">\(k_{th}\)</span> is proportional to <span class="math notranslate">\(m_{a}^{-1/2}\)</span>, where <span class="math notranslate">\(m_a\)</span> is the mass of atom <span class="math notranslate">\(a\)</span>. The dynamical matrix has 3N eigenvectors and eigenvalues, of which three should be zero due to translational invariance. If there are any negative eigenvalues the system is unstable to some displacement and therefore not at an energy minimum.</p>
<p>For ionic systems it is common practice in solid state QM and MM programs to include a long wave-length, non-analytic correction to the mass weighted dynamical matrix at the <span class="math notranslate">\(\Gamma\)</span> point, which describes the coupling of the longitudinal optic (LO) modes to the induced field resulting from the vibration. This may be written for atoms <span class="math notranslate">\(s\)</span> and <span class="math notranslate">\(t\)</span> and their Cartesian components <span class="math notranslate">\(\alpha\)</span> and <span class="math notranslate">\(\beta\)</span> as <a class="reference internal" href="theory.html#gonze1997" id="id20">[17]</a>;</p>
<div class="math notranslate">
\[\left( \tensorbf{D}^\text{LO}_{\mathbf{q \rightarrow 0}} \right)_{s,\alpha;t,\beta} = \left( \tensorbf{D} \right)_{s,\alpha;t,\beta}\mathbf{+}\frac{4\pi}{V\sqrt{M_{s}M_{t}}}\mathbf{\ }\frac{\left( {\bar{\mathbf{q}}}^{\text{T}}{{\mathbf{\ }\tensorbf{Z}}}_{s} \right)_{\alpha}\left( {\bar{\mathbf{q}}}^{\text{T}}{\tensorbf{Z}}_t \right)_\beta}{{\bar{\mathbf{q}}}^{\text{T}}\mathbf{\cdot}{{\tensorbs{\varepsilon}}}_{\infty} \cdot \bar{\mathbf{q}}}\]</div>
<p>The mass weighting has been incorporated through the mass of the atoms, <span class="math notranslate">\(M_s\)</span> and <span class="math notranslate">\(M_t\)</span>.  The correction depends upon the direction, <span class="math notranslate">\(\bar{\mathbf{q}}\)</span>, that the long wave-length limit is approached.  Diagonalisation of the corrected matrix gives the squared frequencies of N-1 LO modes and 2N-2 TO modes, Equation <a class="reference internal" href="theory.html#equation-eq-eigenvalues">(21)</a>.  In some of the examples given below the LO frequencies will be given for comparison with the TO frequencies.</p>
</div>
<div class="section" id="effect-of-particle-shape-on-infrared-absorption">
<h2>Effect of Particle Shape on Infrared Absorption<a class="headerlink" href="#effect-of-particle-shape-on-infrared-absorption" title="Permalink to this headline">¶</a></h2>
<p>It has long been recognised that, especially for ionic materials, the local field within a crystal and its coupling with the transverse optical phonons has an important effect on the position and intensity of the absorption. Fröhlich <a class="reference internal" href="theory.html#frohlich1948" id="id21">[11]</a> was one of the first to point out that the frequency of absorption of a small ionic sphere embedded in a low dielectric medium is shifted to lie between the transverse and longitudinal optical frequencies of the material making up the sphere.</p>
<p>In the development of the theory used in PDielec an important assumption is that the particle size of the crystallites in the sample is small compared with the wavelength of light.  Using this approach Genzel and Martin <a class="reference internal" href="theory.html#genzel1972a" id="id22">[13]</a> were able to explain the observed infrared absorption of small spheres of MgO crystallites and the effect of the permittivity of the supporting medium on the spectrum.  Studies of the infrared absorption by small particles of α-Fe<sub>2</sub>O<sub>3</sub> using an effective medium theory and an absorption/scattering theory <a class="reference internal" href="theory.html#serna1987" id="id23">[29]</a><a class="reference internal" href="theory.html#iglesias1990" id="id24">[19]</a> showed that in order to fit the experimental spectra it was necessary to adjust not only the damping factors in Equation <a class="reference internal" href="theory.html#equation-eq-permittivity">(18)</a> but also the permittivity of the matrix and the volume fraction of the dielectric medium. The latter was used to account for aggregation effects as the volume fraction increased. It was also shown that effective medium theories were only applicable for particles smaller than the wavelength of light. For larger particles the
scattering from the particles becomes increasingly important.</p>
<p>More recently Balan and others in a series of papers <a class="reference internal" href="theory.html#balan2010b" id="id25">[5]</a><a class="reference internal" href="theory.html#balan2008b" id="id26">[4]</a><a class="reference internal" href="theory.html#fourdrin2009" id="id27">[10]</a> used density functional calculations together with an effective medium theory to calculate the infrared absorption of several minerals incorporating information about the crystallite shape.  In an experimental and theoretical study of irradiated kaolinite  <a class="reference internal" href="theory.html#fourdrin2009" id="id28">[10]</a> it was shown that exposure to radiation resulted in shifts in the infrared spectrum which could be accounted for by increasing the polarisability of the particles through
an increase in the optical permittivity tensor.</p>
<p>The underlying theory adopted by PDielec is based on similar premises to the work described above, namely that the dielectric response of small spherical, ellipsoidal, slab-like or needle-like crystallites randomly distributed in a non-absorbing medium such as PTFE, KBr or Nujol, is the same as that of an effective medium material whose frequency dependent dielectric response can be calculated from the frequency dependent permittivity tensor of the crystal (as calculated by solid state QM or MM calculations), the shape of the crystallites and the permittivity of the non-absorbing medium (taken to be a constant over the frequency range of interest).</p>
<p>The development of the theory reported here closely follows the work of Sihvola <a class="reference internal" href="theory.html#sihvola" id="id29">[30]</a>.  It will be assumed that the inclusion particles, which may be non-isotropic, ellipsoidal (including spherical, needle-like and plate-like), are randomly orientated in an embedding, non-absorbing medium such as PTFE, KBr or Nujol. It should be emphasized that whilst PDielec can take account of particle shape, particle and matrix permittivity there are many additional aspects of infrared absorption which need to be considered when comparing calculated and experimental results. Most notable of these are; the coupling between phonons and mobile electrons or holes (so called phonon-polariton coupling) <a class="reference internal" href="theory.html#ruggiero2015" id="id30">[28]</a>, the scattering which starts to dominate as the particles get larger <a class="reference internal" href="theory.html#fourdrin2009" id="id31">[10]</a> and the agglomeration of particles as the volume fraction increases.</p>
<div class="section" id="the-polarisability-of-an-isolated-particle">
<h3>The polarisability of an isolated particle<a class="headerlink" href="#the-polarisability-of-an-isolated-particle" title="Permalink to this headline">¶</a></h3>
<p>Figure <a class="reference internal" href="theory.html#fig-polarisation"><span class="std std-ref">Schematic showing the various terms used to define the effective medium of an inclusion</span></a> shows a schematic of the field and polarisation inside an inclusion with non-isotropic permittivity <span class="math notranslate">\(\tensor{\varepsilon}_{i}\)</span> embedded in a supporting medium with permittivity, <span class="math notranslate">\(\varepsilon_e\)</span>.  The internal field within the inclusion is indicated by <span class="math notranslate">\(\fieldbf{E}_{i}\)</span> the external, applied field is indicated by <span class="math notranslate">\(\fieldbf{E}_{e}\)</span> and the induced polarisation in the inclusion is shown by <span class="math notranslate">\(\fieldbf{P}\)</span>.</p>
<div class="figure" id="id64">
<span id="fig-polarisation"></span><a class="reference internal image-reference" href="._static/Figures/Polarisation_Schematic.png"><img alt="._static/Figures/Polarisation_Schematic.png" src="._static/Figures/Polarisation_Schematic.png" /></a>
<p class="caption"><span class="caption-number">Fig. 1 </span><span class="caption-text">Schematic showing the various terms used to define the effective medium of an inclusion</span></p>
</div>
<p>The figure show the field and polarisation inside an inclusion with non-isotropic permittivity <span class="math notranslate">\({\tensorbf{\varepsilon}}_{i}\)</span> embedded in a supporting medium with permittivity <span class="math notranslate">\(\varepsilon_e\)</span>. The internal field within the inclusion is indicated by <span class="math notranslate">\(\fieldbf{E}_i\)</span>, the external, applied field is indicated by <span class="math notranslate">\(\fieldbf{E}_e\)</span> and the induced polarisation in the inclusion is shown by <span class="math notranslate">\(\fieldbf{P}\)</span></p>
<p>The electric field internal to the inclusion gives rise to a polarisation density which is no longer necessarily aligned with the field because the material is non-isotropic. The polarisation density in the inclusion can be expressed as the tensor product of the permittivity contrast between the inclusion and the supporting medium and the (as yet unknown) internal field.</p>
<div class="math notranslate">
\[\fieldbf{P} = \left( \tensorbs{\varepsilon}_{i} - \varepsilon_{e}{\tensorbf{1}} \right){\fieldbf{E}}_{i}\]</div>
<p>For any ellipsoidal shape (including sphere, slab and needle) with volume <em>V</em>, the polarisation density throughout the particle is uniform and integrating over all space gives the field induced dipole moment of the inclusion, <span class="math notranslate">\(\fieldbf{p}\)</span>.</p>
<div class="math notranslate">
\[\fieldbf{p} = V\fieldbf{P} = V\left( \tensorbs{\varepsilon}_{i} - \varepsilon_{e}\tensorbf{1} \right)\fieldbf{E}_{i}\]</div>
<p>The dipole and the external field, <span class="math notranslate">\({\fieldbf{E}}_{e}\)</span>, are related by the polarisability tensor, <span class="math notranslate">\(\tensorbs{\alpha}\)</span>.</p>
<div class="math notranslate">
\[\fieldbf{p} = \tensorbf{\alpha}\fieldbf{E}_{e}\]</div>
<p>Equations <a class="reference internal" href="theory.html#equation-eq-polar1">(25)</a> and <a class="reference internal" href="theory.html#equation-eq-polar2">(26)</a> allow the determination of the polarisability, once the field internal to the inclusion has been expressed in terms of the shape of the inclusion and its permittivity. The polarisation within the inclusion gives rise to a depolarisation field, <span class="math notranslate">\(\fieldbf{E}_{d}\)</span>, which depends on the shape of the inclusion through the symmetric and unit-trace depolarisation tensor, <span class="math notranslate">\(\tensorbf{L}\)</span>.</p>
<div class="math notranslate">
\[\fieldbf{E}_d = - \frac{1}{\varepsilon_e}\tensorbf{L} \cdot \fieldbf{P}\]</div>
<p>The internal field is the sum of the external field and the depolarisation field.</p>
<div class="math notranslate">
\[\fieldbf{E}_{i} = \fieldbf{E}_{e} + \fieldbf{E}_{d}\]</div>
<p>The depolarisation tensor acts as a projection or screening operator describing the effect of the geometry of the inclusion on the depolarisation field which results from its polarisation. For instance, in the case of a needle, only polarisation perpendicular to the needle axis contributes to the depolarizing field, whilst for a slab only polarization perpendicular to the slab face may contribute. Similarly for a sphere, all directions contribute and so the depolarisation matrix is diagonal with a value of 1/3 for each diagonal element, as the trace of the depolarisation tensor must be 1. It follows from Equations <a class="reference internal" href="theory.html#equation-eq-polarisationdensity">(24)</a>, <a class="reference internal" href="theory.html#equation-eq-depolarisationfield">(27)</a> and <a class="reference internal" href="theory.html#equation-eq-internalfield">(28)</a> that;</p>
<div class="math notranslate">
\[\fieldbf{E}_i = \fieldbf{E}_e - \frac{1}{\varepsilon_e} \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e{\tensorbf{1}} \right){\fieldbf{E}}_i\]</div>
<p>Rearrangement allows the internal field of the inclusion to be expressed in terms of the known permittivities, the shape of the inclusion and the external field.</p>
<div class="math notranslate">
\[\fieldbf{E}_i \left( \varepsilon_e{\tensorbf{1}} + \tensorbf{L}  \left( \tensorbs{\varepsilon}_i - \varepsilon_e{\tensorbf{1}} \right) \right) = \varepsilon_e\fieldbf{E}_e\]</div>
<div class="math notranslate">
\[\fieldbf{E}_i = \varepsilon_e{\fieldbf{E}}_e\left( \varepsilon_e\tensorbf{1} + \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e \tensorbf{1} \right) \right)^{- 1}\]</div>
<p>Substituting the internal field expression, <a class="reference internal" href="theory.html#equation-eq-internalfield2">(29)</a>, into Equation <a class="reference internal" href="theory.html#equation-eq-polar1">(25)</a> for the dipole moment and requiring the dipole moments calculated using the polarisation density to equal those calculated from the polarisability allows the polarisability to be written;</p>
<div class="math notranslate">
\[\tensorbs{\alpha} = V\varepsilon_e\left( \tensorbs{\varepsilon}_i - \varepsilon_e\tensor{1} \right)\left( \varepsilon_e\tensorbf{1} + \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e\tensorbf{1} \right) \right)^{- 1}\]</div>
<p>Although it has not been specified explicitly the permittivity of the inclusion, and therefore the polarisability tensor, are frequency dependent through the oscillator strengths of each phonon mode contributing to the permittivity according to Equation <a class="reference internal" href="theory.html#equation-eq-permittivity">(18)</a>.  The calculation of the complex, frequency dependent polarisability tensor of the composite material is the key step in the calculation of its effective permittivity.</p>
</div>
<div class="section" id="the-effective-permittivity-of-a-mixture">
<h3>The Effective permittivity of a mixture<a class="headerlink" href="#the-effective-permittivity-of-a-mixture" title="Permalink to this headline">¶</a></h3>
<p>To extend this approach to include the effect of a number of inclusions
we need to introduce the concept of an effective permittivity, <span class="math notranslate">\(\tensorbf{\varepsilon}_{eff}\)</span>, which describes the behaviour of an average field, <span class="math notranslate">\(\left\langle \fieldbf{E} \right\rangle\)</span>, where the angle brackets indicate an average over a volume of the composite material. It is required that the average electric flux density <span class="math notranslate">\(\left\langle \fieldbf{D} \right\rangle\)</span> is the same in the effective medium as in the composite medium;</p>
<div class="math notranslate">
\[\left\langle \fieldbf{D} \right\rangle = \tensorbs{\varepsilon}_{eff}\left\langle \fieldbf{E} \right\rangle = \varepsilon_e\left\langle \fieldbf{E} \right\rangle + \left\langle \fieldbf{P} \right\rangle\]</div>
<p>The averaging is necessary because the polarisation within a given inclusion has an effect on the field in other inclusions. The local field in the cavity left by a single inclusion embedded in the average polarisation field is given by;</p>
<div class="math notranslate">
\[\fieldbf{E}_L = \left\langle \fieldbf{E} \right\rangle + \frac{1}{\varepsilon_e}\tensorbf{L}\left\langle \fieldbf{P} \right\rangle\]</div>
<p>The local field ‘excites’ the inclusion resulting in a dipole moment <span class="math notranslate">\(\mathbf{p}_{mix}\)</span> that is related to the polarisation through the number density of inclusions, <span class="math notranslate">\(n\)</span>, and through the polarisability of the inclusion, which is already known from Equation <a class="reference internal" href="theory.html#equation-eq-polarisation">(32)</a>.</p>
<div class="math notranslate">
\[\left\langle \fieldbf{P} \right\rangle = n{\fieldbf{p}}_{mix} = n\left\langle \tensorbs{\alpha}\fieldbf{E}_{L} \right\rangle\]</div>
<p>The angle brackets around the product of the polarisability and the local field indicate that it is necessary to average the polarisation according to the distribution of alignments of inclusions. In this work it will be assumed that the inclusions are randomly aligned.  Substituting the expression for the local field, Equation <a class="reference internal" href="theory.html#equation-eq-localfield">(34)</a>, gives;</p>
<div class="math notranslate">
\[\left\langle \fieldbf{P} \right\rangle = \left( \tensorbf{1}
- \frac{n\left\langle \tensorbf{\alpha}\tensorbf{L} \right\rangle} {\varepsilon_e} \right)^{- 1}
n\left\langle \tensorbs{\alpha} \right\rangle\left\langle \tensorbf{E} \right\rangle\]</div>
</div>
<div class="section" id="mixing-rules">
<h3>Mixing rules<a class="headerlink" href="#mixing-rules" title="Permalink to this headline">¶</a></h3>
<p>There are many mixing rules which have been proposed to describe the homogenization of composite materials and a lot of work has been done in comparing their accuracy. Here two methods will be used. The first and the most commonly used method is the Maxwell-Garnett mixing rule <a class="reference internal" href="theory.html#sihvola" id="id32">[30]</a>.  Indeed this has been implied by the use of Equation <a class="reference internal" href="theory.html#equation-eq-averagefluxdensity">(33)</a> to define the effective permittivity. The other commonly used method is the Bruggeman mixing rule <a class="reference internal" href="theory.html#sihvola" id="id33">[30]</a>, which differs substantially in the way the two components of the system are treated. It is usually stated that the Maxwell-Garnet mixing rule is good for low volume fractions of the inclusion and the Bruggeman approach should be better for higher volume fractions <a class="reference internal" href="theory.html#giordano2003a" id="id34">[15]</a>.  In addition to these mixing rules one other approach will be described, namely the Averaged Permittivity (AP) mixing rule, which calculates the absorption spectrum ignoring the effects of the internal field on the absorption and can therefore be used as an indicator of the shifts in frequency and intensity which have occurred owing to the effect of particle shape.</p>
</div>
<div class="section" id="maxwell-garnett-mixing-rule">
<h3>Maxwell-Garnett mixing rule<a class="headerlink" href="#maxwell-garnett-mixing-rule" title="Permalink to this headline">¶</a></h3>
<p>The Maxwell-Garnett approach for treating the properties of heterogeneous mixtures assumes that the average field and the average flux density result from volume fraction weighted sums. Substituting Equation <a class="reference internal" href="theory.html#equation-eq-averagepolarisation">(36)</a> into Equation <a class="reference internal" href="theory.html#equation-eq-averagefluxdensity">(33)</a> gives the Maxwell-Garnett effective permittivity;</p>
<div class="math notranslate">
\[\tensorbs{\varepsilon}_{mg} = \tensorbf{1} + \left( \tensorbf{1} - \frac{n\left\langle {\tensorbs{\alpha}}{\tensorbf{L}} \right\rangle}{\varepsilon_e} \right)^{- 1}n\left\langle \tensorbs{\alpha} \right\rangle\]</div>
<p>The fact that the polarisability tensor has a volume term in it (Equation <a class="reference internal" href="theory.html#equation-eq-polarisation">(32)</a>) means that the terms in Equation <a class="reference internal" href="theory.html#equation-eq-mg">(37)</a> containing <span class="math notranslate">\(n\tensorbs{\alpha}\)</span> depend on the volume fraction <span class="math notranslate">\(f\)</span>. Although written as a tensor, because the assumption has been made that the inclusions are randomly orientated, the effective permittivity has to be diagonal with equal complex values. Since the polarisability is complex and frequency dependent the effective permittivity is also and its calculation using Equations <a class="reference internal" href="theory.html#equation-eq-mg">(37)</a> and <a class="reference internal" href="theory.html#equation-eq-polarisation">(32)</a> need to be calculated over the frequency range of interest.</p>
</div>
<div class="section" id="bruggeman-mixing-rule">
<h3>Bruggeman mixing rule<a class="headerlink" href="#bruggeman-mixing-rule" title="Permalink to this headline">¶</a></h3>
<p>In the Maxwell-Garnett mixing formalism there is a distinction between the inclusion and the supporting medium which results in an asymmetry in the treatment of the two species in the mixture. Instead the Bruggeman mixing rule assumes that each species is polarized against the background of the effective medium and therefore the polarisation in the two components cancel each other out;</p>
<div class="math notranslate">
\[\left\langle \fieldbf{P}_1 \right\rangle + \left\langle \fieldbf{P}_2 \right\rangle = 0\\]</div>
<p>where the components are now labeled 1 and 2 rather than external and internal. The polarisation for species 1 and 2 with a number density of species represented by <span class="math notranslate">\(n_1\)</span>  and <span class="math notranslate">\(n_2\)</span> can be obtained from the polarisability of the species (Equation <a class="reference internal" href="theory.html#equation-eq-equalpolarisation">(38)</a>);</p>
<div class="math notranslate">
\[\left\langle \fieldbf{P}_1 \right\rangle = n_1 \left\langle \tensorbs{\alpha}_1 \right\rangle\fieldbf{E}\]</div>
<p>Substituting Equation <a class="reference internal" href="theory.html#equation-eq-polarisation1">(39)</a> into Equation <a class="reference internal" href="theory.html#equation-eq-equalpolarisation">(38)</a> leads to the requirement that;</p>
<div class="math notranslate">
\[n_1\left\langle \tensorbs{\alpha}_1 \right\rangle + n_2\left\langle \tensorbs{\alpha}_2 \right\rangle = 0\]</div>
<p>Taking Equation 19 and generalizing it for species <span class="math notranslate">\(i\)</span>, (where <span class="math notranslate">\(i\)</span> is 1 or 2) embedded in an effective permittivity given by <span class="math notranslate">\(\tensorbs{\varepsilon}_{br}\)</span>;</p>
<div class="math notranslate">
\[\tensorbs{\alpha}_i = V_i \tensorbs{\varepsilon}_{br} \left( \tensorbs{\varepsilon}_i - \tensorbs{\varepsilon}_{br} \right)
\left( \tensorbs{\varepsilon}_{br} + \tensorbf{L} \left( \tensorbs{\varepsilon}_i - \tensorbs{\varepsilon}_{br} \right) \right)^{- 1}\]</div>
<p>Equation <a class="reference internal" href="theory.html#equation-eq-bruggemanpolarisability1">(40)</a> has to be solved for:math:<cite>tensorbs{varepsilon}_{br}</cite>. Since the systems considered here are isotropic with random inclusions, a solution has to be found for a complex value of the Bruggeman permittivity at each frequency considered.  An issue in the use of Equation <a class="reference internal" href="theory.html#equation-eq-bruggemanpolarisability2">(41)</a> is that the same depolarisation matrix is being used for both species, which is clearly not always appropriate. The solution of Equation <a class="reference internal" href="theory.html#equation-eq-bruggemanpolarisability1">(40)</a> can be achieved either by iteration or by casting the equation as a minimization problem. The iterative approach implemented in PDielec involves repeated application of Equation 29 until convergence <a class="reference internal" href="theory.html#mackay2009" id="id35">[24]</a>.  The starting point for the iterations is taken as the Maxwell-Garnett solution for the first frequency and then the solution at the previous
frequency is used to start the iterations.</p>
<div class="math notranslate">
\[\tensorbs{\varepsilon}_{br} = \frac{f_1{ {\tensorbs{\varepsilon}}}_1\left\lbrack {\tensorbf{1}} + {\tensorbf{L}}\left( {\tensorbs{\varepsilon}}_1 - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1} +
f_2\tensorbs{\varepsilon}_2\left\lbrack \tensorbf{1} + \tensorbf{L}\left( \tensorbs{\varepsilon}_{2} - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1}}
{f_{1}\left\lbrack \tensorbf{1} +{\tensorbf{L}}\left( \tensorbf{\varepsilon}_1 - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1} +
f_{2}\left\lbrack \tensorbf{1} + \tensorbf{L}\left( \tensorbs{\varepsilon}_2 - \tensorbs{\varepsilon}_{br} \right) \right\rbrack^{- 1}}\]</div>
<p>Although the Bruggeman permittivity is written here as a tensor, the polarisabilities in Equation <a class="reference internal" href="theory.html#equation-eq-bruggemanpolarisability1">(40)</a> have to be averaged over the random orientation of the inclusions and therefore the homogenized material is isotropic with a single complex value for the diagonal tensor.  Also, as with the Maxwell-Garnett mixing rule, since the polarisability is complex and frequency dependent, the effective permittivity is also, and its calculation using Equation <a class="reference internal" href="theory.html#equation-eq-mg">(37)</a> needs to be performed over the frequency range of interest.</p>
<p>The choice between using the Bruggeman or Maxwell-Garnett model is often governed by the assumption that the Maxwell-Garnett model works well at low concentrations and the Bruggeman model works better at higher concentrations. Work by Karkkainen <em>et al</em>. using a finite difference method for random mixtures of non-absorbing materials indicated that the Bruggeman approximation works best when there is some clustering of the inclusions and the Maxwell Garnett model works best when there is no clustering <a class="reference internal" href="theory.html#karkkainen2001" id="id36">[22]</a>.</p>
<p>The Bruggeman solution has been shown to be unphysical in certain circumstances <a class="reference internal" href="theory.html#jamaian2010" id="id37">[20]</a>.  In particular when the real components of the permittivity have different signs and when the absolute values of the real components are much larger than those of the imaginary components. Unfortunately, it may be that these conditions will apply to modelling infrared absorption. As a result only a few of the examples discussed below will include results using the Bruggeman mixing rule; the majority will use the Maxwell-Garnett mixing rule.</p>
</div>
<div class="section" id="averaged-permittivity-mixing-rule">
<h3>Averaged-Permittivity mixing rule<a class="headerlink" href="#averaged-permittivity-mixing-rule" title="Permalink to this headline">¶</a></h3>
<p>It is useful to be able to compare the effective medium theories with the absorption predicted using no shape information, that is using only the TO frequencies.</p>
<div class="math notranslate">
\[\tensorbs{\varepsilon}_{TO} = f\left\langle \tensorbs{\varepsilon}_i \right\rangle + \left( 1 - f \right)\varepsilon_e\]</div>
<p>Equation <a class="reference internal" href="theory.html#equation-eq-ap">(43)</a> defines an isotropic permittivity which can be used to calculate such an absorption coefficient. The angle brackets indicate an average of orientation. This mixing rule provides a useful comparison between the absorption calculated without any shape effects and that calculated including shape effects using the other mixing rules presented above. At low concentrations the peak positions of the AP mixing rule will be at the TO frequencies.</p>
</div>
</div>
<div class="section" id="particle-size-effects">
<h2>Particle Size Effects<a class="headerlink" href="#particle-size-effects" title="Permalink to this headline">¶</a></h2>
<p>Meier and Wokaun <a class="reference internal" href="theory.html#meier1983" id="id38">[25]</a> outlined an approach to treating large (metal) spherical particles, where particle size is incorporating terms up to 3^rd^ order in the wave vector <em>k</em>. Using Equations <a class="reference internal" href="theory.html#equation-eq-polarisationdensity">(24)</a> and <a class="reference internal" href="theory.html#equation-eq-internalfield">(28)</a> we can write;</p>
<div class="math notranslate">
\[\fieldbf{P} = \left( \tensorbs{\varepsilon}_i - \varepsilon_e \tensorbf{1} \right)\left( \fieldbf{E}_e + \fieldbf{E}_d \right)\]</div>
<div class="math notranslate">
\[\begin{split}\begin{aligned}
\fieldbf{E}_d &amp;= - \frac{\left( 1 - x^2 - i\frac{2}{3}x^3 \right)}{\varepsilon_e}{\tensorbf{L}} \fieldbf{P} \\
x &amp;= ak = \frac{2\pi a}{\lambda}
\end{aligned}\end{split}\]</div>
<p>Here <span class="math notranslate">\(a\)</span> is the radius of thespherical particle and <span class="math notranslate">\(x\)</span> is the dimensionless ‘size’ of the particle with respect to the wavelength of the incident light. The first term relating the depolarisation field to the polarisability is the same as that used above in Equation <a class="reference internal" href="theory.html#equation-eq-depolarisationfield">(27)</a>. The second term is a dynamic depolarisation term and the third term is a radiation damping correction to the electrostatic solution <a class="reference internal" href="theory.html#meier1983" id="id39">[25]</a>.</p>
<p>A slightly different, but related, approach is presented by <a class="reference internal" href="theory.html#sihvola" id="id40">[30]</a>.  Starting from Equation <a class="reference internal" href="theory.html#equation-eq-internalfield2">(29)</a>, a size dependent term <span class="math notranslate">\(G(x)\)</span> is introduced as indicated by the work of Peltoniemi <a class="reference internal" href="theory.html#peltoniemi1996" id="id41">[26]</a>;</p>
<div class="math notranslate">
\[\begin{split}\begin{aligned}
G\left( x \right) &amp;= G_1\left( x \right) + G_2\left( x \right) \\
G_{1}\left( x \right) &amp;= \ \frac{2}{3}\left\lbrack \left( 1 + ix\right)e^{- ix} - 1 \right\rbrack \\
G_{2}\left( x \right) &amp;= \ \left ( 1 + ix - \frac{7}{15}x^{2} - i\frac{2}{15}x^{3} \right)e^{- ix}-1
\end{aligned}\end{split}\]</div>
<p>The modified equation for the relationship between the internal field and the external field based on equation <a class="reference internal" href="theory.html#equation-eq-internalfield2">(29)</a> becomes;</p>
<div class="math notranslate">
\[\fieldbf{E}_i = \fieldbf{E}_e - \frac{\left( 1 - G\left( x \right) \right)}{\varepsilon_e}\tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_e\tensorbf{ 1} \right)\fieldbf{E}_i\]</div>
<p>This leads to a modified equation for the polarisability of spherical particles;</p>
<div class="math notranslate">
\[\tensorbs{\alpha}\left( x \right) = V\varepsilon_e\left( \tensorbs{\varepsilon}_i -
\varepsilon_e\tensorbf{1} \right)\left( \varepsilon_e\mathbf{1} +
\left( 1 - G\left( x\right) \right)\tensorbf{L} \left( \tensorbs{\varepsilon}_i - \varepsilon_{e}\mathbf{1} \right) \right)^{- 1}\]</div>
<p>Using the modified, sized dependent polarisability all the Bruggeman and Maxwell mixing schemes can be implemented in a way that incorporates size effects.  Generally speaking the on-set of changes in the calculated absorption is an indication that size effects are important and should be treated properly.</p>
</div>
<div class="section" id="light-scattering-by-spherical-particles-using-mie-theory">
<h2>Light Scattering by Spherical Particles using Mie Theory<a class="headerlink" href="#light-scattering-by-spherical-particles-using-mie-theory" title="Permalink to this headline">¶</a></h2>
<p>For particles which are comparable in size to the wavelength of light, the theory developed by Mie and described fully by van de Hulst <a class="reference internal" href="theory.html#vandehulst1981" id="id42">[36]</a> can be used. Unfortunately this theory is only applicable to spherical, isotropic particles where the separation between the particles is large compared with the wavelength of light.</p>
<p>PDielec implements a form of Mie theory using the Python library PyMieScatt <a class="reference internal" href="theory.html#sumlin2018a" id="id43">[32]</a>. In order to treat systems which are anisotropic, PDielec first of all transforms the real component of the permittivity so that the tensor is diagonal. Then the full  permittivity (real and imaginary) is transformed to this basis.</p>
<div class="math notranslate">
\[\begin{split}\begin{aligned}
&amp; {\tensorbf{U}^{\text{T}}} \tensorbs{\varepsilon}^{real} \tensorbf{U} = \tensorbs{\varepsilon}^{diagonal} \\
&amp; {\tensorbs{\varepsilon}}^{new} = \tensorbf{U}^\text{T} \tensorbs{\varepsilon}^{full}\tensorbf{U}
\end{aligned}\end{split}\]</div>
<p>The core of Mie theory is the calculation of efficiency factors S1(θ) and S2(θ) (page 125 in reference <a class="reference internal" href="theory.html#vandehulst1981" id="id44">[36]</a>.  These factors depend upon the size of the particle with relative to the wavelength of the light (<span class="math notranslate">\(x\)</span>) and the refractive index of infrared active material (<span class="math notranslate">\(m_1\)</span>) relative to that of the supporting medium (<span class="math notranslate">\(m_2\)</span>). Both refractive indices are scalars, <span class="math notranslate">\(m_1\)</span> is complex as light is absorbed by the material and <span class="math notranslate">\(m_2\)</span> is assumed to be real.</p>
<p>For each of the three diagonal elements of <span class="math notranslate">\(\tensorbs{\varepsilon}_{new}\)</span> the relative refractive index, <span class="math notranslate">\(m\)</span> is calculated;</p>
<div class="math notranslate">
\[\begin{split}\begin{aligned}
m_1 &amp;= \tensorbs{\varepsilon}_{w,w}^{new} \\
m &amp;= \frac{m_{1}}{m_{2}} \\
x &amp;= \frac{2\pi a}{\lambda} \\
\lambda &amp;= \frac{\lambda_{\text{ vac}}}{m_{2}}
\end{aligned}\end{split}\]</div>
<p>The size parameter depends upon the refractive index of the supporting medium because the wavelength of light is smaller than its vacuum value in a medium with a refractive index greater than one. The subscript <span class="math notranslate">\(w\)</span> indicates one of the three directions x, y or z in the basis which diagonalises the real permittivity tensor.</p>
<p>Using the routines available in PyMieScatt <a class="reference internal" href="theory.html#sumlin2018a" id="id45">[32]</a> the efficiency factor <span class="math notranslate">\(S(0)\)</span>, where <span class="math notranslate">\(S(0) = S1(0) = S2(0)\)</span>, is calculated from <span class="math notranslate">\(m\)</span> and <span class="math notranslate">\(x\)</span>. The extinction (this includes absorption and scattering) along with retardation are reflected in the overall complex refractive index, page 129 in reference <a class="reference internal" href="theory.html#vandehulst1981" id="id46">[36]</a>;</p>
<div class="math notranslate">
\[\begin{split}\begin{aligned}
\widetilde{m}_w &amp;= m_2\left( 1 - iS\left( 0 \right)2\pi Nk^{- 3} \right) \\
N &amp;= \frac{f}{V_{sphere}}  \\
V_{sphere} &amp;= \frac{4}{3} \pi a^{3} \\
k &amp;= \frac{2\pi}{\lambda}
\end{aligned}\end{split}\]</div>
<p>Here <span class="math notranslate">\(N\)</span> is the number density of particles and <span class="math notranslate">\(k\)</span> is the wave-vector of the light in the surrounding medium. The subscript <span class="math notranslate">\(w\)</span> indicates that there are three values for the effective refractive index, depending on which diagonal value of the permittivity tensor is taken. Once the effective refractive index is known in each direction the effective permittivity can be calculated using the one third rule <a class="reference internal" href="theory.html#stout2007" id="id47">[31]</a>;</p>
<div class="math notranslate">
\[\begin{split}\begin{aligned}
\widetilde{m}_{eff} &amp;=  \frac{1}{3}\sum_w{\widetilde{m}}_w \\
\varepsilon_{eff} &amp;= \widetilde{m}_{eff}^2
\end{aligned}\end{split}\]</div>
<p>This approach to taking anisotropy into account when the embedded particles are anisotropic but randomly oriented is approximate, but has been shown to have a reasonably wide range of application <a class="reference internal" href="theory.html#stout2007" id="id48">[31]</a>.</p>
</div>
</div>
<div class="section" id="implementation">
<h1>IMPLEMENTATION<a class="headerlink" href="#implementation" title="Permalink to this headline">¶</a></h1>
<p>The above theory has been implemented in a Python 2/3 package which is available for download <a class="reference internal" href="theory.html#pdielec" id="id49">[23]</a>. The package requires SCIPY <a class="reference internal" href="theory.html#scipy" id="id50">[2]</a>, NUMPY <a class="reference internal" href="theory.html#scipy" id="id51">[2]</a>, PyYAML (py-yaml) <a class="reference internal" href="theory.html#pyyaml" id="id52">[1]</a>, PyMieScatt <a class="reference internal" href="theory.html#sumlin2018a" id="id53">[32]</a>, xlswriter <a class="reference internal" href="theory.html#xlsxwriter" id="id54">[3]</a> and if visualization of the predicted spectra is required MATPLOTLIB <a class="reference internal" href="theory.html#scipy" id="id55">[2]</a>. The program is run from the command line. There are several command options and these are summarized below in Table 1. At the moment the package has interfaces to five solid state QM codes, VASP <a class="reference internal" href="theory.html#hafner2008c" id="id56">[18]</a>, CASTEP <a class="reference internal" href="theory.html#clark2005d" id="id57">[8]</a>, CRYSTAL14 <a class="reference internal" href="theory.html#dovesi2014" id="id58">[9]</a>, Abinit <a class="reference internal" href="theory.html#gonze2016" id="id59">[16]</a>, Quantum Espresso <a class="reference internal" href="theory.html#giannozzi2009" id="id60">[14]</a> and Phonopy <a class="reference internal" href="theory.html#togo2015" id="id61">[33]</a>.  In addition an interface is available for GULP <a class="reference internal" href="theory.html#gale2003" id="id62">[12]</a> which is a force field based solid state code. Finally an interface has been written to and ‘experiment’ file format which allows the preparation of a user defined file specifying the permittivities and absorption frequencies. The origin of the dataset(s) used for processing is determined by a command line switch, -program. An outline of the interfaces to these codes is given here. The package used for the calculation is described by the –program option. In addition a file name is given which contains the output which will be processed by PDielec.</p>
<div class="section" id="vasp">
<h2>VASP<a class="headerlink" href="#vasp" title="Permalink to this headline">¶</a></h2>
<p>The name provided on the command line is an OUTCAR file. The OUTCAR is read by PDielec to determine the unit cell, atomic masses, frequencies, normal modes, Born charge tensors and optical permittivity. The VASP run can be a DFPT or numerical calculation of the response.</p>
</div>
<div class="section" id="castep">
<h2>CASTEP<a class="headerlink" href="#castep" title="Permalink to this headline">¶</a></h2>
<p>The name provided on the command line is the seedname for the calculation. The corresponding seedname.castep file in the current directory is read and processed to determine the unit cell, atomic masses, optical permittivity and born charge tensors. The normal modes and their frequencies are determined from the seedname.phonon file. The CASTEP run needs to be a DFPT (phonon+efield) task.</p>
</div>
<div class="section" id="crystal">
<h2>CRYSTAL<a class="headerlink" href="#crystal" title="Permalink to this headline">¶</a></h2>
<p>The name on the command line is a file ending in .out, containing the output of a CRYSTAL14 run. The contents of this file alone are sufficient to provide the unit cell, atomic masses, frequencies, normal modes and Born charge tensors. However, the number of significant figures for the normal modes is not sufficient for an accurate calculation and it is therefore recommended that the HESSFREQ.DAT and BORN.DAT files are also made available. If they are present in the directory where PDielec is run from , it uses these files to calculate the Born charge tensors, frequencies and normal modes. The CRYSTAL calculation needs to be a frequency calculation (FREQCALC) with the infrared intensity (INTENS) selected. The default algorithm does not calculate the optical permittivity, so this needs to be provided on the command line. However, if the CPHF or CPKS algorithm is used for the frequency calculation, the optical permittivity is calculated and PDielec will automatically read it from the output file. By default CRYSTAL projects out the pure translational modes of the system before calculating the frequencies, this can also done by the PDielec package. Small differences in the calculated frequencies between the CRYSTAL program and PDielec have been observed. These have been found to be due to a slightly different method for symmetrising the 2^nd^ derivative matrix, because of this an optional directive “-hessian crystal” can be used to indicate that PDielec should use the same symmetrisation as CRYSTAL14.</p>
</div>
<div class="section" id="abinit">
<h2>ABINIT<a class="headerlink" href="#abinit" title="Permalink to this headline">¶</a></h2>
<p>The output file should come from a run containing three datasets. One to calculate the wavefunction at the optimized geometry, one to calculate the field perturbations and one to calculate the second derivatives. Examples of input files and output files are available with the distribution.</p>
</div>
<div class="section" id="qe">
<h2>QE<a class="headerlink" href="#qe" title="Permalink to this headline">¶</a></h2>
<p>The output file is the dynamical matrix file, specified by “filedyn” in a run of the quantum espresso phonon package. Examples of input and output files are given in the PDielec distribution</p>
</div>
<div class="section" id="phonopy">
<h2>PHONOPY<a class="headerlink" href="#phonopy" title="Permalink to this headline">¶</a></h2>
<p>Phonopy calculates the dynamical matrix through numerical differentiation. It has interfaces to several programs, although PDielec has only used the VASP interface. In principle other interfaces could be used. The second parameter for the –program directive is the PHONOPY interface that was used to calculate the forces. Typically these would be generated by performing;</p>
<blockquote>
<div>phonopy –d –dim=”1 1 1”</div></blockquote>
<p>to calculate the displacements in a set of POSCAR-* files. After running VASP a single point VASP calculation for each displacement. The FORCE_SETS file can then be calculated using for example;</p>
<blockquote>
<div>phonopy –f DISP-*/vasprun.xml</div></blockquote>
<p>where the DISP-* directories are where the VASP calculation was performed. Finally a dynamical is written out using;</p>
<blockquote>
<div>phonopy –dim=”1 1 1” –qpoints=”0 0 0” –writedm</div></blockquote>
<p>To calculate the infrared spectrum PDielec needs the Born charges for the atoms in the unit cell and these can be calculated using VASP and the optimized geometry of the unit cell. The OUTCAR file from this calculation can be copied to the current directory and renamed OUTCAR.born</p>
</div>
<div class="section" id="gulp">
<h2>GULP<a class="headerlink" href="#gulp" title="Permalink to this headline">¶</a></h2>
<p>The name on the command line is a file ending in .gout, containing the output of a GULP run. The contents of this file alone are sufficient to provide the unit cell, atomic masses, frequencies, normal modes, Born charge tensors and optical permittivity. Because GULP only writes out the Born charge matrices for the asymmetric unit, it is necessary to run a frequency calculation using P1 symmetry and a complete unit cell. The key words; nosymm, phonon, intensity, eigen and cart are recommended for the GULP calculation. In the case that no shells are used in the calculation the optical permittivity is not available in the output and it is necessary to provide it on the command line (see -optical and -optical_tensor options below).</p>
</div>
<div class="section" id="experiment">
<h2>EXPERIMENT<a class="headerlink" href="#experiment" title="Permalink to this headline">¶</a></h2>
<p>This option has been added to allow the exploration of ‘toy’ problems. The file contains a minimum amount of data to allow a calculation to proceed. It is assumed that the systems will be isotropic as that make the input simpler. Calculations of the LO frequencies will not work with this option. An example input file is given here, which gives results very similar to that found for the Castep, MgO example;:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">species</span> <span class="mi">2</span> <span class="c1"># Define the atomic species, followed by the number of species</span>
<span class="n">O</span> <span class="mf">16.0</span>    <span class="c1"># Species name followed by its mass</span>
<span class="n">Mg</span> <span class="mf">24.3</span>
<span class="n">lattice</span> <span class="mf">2.12346</span> <span class="c1"># Define the lattice, the parameter is a scaling factor</span>
<span class="mi">1</span> <span class="mi">1</span> <span class="mi">0</span>           <span class="c1"># The a vector</span>
<span class="mi">1</span> <span class="mi">0</span> <span class="mi">1</span>           <span class="c1"># The b vector</span>
<span class="mi">0</span> <span class="mi">1</span> <span class="mi">1</span>           <span class="c1"># The c vector</span>
<span class="n">unitcell</span> <span class="mi">2</span>      <span class="c1"># Define the unit cell contents and fractional coordinates</span>
<span class="n">O</span> <span class="mf">0.5</span> <span class="mf">0.5</span> <span class="mf">0.5</span>   <span class="c1"># Species fraca, fracb, fracc</span>
<span class="n">Mg</span> <span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">0.0</span>  <span class="c1"># Species fraca, fracb, fracc</span>
<span class="n">static</span>          <span class="c1"># Define the static permittivity</span>
<span class="mf">3.13969</span> <span class="mf">0.0</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">3.13969</span> <span class="mf">0.0</span>
<span class="mf">0.0</span> <span class="mf">0.0</span> <span class="mf">3.13969</span>
<span class="n">frequencies</span> <span class="mi">3</span>       <span class="c1"># Specify how many frequencies to read in</span>
<span class="mf">388.282</span> <span class="mf">0.000073639</span> <span class="c1"># The frequency in wavenumbers and oscillator strength</span>
<span class="mf">388.282</span> <span class="mf">0.000073639</span>
<span class="mf">388.282</span> <span class="mf">0.000073639</span>
</pre></div>
</div>
<p>Examples of data sets for these packages are included with the distribution. The interface to these QM and MM codes reads information about the unit cell, the calculated normal modes and the Born charge matrices; from these the permittivity is calculated over the frequency range requested. The absorption and molar absorption coefficients can be plotted along with the real and imaginary permittivities. Optionally all the information can be written to a comma separated values (csv) file for direct importing into a spreadsheet. The program is run from the command line. There are several command options and these are summarized below. Some of the options may be repeated. The package needs a shape to be specified (sphere, needle, plate or ellipse). If no shape is specified on the command line a sphere is assumed.</p>
</div>
<div class="section" id="program-options">
<h2>Program Options<a class="headerlink" href="#program-options" title="Permalink to this headline">¶</a></h2>
<p>The program options are summarised below, a ✔ indicates that the option can be specified more than once.  Where there is a default value, it value is shown.</p>
<blockquote>
<div><dl class="docutils">
<dt>-program program</dt>
<dd>Program can be “abinit”,  “castep”, “crystal”, “gulp”, “qe”, “experiment” or “vasp” and specifies the program which generated the results to be analysed.</dd>
<dt>-method maxwell (✔)</dt>
<dd>The method is given by the string and is either ‘ap’, ‘maxwell’, ‘bruggeman’ or ‘mie’.</dd>
<dt>-sphere (✔)</dt>
<dd>The inclusion is a sphere, the default if no other shape is given.</dd>
<dt>-needle h k l (✔)</dt>
<dd>The inclusion is a needle whose unique directionis given by the direction [hkl].</dd>
<dt>-plate h k l (✔)</dt>
<dd>The inclusion is a plate whose  surface is defined by the Miller indices (hkl).   Note that needles and ellipsoid use  directions in crystal coordinates defined by [hkl].   For non-orthogonal lattices the normal to  the (hkl) is not necessarily the same as [hkl].</dd>
<dt>-ellipse h k l z (✔)</dt>
<dd>The inclusion is an ellipsoid, whose  unique direction is given by [hkl],  z  specifies the eccentricity of the ellipsoid.</dd>
<dt>-vf 0.1 (✔)</dt>
<dd>Specifies the volume fraction of inclusion.</dd>
<dt>-mf 0.0 (✔)</dt>
<dd>Specifies a mass fraction from  which the volume fraction is calculated.   The calculation requires the density of the supporting matrix.</dd>
<dt>-matrix ptfe</dt>
<dd>The supporting matrix is defined by  the string.  Options are “ptfe”, “kbr”,  “ujol”, “air”, “vacuum”, “ldpe”, “mdpe”, “hdpe”.  If the matrix is given in this way both the  density and the permittivity of the supporting matrix are defined.  Alternatively the density and dielectric  options can be used.</dd>
<dt>-density 2.2</dt>
<dd>Defines the density of the  supporting matrix.</dd>
<dt>-dielectric 2.0</dt>
<dd>Defines the dielectric of the  supporting matrix.</dd>
<dt>-LO h k l (✔)</dt>
<dd>The frequencies corresponding to the longitudinal optic modes with a k vector direction (h k l) are calculated  using Equations <a class="reference internal" href="theory.html#equation-eq-lodynamicalmatrix">(23)</a>.</dd>
<dt>-LO_cart x y z (✔)</dt>
<dd>As above but for Cartesian  directions</dd>
<dt>-sigma 5.0</dt>
<dd>Specifies the damping factor, σ,  for all modes in cm<sup>-1</sup>, as used in Equation <a class="reference internal" href="theory.html#equation-eq-permittivity">(18)</a>.</dd>
<dt>-mode_sigma k σ (✔)</dt>
<dd>The k’th mode is assigned a specific σ (cm<sup>-1</sup>).</dd>
<dt>-vmin 0.0</dt>
<dd>Thee starting wavenumber (cm<sup>-1</sup>)  for the frequency range.</dd>
<dt>-vmax 300.0</dt>
<dd>The final wavenumber (cm<sup>-1</sup>)  for the frequency range.</dd>
<dt>-i 0.2</dt>
<dd>The increment used to cover  the frequency range (cm<sup>-1</sup>).</dd>
<dt>-plot absorption (✔)</dt>
<dd>Plot types  are specified by the string and they can be  ‘absorption’, ‘molar_absorption’, ‘real’ or ‘imaginary’.</dd>
<dt>-excel filename.xlsx</dt>
<dd>Writes the results to an excel  spread sheet with the specified name.</dd>
<dt>-csv filename.csv</dt>
<dd>Output is sent to the specified comma separated  file.</dd>
<dt>-csv_ext filename</dt>
<dd>Output is sent to 3 comma separated  files; filename_command.csv, filename_frequency.csv and filename_spectrum.csv.</dd>
<dt>-print</dt>
<dd>Additional output is provided from  the QM or MM calculation.</dd>
<dt>-ignore k (✔)</dt>
<dd>Ignore the kth mode (any mode below 5 cm<sup>-1</sup> is ignored automatically).</dd>
<dt>-mode k (✔)</dt>
<dd>Only use the kth mode in the  calculation of the permittivity.</dd>
<dt>-threshold 1.0e-10 5.0</dt>
<dd>The modes selected for inclusion in  the absorption calculation have to have an IR intensity greater than 1.0E-10 and a frequency greater than 5 cm<sup>-1</sup>.</dd>
<dt>-eckart</dt>
<dd>The translational modes are  projected out of the hessian before diagonalisation.</dd>
<dt>-hessian symm</dt>
<dd>This option can specify either “crystal” or  “symm”.  In the case of “crystal” the  hessian is symmetrised using the same algorithm as Crystal14.</dd>
<dt>-optical z1 z2 z3</dt>
<dd>z1,z2 and z3 define the diagonal of  the optical permittivity tensor.</dd>
<dt>-optical_tensor z1 z2 ..z9</dt>
<dd>z1,..9 define the full optical permittivity tensor.</dd>
<dt>-masses average</dt>
<dd>Specified the mass definition to use, which can be either “program”, “average” or “isotopic”, meaning that the masses used in the calculation of the frequenciesare either taken from the QM program or are the average of the isotope abundances or are the most abundant isotope mass.</dd>
<dt>-mass element mass (✔)</dt>
<dd>The atomic mass of the element is set to mass.  This can be used to explore the effect of isotope substitution on the calculated frequencies.</dd>
<dt>-processors int</dt>
<dd>The number of processors to be used  in the calculation can be defined.  By  default all available processors are used.</dd>
<dt>-molesof cells [number_of_atoms_per_molecule]</dt>
<dd>The default for the calculation of molar concentration is “cells”.  Other options are “atoms” or  “molecules”.  If ‘molecules’ is  specified then the number of atoms in a molecules must be provided.</dd>
<dt>-size  0.00001 [sigma]</dt>
<dd>Modifies the polarisability (Eq.34) for spherical particles which incorporates the radius of the particle in microns(real).
It is also used to specify the dimension of the spherical particles for the Mie method.
It is also possible to specify a size distribution in which case the first number is the mean of the log distribution (in microns) and the second is its width (in log(microns)).</dd>
</dl>
</div></blockquote>
<p>The shape options; ellipse, slab and needle, specify a unique axis [hkl] using the crystal axes of the unit cell. PDielec transforms these to a cartesian coordinate system using the unit cell lattice vectors. In the case of a slab morphology the unique direction is normal to the surface specified by its Miller indices (hkl. The definitions of the various depolarisation tensors are indicated in Table below.</p>
<table border="1" class="docutils" id="tab-depolarisation">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Definitions used for the depolarisation tensor</span><a class="headerlink" href="#tab-depolarisation" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="7%" />
<col width="93%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Shape</th>
<th class="head">Depolarisation Tensor</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>Sphere</td>
<td><span class="math notranslate">\(\tensorbf{L} =\frac{1}{3}\left( \fieldbf{V}_1 \fieldbf{V}_1^T + \fieldbf{V}_2 \fieldbf{V}_2^T+\fieldbf{V}_3 \fieldbf{V}_3^T \right)\)</span></td>
</tr>
<tr class="row-odd"><td>Slab</td>
<td><span class="math notranslate">\(\tensorbf{L}=\fieldbf{V}_1 \fieldbf{V}_1^T\)</span></td>
</tr>
<tr class="row-even"><td>Needle</td>
<td><span class="math notranslate">\(\tensorbf{L}=\frac{1}{2}\left( \fieldbf{V}_2\fieldbf{V}_2^T + \fieldbf{V}_3 \fieldbf{V}_3^T \right)\)</span></td>
</tr>
<tr class="row-odd"><td>Ellipsoid</td>
<td><span class="math notranslate">\(\tensorbf{L}=a\fieldbf{V}_1 \fieldbf{V}_1^T + b\fieldbf{V}_2 \fieldbf{V}_2^T + b\fieldbf{V}_3 \fieldbf{V}_3^T\)</span></td>
</tr>
</tbody>
</table>
<p>The three directions defined by <span class="math notranslate">\(\fieldbf{V}_1, \fieldbf{V}_2 \text{and} \fieldbf{V}_3\)</span> are mutually orthogonal cartesian vectors calculated from [hkl] for an ellipse  or needle and (hkl) for a slab. In the case of a slab, needle or ellipsoid, <span class="math notranslate">\({\bar{V}}_{1}\)</span> defines the unique direction and the other vectors are orthogonal to it. For the case of an ellipsoid, the parameters <em>a</em> and <em>b</em> in Table depend on the ratio, <span class="math notranslate">\(z\)</span>, of the length of unique axis length over the length of an axis perpendicular to it <a class="reference internal" href="theory.html#sihvola" id="id63">[30]</a>.</p>
<p>For z &gt; 1 the ellipsoid is prolate;
<span class="math notranslate">\(e = \sqrt{1 - z^{- 2}},\ a = \frac{\left( 1 - e^{2} \right)}{2e^{3}}\left( \log\frac{1 + e}{1 - e} - 2e \right),\ b = \frac{1}{2}\left( 1 - a \right)\)</span></p>
<p>For z &lt; 1 the ellipsoid is oblate
<span class="math notranslate">\(e = \sqrt{z^{- 2} - 1},\ a = \frac{\left( 1 + e^{2} \right)}{e^{3}}\left( e - \operatorname{}e \right),\ b = \frac{1}{2}\left( 1 - a \right)\)</span></p>
<p>From an experimental point of view it is often convenient to use a mass fraction rather than a volume fraction to indicate the amount of dielectrically active material present.  PDielec allows mass fractions to be specified instead of a volume fraction, but this requires that the density of the supporting matrix is known. For convenience the package has a small database of the common supporting materials shown in Table below.  These can be specified through the -matrix option. In the case that the properties of the support material are different the properties can be defined instead with the -dielectric and -density options.</p>
<table border="1" class="docutils" id="id65">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">Physical properties of matrix materials PDielec
 :name: tab-materials</span><a class="headerlink" href="#id65" title="Permalink to this table">¶</a></caption>
<colgroup>
<col width="13%" />
<col width="15%" />
<col width="23%" />
<col width="48%" />
</colgroup>
<thead valign="bottom">
<tr class="row-odd"><th class="head">Name</th>
<th class="head">Density</th>
<th class="head">Permittivity</th>
<th class="head">Description</th>
</tr>
</thead>
<tbody valign="top">
<tr class="row-even"><td>ptfe</td>
<td>2.2</td>
<td>2.0</td>
<td>polytetrafluorethylene</td>
</tr>
<tr class="row-odd"><td>air</td>
<td>0.0</td>
<td>1.0</td>
<td>air</td>
</tr>
<tr class="row-even"><td>vacuum</td>
<td>0.0</td>
<td>1.0</td>
<td>vacuum</td>
</tr>
<tr class="row-odd"><td>kbr</td>
<td>2.75</td>
<td>2.25</td>
<td>potassium bromide</td>
</tr>
<tr class="row-even"><td>nujol</td>
<td>0.838</td>
<td>2.155</td>
<td>Nujol</td>
</tr>
<tr class="row-odd"><td>hdpe</td>
<td>0.955</td>
<td>2.25</td>
<td>high density polyethylene</td>
</tr>
<tr class="row-even"><td>mdpe</td>
<td>0.933</td>
<td>2.25</td>
<td>medium density polyethylene</td>
</tr>
<tr class="row-odd"><td>ldpe</td>
<td>0.925</td>
<td>2.25</td>
<td>low density polyethylene</td>
</tr>
</tbody>
</table>
<p>The optical permittivity is normally calculated by the QM or MM program concerned. However, as this property reflects the electronic contribution to the permittivity at zero frequency, unless there is some treatment of electrons by the shell model, then in MM calculations the optical permittivity needs to be defined through the command line options -optical or -optical_tensor.  Unlike the other methods ‘mie’ method cannot work with particles of zero radius. All methods therefore use a default size of 10<sup>-12</sup> μm. The Mie approach is only valid for dilute dispersions and for spherical particles. However, if other shapes are specified the Mie method will still be called and the results will be applicable to spheres of the specified size.</p>
</div>
<div class="section" id="parallelization-and-threads">
<h2>Parallelization and threads<a class="headerlink" href="#parallelization-and-threads" title="Permalink to this headline">¶</a></h2>
<p>To improve the performance of the program python parallelization has been used to parallelize over the frequencies, shapes and methods. By default this parallelization spawns additional Python executables, depending on the number of cores available.</p>
<p>In addition to this form of parallelization the NUMPY library can use multi-threaded BLAS. NUMPY can be compiled with several different BLAS libraries, including; MKL (from Intel), OPENBLAS and ATLAS, or indeed no optimized BLAS library is necessary. To explore the BLAS version compiled with your version of NUMPY please use the test_numpy_1, test_numpy_2 and test_numpy_3 scripts included in the Python/ subdirectory. If you are using MKL or OPENBLAS, the number of threads being used needs to be set with the MKL_NUM_THREADS or OPENBLAS _NUM_THREADS environment variable (sometimes OMP_NUM_THREADS is also used). Use the test routines to determine the optimum for your system. Experience indicates that no performance benefit is obtained with more than two threads.</p>
<p>In the case of Phonopy the dynamical matrix is read from a yaml file. This has been found to be very slow unless the C parser is used. If the C parser is not available a warning is issued and the program reverts back to the Python parser.</p>
<p>Finally the use of non-standard BLAS libraries seems to cause problems with the affinity settings for the multiprocessing. It has been noticed that the parallel processes can all end up executing on the same processor. In order to prevent this, before executing the pdielec and preader scripts it may be necessary to include;</p>
<blockquote>
<div>export OPENBLAS_MAIN_FREE=1</div></blockquote>
<p>For some reason this also works if the MKL library is being used.</p>
</div>
<div class="section" id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h2>
<p>PDielec has been written to make use of multiprocessor computers. On a 4 processor machine the speed-up is nearly linear up to 4 processors, as can be seen in the Figure below.</p>
<div class="figure" id="id66">
<span id="fig-speedup"></span><a class="reference internal image-reference" href="_images/SpeedUp.png"><img alt="_images/SpeedUp.png" src="_images/SpeedUp.png" style="width: 450.0px; height: 272.7px;" /></a>
<p class="caption"><span class="caption-number">Fig. 2 </span><span class="caption-text">Speed-up on a four processor workstation</span></p>
</div>
</div>
<div class="section" id="example-command-line-uses-of-pdielec">
<h2>Example command line uses of PDielec<a class="headerlink" href="#example-command-line-uses-of-pdielec" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdielec</span> <span class="o">-</span><span class="n">program</span> <span class="n">vasp</span> <span class="n">OUTCAR</span> <span class="o">-</span><span class="n">method</span> <span class="n">ap</span> <span class="o">-</span><span class="n">method</span> <span class="n">maxwell</span> \
        <span class="o">-</span><span class="n">sphere</span> <span class="o">-</span><span class="n">plate</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="o">-</span><span class="n">needle</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span> <span class="o">-</span><span class="n">LO</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">1</span>
</pre></div>
</div>
<p>This performs a calculation using the Averaged-Permittivity and Maxwell-Garnett mixing rules for spherical particles, plate-like particles with a surface (001) and needle-like particles with a unique
direction lying along the [001] direction. The supporting matrix is taken to be PTFE and the default volume fraction (10%) is used. The results of a VASP calculation are stored in the current directory.  There is no absorption output from this command as neither the -plot nor the -csv options were specified. The output includes the calculation of the LO modes along the (001) direction.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdielec</span> <span class="o">-</span><span class="n">program</span> <span class="n">castep</span> <span class="n">phonon</span> <span class="o">-</span><span class="n">vmin</span> <span class="mi">300</span> <span class="o">-</span><span class="n">vmax</span> <span class="mi">800</span> \
        <span class="o">-</span><span class="n">sphere</span> <span class="o">-</span><span class="n">dielectric</span> <span class="mi">3</span> <span class="o">-</span><span class="n">vf</span> <span class="mf">0.1</span> <span class="o">-</span><span class="n">vf</span> <span class="mf">0.2</span> <span class="o">-</span><span class="n">sigma</span> <span class="mi">10</span> <span class="o">-</span><span class="n">csv</span> <span class="n">mgo</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>This performs a calculation for spherical particles varying the frequency from 300 to 800 cm<sup>-1</sup>, the permittivity of the supporting media is 3, two volume fractions are considered and a damping factor of 10 cm<sup>-1</sup> is used. The results of a CASTEP calculation with the seed-name “phonon” are analysed and the results stored in mgo.csv for further analysis using a spreadsheet. In this example a Maxwell-Garnett mixing rule is used by default. If visual inspection of the results is required then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdielec</span> <span class="o">-</span><span class="n">program</span> <span class="n">castep</span> <span class="n">phonon</span> <span class="o">-</span><span class="n">vmin</span> <span class="mi">300</span> <span class="o">-</span><span class="n">vmax</span> <span class="mi">800</span> \
        <span class="o">-</span><span class="n">sphere</span> <span class="o">-</span><span class="n">dielectric</span> <span class="mi">3</span> <span class="o">-</span><span class="n">vf</span> <span class="mf">0.1</span> <span class="o">-</span><span class="n">vf</span> <span class="mf">0.2</span>\
        <span class="o">-</span><span class="n">sigma</span> <span class="mi">10</span> <span class="o">-</span><span class="n">csv</span> <span class="n">mgo</span><span class="o">.</span><span class="n">csv</span> <span class="o">-</span><span class="n">plot</span> <span class="n">molar_absorption</span>
</pre></div>
</div>
<p>will perform the same calculation but a graph showing the molar absorption coefficients will be displayed.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdielec</span> <span class="o">-</span><span class="n">program</span> <span class="n">gulp</span> <span class="n">calcite</span><span class="o">.</span><span class="n">gout</span> <span class="o">-</span><span class="n">matrix</span> <span class="n">hdpe</span> \
        <span class="o">-</span><span class="n">method</span> <span class="n">ap</span> <span class="o">-</span><span class="n">method</span> <span class="n">maxwell</span> <span class="o">-</span><span class="n">sphere</span> <span class="o">-</span><span class="n">plate</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span><span class="mi">2</span> \
        <span class="o">-</span><span class="n">vmax</span> <span class="mi">2000</span> <span class="o">-</span><span class="n">mf</span> <span class="mf">0.1</span> <span class="n">calcite</span><span class="o">.</span><span class="n">gout</span> <span class="o">-</span><span class="n">csv</span> <span class="n">calcite</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>This command performs a calculation of the absorption spectrum resulting from a GULP calculation. The supporting matrix density and permittivity are those of high density polyethylene, the frequency range is 0 to 2000 cm<sup>-1</sup>, the mass fraction considered is 10%, the mixing rules used are Averaged-Permittivity and Maxwell-Garnett. Spheres and plates with the (<span class="math notranslate">\(\bar{1}\bar{1}\bar{2})\)</span> surface are considered.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdielec</span> <span class="o">-</span><span class="n">program</span> <span class="n">vasp</span> <span class="n">OUTCAR</span> <span class="o">-</span><span class="n">method</span> <span class="n">mie</span> <span class="o">-</span><span class="n">sphere</span> \
        <span class="o">-</span><span class="n">mf</span> <span class="mf">0.1</span> <span class="o">-</span><span class="n">size</span> <span class="mf">0.1</span> <span class="o">-</span><span class="n">size</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">size</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">csv</span> <span class="n">results</span><span class="o">.</span><span class="n">csv</span>
</pre></div>
</div>
<p>This command performs a calculation of the absorption spectrum resulting from a VASP calculation using the Mie method for sphere with several particles sizes.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pdielec</span> <span class="o">-</span><span class="n">sphere</span> <span class="o">-</span><span class="n">mf</span> <span class="mf">0.1</span> <span class="o">-</span><span class="n">program</span> <span class="n">experiment</span> <span class="n">experiment</span><span class="o">.</span><span class="n">expt</span>\
        <span class="o">-</span><span class="n">size</span> <span class="mf">0.1</span> <span class="o">-</span><span class="n">size</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">size</span> <span class="mf">1.0</span> <span class="o">-</span><span class="n">excel</span> <span class="n">results</span><span class="o">.</span><span class="n">xlsx</span>
</pre></div>
</div>
<p>This command performs a calculation of the absorption spectrum resulting from the data stored in the experiment.expt file. Maxwell-Garnett calculations are performed with 3 different sized spheres and the results stored in a Excel file.</p>
</div>
<div class="section" id="contents-of-the-csv-output-file">
<h2>Contents of the csv output file<a class="headerlink" href="#contents-of-the-csv-output-file" title="Permalink to this headline">¶</a></h2>
<p>If a csv output file is requested the file will contain the command used to perform the calculation. A brief summary is given of each active infrared mode; including the mode number, frequency, intensity, integrated molar absorption coefficient, its peak height (calculated from the intensity and damping factor) and the damping parameter used in the calculation. Following this is a table with a column for frequency followed by columns containing the real and imaginary permittivities, the absorption and molar absorption coefficients at each frequency.</p>
</div>
</div>
<div class="section" id="references">
<h1>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h1>
<p id="bibtex-bibliography-pdielec-0"><table class="docutils citation" frame="void" id="pyyaml" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id52">[1]</a></td><td>PyYaml. URL: <a class="reference external" href="&lt;https://github.com/yaml&gt;">&lt;https://github.com/yaml&gt;</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="scipy" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[2]</td><td><em>(<a class="fn-backref" href="#id50">1</a>, <a class="fn-backref" href="#id51">2</a>, <a class="fn-backref" href="#id55">3</a>)</em> SciPy. URL: <a class="reference external" href="http://wiki.scipy.org">http://wiki.scipy.org</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="xlsxwriter" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id54">[3]</a></td><td>XlsxWriter. URL: <a class="reference external" href="http://xlsxwriter.readthedocs.io/">http://xlsxwriter.readthedocs.io/</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="balan2008b" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id26">[4]</a></td><td>Etienne Balan, Marc Blanchard, Jean-Francois Hochepied, and Michele Lazzeri. Surface modes in the infrared spectrum of hydrous minerals: the OH stretching modes of bayerite. <em>Physics and Chemistry of Minerals</em>, 35(5):279–285, mar 2008. URL: <a class="reference external" href="http://link.springer.com/10.1007/s00269-008-0221-y">http://link.springer.com/10.1007/s00269-008-0221-y</a>, <a class="reference external" href="https://doi.org/10.1007/s00269-008-0221-y">doi:10.1007/s00269-008-0221-y</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="balan2010b" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id25">[5]</a></td><td>Etienne Balan, Simon Delattre, Damien Roche, Loic Segalen, Guillaume Morin, Maxime Guillaumet, Marc Blanchard, Michele Lazzeri, Christian Brouder, and Ekhard K&nbsp;H Salje. Line-broadening effects in the powder infrared spectrum of apatite. <em>Physics and Chemistry of Minerals</em>, 38(2):111–122, feb 2011. URL: <a class="reference external" href="http://link.springer.com/10.1007/s00269-010-0388-x">http://link.springer.com/10.1007/s00269-010-0388-x</a>, <a class="reference external" href="https://doi.org/10.1007/s00269-010-0388-x">doi:10.1007/s00269-010-0388-x</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="bertie2006" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[6]</td><td><em>(<a class="fn-backref" href="#id8">1</a>, <a class="fn-backref" href="#id9">2</a>)</em> John&nbsp;E Bertie. <em>Glossary of Terms used in Vibrational Spectroscopy</em>. UNKOWN, aug 2006. <a class="reference external" href="https://doi.org/10.1002/0470027320.s8401">doi:10.1002/0470027320.s8401</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="burnett2013" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id13">[7]</a></td><td>Andrew&nbsp;D Burnett, John Kendrick, Christopher Russell, Jeppe Christensen, John&nbsp;E Cunningham, Arwen&nbsp;R Pearson, Edmund&nbsp;H Linfield, and a&nbsp;Giles Davies. Effect of molecular size and particle shape on the terahertz absorption of a homologous series of tetraalkylammonium salts. <em>Analytical chemistry</em>, 85(16):7926–34, aug 2013. URL: <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/23865599">http://www.ncbi.nlm.nih.gov/pubmed/23865599</a>, <a class="reference external" href="https://doi.org/10.1021/ac401657r">doi:10.1021/ac401657r</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="clark2005d" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[8]</td><td><em>(<a class="fn-backref" href="#id2">1</a>, <a class="fn-backref" href="#id57">2</a>)</em> Stewart&nbsp;J. Clark, Matthew&nbsp;D. Segall, Chris&nbsp;J. Pickard, Phil&nbsp;J. Hasnip, M.&nbsp;I&nbsp;J Probert, Keith Refson, and Mike&nbsp;C. Payne. First principles methods using CASTEP. <em>Zeitschrift fur Kristallographie</em>, 220(5-6):567–570, jan 2005. URL: <a class="reference external" href="&lt;Go to ISI&gt;://000229779300015 http://www.degruyter.com/view/j/zkri.2005.220.issue-5-6-2005/zkri.220.5.567.65075/zkri.220.5.567.65075.xml http://www.degruyter.com/view/j/zkri.2005.220.issue-5-6/zkri.220.5.567.65075/zkri.220.5.567.65075.xml">&lt;Go to ISI&gt;://000229779300015 http://www.degruyter.com/view/j/zkri.2005.220.issue-5-6-2005/zkri.220.5.567.65075/zkri.220.5.567.65075.xml http://www.degruyter.com/view/j/zkri.2005.220.issue-5-6/zkri.220.5.567.65075/zkri.220.5.567.65075.xml</a>, <a class="reference external" href="https://doi.org/10.1524/zkri.220.5.567.65075">doi:10.1524/zkri.220.5.567.65075</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="dovesi2014" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[9]</td><td><em>(<a class="fn-backref" href="#id3">1</a>, <a class="fn-backref" href="#id58">2</a>)</em> Roberto Dovesi, Roberto Orlando, Alessandro Erba, Claudio&nbsp;M. Zicovich-Wilson, Bartolomeo Civalleri, Silvia Casassa, Lorenzo Maschio, Matteo Ferrabone, Marco De La Pierre, Philippe D’Arco, Yves Noel, Mauro Causa, Michel Rerat, and Bernard Kirtman. CRYSTAL14: A program for the ab initio investigation of crystalline solids. <em>International Journal of Quantum Chemistry</em>, 114(19):1287–1317, oct 2014. URL: <a class="reference external" href="http://doi.wiley.com/10.1002/qua.24658">http://doi.wiley.com/10.1002/qua.24658</a>, <a class="reference external" href="https://doi.org/10.1002/qua.24658">doi:10.1002/qua.24658</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="fourdrin2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[10]</td><td><em>(<a class="fn-backref" href="#id27">1</a>, <a class="fn-backref" href="#id28">2</a>, <a class="fn-backref" href="#id31">3</a>)</em> Chloe Fourdrin, E.&nbsp;Balan, T.&nbsp;Allard, C.&nbsp;Boukari, and G.&nbsp;Calas. Induced modifications of kaolinite under ionizing radiation: An infrared spectroscopic study. <em>Physics and Chemistry of Minerals</em>, 36(5):291–299, 2009. <a class="reference external" href="https://doi.org/10.1007/s00269-008-0277-8">doi:10.1007/s00269-008-0277-8</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="frohlich1948" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id21">[11]</a></td><td>H&nbsp;Frohlich. <em>Theory of dielectrics</em>. Oxford University Press, Oxford, 1948.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gale2003" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[12]</td><td><em>(<a class="fn-backref" href="#id7">1</a>, <a class="fn-backref" href="#id62">2</a>)</em> Julian&nbsp;D. Gale and Andrew&nbsp;L. Rohl. The General Utility Lattice Program (GULP). <em>Molecular Simulation</em>, 29(5):291–341, may 2003. URL: <a class="reference external" href="http://www.tandfonline.com/doi/abs/10.1080/0892702031000104887">http://www.tandfonline.com/doi/abs/10.1080/0892702031000104887</a>, <a class="reference external" href="https://arxiv.org/abs/arXiv:1011.1669v3">arXiv:arXiv:1011.1669v3</a>, <a class="reference external" href="https://doi.org/10.1080/0892702031000104887">doi:10.1080/0892702031000104887</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="genzel1972a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id22">[13]</a></td><td>L.&nbsp;Genzel and T.&nbsp;P. Martin. Infrared Absorption in Small Ionic Crystals. <em>Physica Status Solidi (b)</em>, 51(1):91–99, may 1972. URL: <a class="reference external" href="http://doi.wiley.com/10.1002/pssb.2220510107">http://doi.wiley.com/10.1002/pssb.2220510107</a>, <a class="reference external" href="https://doi.org/10.1002/pssb.2220510107">doi:10.1002/pssb.2220510107</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="giannozzi2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[14]</td><td><em>(<a class="fn-backref" href="#id5">1</a>, <a class="fn-backref" href="#id60">2</a>)</em> Paolo Giannozzi, Stefano Baroni, Nicola Bonini, Matteo Calandra, Roberto Car, Carlo Cavazzoni, Davide Ceresoli, Guido&nbsp;L. Chiarotti, Matteo Cococcioni, Ismaila Dabo, Andrea Dal Corso, Stefano De Gironcoli, Stefano Fabris, Guido Fratesi, Ralph Gebauer, Uwe Gerstmann, Christos Gougoussis, Anton Kokalj, Michele Lazzeri, Layla Martin-Samos, Nicola Marzari, Francesco Mauri, Riccardo Mazzarello, Stefano Paolini, Alfredo Pasquarello, Lorenzo Paulatto, Carlo Sbraccia, Sandro Scandolo, Gabriele Sclauzero, Ari&nbsp;P. Seitsonen, Alexander Smogunov, Paolo Umari, and Renata&nbsp;M. Wentzcovitch. QUANTUM ESPRESSO: A modular and open-source software project for quantum simulations of materials. <em>Journal of Physics Condensed Matter</em>, 21(39):395502, sep 2009. URL: <a class="reference external" href="http://stacks.iop.org/0953-8984/21/i=39/a=395502?key=crossref.c21336c286fa6d3db893262ae3f6e151">http://stacks.iop.org/0953-8984/21/i=39/a=395502?key=crossref.c21336c286fa6d3db893262ae3f6e151</a>, <a class="reference external" href="https://arxiv.org/abs/0906.2569">arXiv:0906.2569</a>, <a class="reference external" href="https://doi.org/10.1088/0953-8984/21/39/395502">doi:10.1088/0953-8984/21/39/395502</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="giordano2003a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id34">[15]</a></td><td>Stefano Giordano. Effective medium theory for dispersions of dielectric ellipsoids. <em>Journal of Electrostatics</em>, 58(1-2):59–76, may 2003. URL: <a class="reference external" href="http://linkinghub.elsevier.com/retrieve/pii/S0304388602001997">http://linkinghub.elsevier.com/retrieve/pii/S0304388602001997</a>, <a class="reference external" href="https://doi.org/10.1016/S0304-3886(02)00199-7">doi:10.1016/S0304-3886(02)00199-7</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gonze2016" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[16]</td><td><em>(<a class="fn-backref" href="#id4">1</a>, <a class="fn-backref" href="#id59">2</a>)</em> X.&nbsp;Gonze, F.&nbsp;Jollet, F.&nbsp;Abreu Araujo, D.&nbsp;Adams, B.&nbsp;Amadon, T.&nbsp;Applencourt, C.&nbsp;Audouze, J.&nbsp;M. Beuken, J.&nbsp;Bieder, A.&nbsp;Bokhanchuk, E.&nbsp;Bousquet, F.&nbsp;Bruneval, D.&nbsp;Caliste, M.&nbsp;Cote, F.&nbsp;Dahm, F.&nbsp;Da Pieve, M.&nbsp;Delaveau, M.&nbsp;Di Gennaro, B.&nbsp;Dorado, C.&nbsp;Espejo, G.&nbsp;Geneste, L.&nbsp;Genovese, A.&nbsp;Gerossier, M.&nbsp;Giantomassi, Y.&nbsp;Gillet, D.&nbsp;R. Hamann, L.&nbsp;He, G.&nbsp;Jomard, J.&nbsp;Laflamme Janssen, S.&nbsp;Le Roux, A.&nbsp;Levitt, A.&nbsp;Lherbier, F.&nbsp;Liu, I.&nbsp;Lukacevic, A.&nbsp;Martin, C.&nbsp;Martins, M.&nbsp;J.T. Oliveira, S.&nbsp;Ponce, Y.&nbsp;Pouillon, T.&nbsp;Rangel, G.&nbsp;M. Rignanese, A.&nbsp;H. Romero, B.&nbsp;Rousseau, O.&nbsp;Rubel, A.&nbsp;A. Shukri, M.&nbsp;Stankovski, M.&nbsp;Torrent, M.&nbsp;J. Van Setten, B.&nbsp;Van Troeye, M.&nbsp;J. Verstraete, D.&nbsp;Waroquiers, J.&nbsp;Wiktor, B.&nbsp;Xu, A.&nbsp;Zhou, and J.&nbsp;W. Zwanziger. Recent developments in the ABINIT software package. <em>Computer Physics Communications</em>, 205:106–131, aug 2016. URL: <a class="reference external" href="http://linkinghub.elsevier.com/retrieve/pii/S0010465516300923">http://linkinghub.elsevier.com/retrieve/pii/S0010465516300923</a>, <a class="reference external" href="https://doi.org/10.1016/j.cpc.2016.04.003">doi:10.1016/j.cpc.2016.04.003</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="gonze1997" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[17]</td><td><em>(<a class="fn-backref" href="#id18">1</a>, <a class="fn-backref" href="#id19">2</a>, <a class="fn-backref" href="#id20">3</a>)</em> Xavier Gonze and Changyol Lee. Dynamical matrices, Born effective charges, dielectric permittivity tensors, and interatomic force constants from density-functional perturbation theory. <em>Physical Review B</em>, 55(16):10355–10368, apr 1997. URL: <a class="reference external" href="http://link.aps.org/doi/10.1103/PhysRevB.55.10355">http://link.aps.org/doi/10.1103/PhysRevB.55.10355</a>, <a class="reference external" href="https://doi.org/10.1103/PhysRevB.55.10355">doi:10.1103/PhysRevB.55.10355</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="hafner2008c" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[18]</td><td><em>(<a class="fn-backref" href="#id1">1</a>, <a class="fn-backref" href="#id56">2</a>)</em> Jurgen Hafner. Ab-initio simulations of materials using VASP: Density-functional theory and beyond. <em>Journal of Computational Chemistry</em>, 29(13):2044–2078, oct 2008. URL: <a class="reference external" href="http://doi.wiley.com/10.1002/jcc.21057">http://doi.wiley.com/10.1002/jcc.21057</a>, <a class="reference external" href="https://arxiv.org/abs/NIHMS150003">arXiv:NIHMS150003</a>, <a class="reference external" href="https://doi.org/10.1002/jcc.21057">doi:10.1002/jcc.21057</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="iglesias1990" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id24">[19]</a></td><td>J&nbsp;E Iglesias, M&nbsp;Ocana, and C&nbsp;J Serna. Aggregation and matrix effects on the infrared spectrum of microcrystalline powders. <em>Appl.Spectrosc</em>, 44(3):418–426, 1990.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="jamaian2010" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id37">[20]</a></td><td>Siti Jamaian and Tom&nbsp;G. Mackay. On limitations of the Bruggeman formalism for inverse homogenization. <em>Journal of Nanophotonics</em>, 4(1):043510, jun 2010. URL: <a class="reference external" href="http://arxiv.org/abs/1004.5331 http://nanophotonics.spiedigitallibrary.org/article.aspx?doi=10.1117/1.3460908">http://arxiv.org/abs/1004.5331 http://nanophotonics.spiedigitallibrary.org/article.aspx?doi=10.1117/1.3460908</a>, <a class="reference external" href="https://arxiv.org/abs/1004.5331">arXiv:1004.5331</a>, <a class="reference external" href="https://doi.org/10.1117/1.3460908">doi:10.1117/1.3460908</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="juliano2013" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id12">[21]</a></td><td>Thomas&nbsp;R Juliano and Timothy&nbsp;M Korter. Terahertz vibrations of crystalline acyclic and cyclic diglycine: benchmarks for London force correction models. <em>The Journal of Physical Chemistry. A</em>, 117(40):10504–12, oct 2013. URL: <a class="reference external" href="http://www.ncbi.nlm.nih.gov/pubmed/24040840">http://www.ncbi.nlm.nih.gov/pubmed/24040840</a>, <a class="reference external" href="https://doi.org/10.1021/jp407112w">doi:10.1021/jp407112w</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="karkkainen2001" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id36">[22]</a></td><td>K.&nbsp;Karkkainen, a.&nbsp;Sihvola, and K.&nbsp;Nikoskinen. Analysis of a three-dimensional dielectric mixture with finite difference method. <em>IEEE Transactions on Geoscience and Remote Sensing</em>, 39(5):1013–1018, 2001.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="pdielec" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id49">[23]</a></td><td>John Kendrick and Andrew&nbsp;D Burnett. PDielec. URL: <a class="reference external" href="http://www.github.com/JohnKendrick/PDielec">http://www.github.com/JohnKendrick/PDielec</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="mackay2009" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id35">[24]</a></td><td>Tom&nbsp;G Mackay and Akhlesh Lakhtakia. On the application of homogenization formalisms to active dielectric composite materials. <em>Optics Communications</em>, 282(13):2470–2475, 2009. <a class="reference external" href="https://arxiv.org/abs/0901.2092">arXiv:0901.2092</a>, <a class="reference external" href="https://doi.org/10.1016/j.optcom.2009.03.035">doi:10.1016/j.optcom.2009.03.035</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="meier1983" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[25]</td><td><em>(<a class="fn-backref" href="#id38">1</a>, <a class="fn-backref" href="#id39">2</a>)</em> M&nbsp;Meier and A&nbsp;Wokaun. Enhanced fields on large metal particles: dynamic. <em>Optics Letters</em>, 8(11):581–583, 1983.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="peltoniemi1996" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id41">[26]</a></td><td>I&nbsp;Peltoniemi. VARIATIONAL VOLUME INTEGRAL EQUATION METHOD FOR ELECTROMAGNETIC SCATTERING BY. <em>UNKOWN</em>, 1996.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="pereverzev2011b" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[27]</td><td><em>(<a class="fn-backref" href="#id14">1</a>, <a class="fn-backref" href="#id15">2</a>)</em> Andrey Pereverzev and Thomas&nbsp;D. Sewell. Terahertz normal mode relaxation in pentaerythritol tetranitrate. <em>The Journal of Chemical Physics</em>, 134(1):014513, 2011. URL: <a class="reference external" href="http://scitation.aip.org/content/aip/journal/jcp/134/1/10.1063/1.3518423">http://scitation.aip.org/content/aip/journal/jcp/134/1/10.1063/1.3518423</a>, <a class="reference external" href="https://doi.org/10.1063/1.3518423">doi:10.1063/1.3518423</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="ruggiero2015" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id30">[28]</a></td><td>Michael&nbsp;T Ruggiero, Tiphaine Bardon, Matija Strlic, Philip&nbsp;F Taday, and Timothy&nbsp;M Korter. The role of terahertz polariton absorption in the characterization of crystalline iron sulfate hydrates. <em>Phys. Chem. Chem. Phys.</em>, 17(14):9326–9334, 2015. URL: <a class="reference external" href="http://xlink.rsc.org/?DOI=C5CP01195G">http://xlink.rsc.org/?DOI=C5CP01195G</a>, <a class="reference external" href="https://doi.org/10.1039/C5CP01195G">doi:10.1039/C5CP01195G</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="serna1987" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id23">[29]</a></td><td>Carlos&nbsp;J Serna, Manuel Ocafia, and Juan&nbsp;E Iglesias. Optical properties of a-Fe2O3 microcrystals in the infrared. <em>J. Phys. C: Solid St. Phys.</em>, 20:473–484, 1987.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="sihvola" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[30]</td><td><em>(<a class="fn-backref" href="#id29">1</a>, <a class="fn-backref" href="#id32">2</a>, <a class="fn-backref" href="#id33">3</a>, <a class="fn-backref" href="#id40">4</a>, <a class="fn-backref" href="#id63">5</a>)</em> Ari Sihvola. <em>Electromagnetic Mixing Formulas and Applications</em>. IET, The Institution of Engineering and Technology, Michael Faraday House, Six Hills Way, Stevenage SG1 2AY, UK, jan 1999. ISBN 9780852967720. URL: <a class="reference external" href="http://digital-library.theiet.org/content/books/ew/pbew047e">http://digital-library.theiet.org/content/books/ew/pbew047e</a>, <a class="reference external" href="https://doi.org/10.1049/PBEW047E">doi:10.1049/PBEW047E</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="stout2007" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[31]</td><td><em>(<a class="fn-backref" href="#id47">1</a>, <a class="fn-backref" href="#id48">2</a>)</em> Brian Stout, Michel Neviere, and Evgeny Popov. T matrix of the homogeneous anisotropic sphere : applications to orientation-averaged resonant scattering. <em>J. Opt. Soc. Am. A</em>, 24(4):1120–1130, 2007.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="sumlin2018a" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[32]</td><td><em>(<a class="fn-backref" href="#id43">1</a>, <a class="fn-backref" href="#id45">2</a>, <a class="fn-backref" href="#id53">3</a>)</em> Benjamin&nbsp;J. Sumlin, William&nbsp;R. Heinson, and Rajan&nbsp;K. Chakrabarty. Retrieving the aerosol complex refractive index using PyMieScatt: A Mie computational package with visualization capabilities. <em>Journal of Quantitative Spectroscopy and Radiative Transfer</em>, 205:127–134, 2018. URL: <a class="reference external" href="http://linkinghub.elsevier.com/retrieve/pii/S0022407317305836">http://linkinghub.elsevier.com/retrieve/pii/S0022407317305836</a>, <a class="reference external" href="https://doi.org/10.1016/j.jqsrt.2017.10.012">doi:10.1016/j.jqsrt.2017.10.012</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="togo2015" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[33]</td><td><em>(<a class="fn-backref" href="#id6">1</a>, <a class="fn-backref" href="#id61">2</a>)</em> Atsushi Togo and Isao Tanaka. First principles phonon calculations in materials science. <em>Scripta Materialia</em>, 108:1–5, nov 2015. URL: <a class="reference external" href="http://linkinghub.elsevier.com/retrieve/pii/S1359646215003127">http://linkinghub.elsevier.com/retrieve/pii/S1359646215003127</a>, <a class="reference external" href="https://arxiv.org/abs/1506.08498">arXiv:1506.08498</a>, <a class="reference external" href="https://doi.org/10.1016/j.scriptamat.2015.07.021">doi:10.1016/j.scriptamat.2015.07.021</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wilson1955" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[34]</td><td><em>(<a class="fn-backref" href="#id10">1</a>, <a class="fn-backref" href="#id11">2</a>)</em> E.&nbsp;B. Wilson, J.&nbsp;C. Decius, P.&nbsp;C. Cross, and Benson&nbsp;R. Sundheim. Molecular Vibrations: The Theory of Infrared and Raman Vibrational Spectra. 1955. <a class="reference external" href="https://doi.org/10.1149/1.2430134">doi:10.1149/1.2430134</a>.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="wooten1972" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label"><a class="fn-backref" href="#id17">[35]</a></td><td>Frederick Wooten. <em>Optical Properties of Solids</em>. Academic Press, New York, 1972.</td></tr>
</tbody>
</table>
<table class="docutils citation" frame="void" id="vandehulst1981" rules="none">
<colgroup><col class="label" /><col /></colgroup>
<tbody valign="top">
<tr><td class="label">[36]</td><td><em>(<a class="fn-backref" href="#id16">1</a>, <a class="fn-backref" href="#id42">2</a>, <a class="fn-backref" href="#id44">3</a>, <a class="fn-backref" href="#id46">4</a>)</em> H&nbsp;C Van De Hulst. <em>Light Scattering by Small Particles</em>. Volume&nbsp;1. Dover, New York, 1981. ISBN 0486642283. URL: <a class="reference external" href="http://adsabs.harvard.edu/abs/1957lssp.book.....V">http://adsabs.harvard.edu/abs/1957lssp.book…..V</a>, <a class="reference external" href="https://doi.org/10.1007/BF00225274">doi:10.1007/BF00225274</a>.</td></tr>
</tbody>
</table>
</p>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">INTRODUCTION</a></li>
<li><a class="reference internal" href="#theory">THEORY</a><ul>
<li><a class="reference internal" href="#molecular-approach-to-absorption-intensity">Molecular Approach to Absorption Intensity</a></li>
<li><a class="reference internal" href="#solid-state-approach-to-absorption-intensity">Solid State Approach to Absorption Intensity</a></li>
<li><a class="reference internal" href="#effect-of-particle-shape-on-infrared-absorption">Effect of Particle Shape on Infrared Absorption</a><ul>
<li><a class="reference internal" href="#the-polarisability-of-an-isolated-particle">The polarisability of an isolated particle</a></li>
<li><a class="reference internal" href="#the-effective-permittivity-of-a-mixture">The Effective permittivity of a mixture</a></li>
<li><a class="reference internal" href="#mixing-rules">Mixing rules</a></li>
<li><a class="reference internal" href="#maxwell-garnett-mixing-rule">Maxwell-Garnett mixing rule</a></li>
<li><a class="reference internal" href="#bruggeman-mixing-rule">Bruggeman mixing rule</a></li>
<li><a class="reference internal" href="#averaged-permittivity-mixing-rule">Averaged-Permittivity mixing rule</a></li>
</ul>
</li>
<li><a class="reference internal" href="#particle-size-effects">Particle Size Effects</a></li>
<li><a class="reference internal" href="#light-scattering-by-spherical-particles-using-mie-theory">Light Scattering by Spherical Particles using Mie Theory</a></li>
</ul>
</li>
<li><a class="reference internal" href="#implementation">IMPLEMENTATION</a><ul>
<li><a class="reference internal" href="#vasp">VASP</a></li>
<li><a class="reference internal" href="#castep">CASTEP</a></li>
<li><a class="reference internal" href="#crystal">CRYSTAL</a></li>
<li><a class="reference internal" href="#abinit">ABINIT</a></li>
<li><a class="reference internal" href="#qe">QE</a></li>
<li><a class="reference internal" href="#phonopy">PHONOPY</a></li>
<li><a class="reference internal" href="#gulp">GULP</a></li>
<li><a class="reference internal" href="#experiment">EXPERIMENT</a></li>
<li><a class="reference internal" href="#program-options">Program Options</a></li>
<li><a class="reference internal" href="#parallelization-and-threads">Parallelization and threads</a></li>
<li><a class="reference internal" href="#performance">Performance</a></li>
<li><a class="reference internal" href="#example-command-line-uses-of-pdielec">Example command line uses of PDielec</a></li>
<li><a class="reference internal" href="#contents-of-the-csv-output-file">Contents of the csv output file</a></li>
</ul>
</li>
<li><a class="reference internal" href="#references">References</a></li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="pdgui.html" title="previous chapter">&lt;no title&gt;</a></li>
      <li>Next: <a href="preader.html" title="next chapter">&lt;no title&gt;</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/pdielec.rst.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, John Kendrick and Andrew Burnett.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.7.2</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="_sources/pdielec.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>