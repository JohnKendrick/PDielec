<!doctype html>
<html class="no-js" lang="en" data-content_root="">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="../../../genindex.html" /><link rel="search" title="Search" href="../../../search.html" /><link rel="next" title="PDielec.GenericOutputReader" href="../GenericOutputReader/index.html" /><link rel="prev" title="PDielec.ExperimentOutputReader" href="../ExperimentOutputReader/index.html" />

    <!-- Generated with Sphinx 7.1.2 and Furo 2024.01.29 -->
        <title>PDielec.GTMcore - PDielec: John Kendrick &amp; Andrew Burnett</title>
      <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=92fd9be5" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo.css?v=135e06be" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/table_styling.css?v=a1a2a898" />
    <link rel="stylesheet" type="text/css" href="../../../_static/styles/furo-extensions.css?v=36a5483c" />
    <link rel="stylesheet" type="text/css" href="../../../_static/css/custom.css?v=2e0a580d" />
    
    


<style>
  body {
    --color-code-background: #f8f8f8;
  --color-code-foreground: black;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #202020;
  --color-code-foreground: #d0d0d0;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-half" viewBox="0 0 24 24">
    <title>Auto light/dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-shadow">
      <path stroke="none" d="M0 0h24v24H0z" fill="none"/>
      <circle cx="12" cy="12" r="9" />
      <path d="M13 12h5" />
      <path d="M13 15h4" />
      <path d="M13 18h1" />
      <path d="M13 9h4" />
      <path d="M13 6h1" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="../../../index.html"><div class="brand">PDielec: John Kendrick & Andrew Burnett</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="../../../index.html">
  
  
  <span class="sidebar-brand-text">PDielec: John Kendrick & Andrew Burnett</span>
  
</a><form class="sidebar-search-container" method="get" action="../../../search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <p class="caption" role="heading"><span class="caption-text">Software</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../introduction.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../pdgui.html">PDGui</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../software.html">Other Software Components</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Theory</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_powder.html">Theory for Light Scattering from Powders</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../theory_single_crystal.html">Theory for Single Crystal Optics</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../analysis.html">Phonon Analysis</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Applications</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_1.html">Applications of Effective Medium Theory</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../application_notes_2.html">Single Crystal Applications</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1 current has-children"><a class="reference internal" href="../../index.html">API Reference</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" role="switch" type="checkbox"/><label for="toctree-checkbox-1"><div class="visually-hidden">Toggle navigation of API Reference</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l2 current has-children"><a class="reference internal" href="../index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec</span></code></a><input checked="" class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" role="switch" type="checkbox"/><label for="toctree-checkbox-2"><div class="visually-hidden">Toggle navigation of PDielec</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul class="current">
<li class="toctree-l3 has-children"><a class="reference internal" href="../GUI/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI</span></code></a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" role="switch" type="checkbox"/><label for="toctree-checkbox-3"><div class="visually-hidden">Toggle navigation of PDielec.GUI</div><i class="icon"><svg><use href="#svg-arrow-right"></use></svg></i></label><ul>
<li class="toctree-l4"><a class="reference internal" href="../GUI/AnalysisTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.AnalysisTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/App/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.App</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/FitterTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.FitterTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/MainTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.MainTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/NoteBook/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.NoteBook</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/OpenGLWidget/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.OpenGLWidget</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/PlottingTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PlottingTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/PowderScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.PowderScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/ScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/SettingsTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SettingsTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/SingleCrystalLayer/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalLayer</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/SingleCrystalScenarioTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SingleCrystalScenarioTab</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/SpreadSheetManager/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.SpreadSheetManager</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="../GUI/ViewerTab/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GUI.ViewerTab</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="../AbinitOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.AbinitOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Calculator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Calculator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../CastepOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CastepOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Constants/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Constants</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../CrystalOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.CrystalOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../DielectricFunction/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.DielectricFunction</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../ExperimentOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.ExperimentOutputReader</span></code></a></li>
<li class="toctree-l3 current current-page"><a class="current reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GTMcore</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GenericOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GenericOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../GulpOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GulpOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../HelperRoutines/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.HelperRoutines</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../IO/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.IO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Materials/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Materials</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Mie/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Mie</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../PhonopyOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.PhonopyOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Plotter/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Plotter</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../QEOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.QEOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../SuperCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.SuperCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../UnitCell/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.UnitCell</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../Utilities/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.Utilities</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../VaspOutputReader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.VaspOutputReader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../checkcsv/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkcsv</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../checkexcel/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.checkexcel</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../graphdatagenerator/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.graphdatagenerator</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../p1reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p1reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../p2cif/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.p2cif</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../pdcompare/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdcompare</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../pickled_reader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pickled_reader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="../vibanalysis/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.vibanalysis</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../pdgui/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdgui</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../preader/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.preader</span></code></a></li>
<li class="toctree-l1"><a class="reference internal" href="../pdmake/index.html"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.pdmake</span></code></a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../zreferences.html">References</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto"><use href="#svg-sun-half"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main">
          <section id="module-PDielec.GTMcore">
<span id="pdielec-gtmcore"></span><h1><a class="reference internal" href="#module-PDielec.GTMcore" title="PDielec.GTMcore"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GTMcore</span></code></a><a class="headerlink" href="#module-PDielec.GTMcore" title="Permalink to this heading">#</a></h1>
<p>The pyGTM module.</p>
<p>It has been heavily modified by John Kendrick for inclusion in the PDielec library
Quite a lot has been removed as the fields spatial distribution was not needed
Thanks to the authors of the original code for all their hard work</p>
<p>This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.</p>
<p>This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.</p>
<p>You should have received a copy of the GNU General Public License
along with this program.  If not, see &lt;<a class="reference external" href="http://www.gnu.org/licenses/">http://www.gnu.org/licenses/</a>&gt;.</p>
<p>Copyright (C) Mathieu Jeannin 2019 2020 &lt;<a class="reference external" href="mailto:math&#46;jeannin&#37;&#52;&#48;free&#46;fr">math<span>&#46;</span>jeannin<span>&#64;</span>free<span>&#46;</span>fr</a>&gt;.</p>
<p>This module implements the generalized 4x4 transfer matrix (GTM) method
poposed in <a class="reference external" href="http://doi.org/10.1364/JOSAB.34.002128">Passler, N. C. and Paarmann, A., JOSA B 34, 2128 (2017)</a>
and corrected in
<a class="reference external" href="http://doi.org/10.1364/JOSAB.36.003246">JOSA B 36, 3246 (2019)</a>,
as well as the layer-resolved absorption proposed in
<a class="reference external" href="https://arxiv.org/abs/2002.03832">Passler, Jeannin and Paarman</a>.
This code uses inputs from D. Dietze’s FSRStools library
<a class="reference external" href="https://github.com/ddietze/FSRStools">https://github.com/ddietze/FSRStools</a></p>
<p>Please cite the relevant associated publications if you use this code.</p>
<dl class="simple">
<dt>Author:</dt><dd><ul class="simple">
<li><p>Mathieu Jeannin <a class="reference external" href="mailto:math&#46;jeannin&#37;&#52;&#48;free&#46;fr">math<span>&#46;</span>jeannin<span>&#64;</span>free<span>&#46;</span>fr</a> (permanent)</p></li>
</ul>
</dd>
<dt>Affiliations:</dt><dd><ul class="simple">
<li><p>Laboratoire de Physique de l’Ecole Normale Superieure (2019)</p></li>
<li><p>Centre de Nanosciences et Nanotechnologies (2020-2021)</p></li>
</ul>
</dd>
</dl>
<p>Layers are represented by the <a class="reference internal" href="#PDielec.GTMcore.Layer" title="PDielec.GTMcore.Layer"><code class="xref py py-class docutils literal notranslate"><span class="pre">Layer</span></code></a> class that holds all parameters
describing the optical properties of a single layer.
The optical system is assembled using the <a class="reference internal" href="#PDielec.GTMcore.System" title="PDielec.GTMcore.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> class.</p>
<p><strong>Change log:</strong></p>
<blockquote>
<div><p><em>01-01-2023</em>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Major changes introduced by John Kendrick to make the package compatible with PDielec and PDGUI.</p></li>
<li><p>Allowed only full 3x3 tensors for the permittivity</p></li>
<li><p>Changed from 64 to 128 bit arithmetic where possible</p></li>
<li><p>Introduced a scattering matrix formalism</p></li>
<li><p>Added treatment of incoherence</p></li>
</ul>
</div></blockquote>
<p><em>15-10-2021</em>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Fixed rounding error bug in lag.eig() causing the program to crash randomly for negligibly small imaginary parts of the wavevectors</p></li>
<li><p>Corrected a sign error in gamma32 that lead to field discontinuities</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt><em>23 June 2021</em>:</dt><dd><ul class="simple">
<li><p>integrated the code into pdielec and pdgui</p></li>
</ul>
</dd>
</dl>
<p><em>19-03-2020</em>:</p>
<blockquote>
<div><ul class="simple">
<li><p>Adapted the code to compute the layer-resolved absorption as proposed
by Passler et al. (<a class="reference external" href="https://arxiv.org/abs/2002.03832">https://arxiv.org/abs/2002.03832</a>), using
<code class="xref py py-func docutils literal notranslate"><span class="pre">System.calculate_Poynting_Absorption_vs_z()</span></code>.</p></li>
<li><p>Include the correct calculation of intensity transmission coefficients
in <a class="reference internal" href="#PDielec.GTMcore.System.calculate_r_t" title="PDielec.GTMcore.System.calculate_r_t"><code class="xref py py-func docutils literal notranslate"><span class="pre">System.calculate_r_t()</span></code></a>.
<strong>This BREAKS compatibility</strong> with the previous definition of the function.</p></li>
<li><p>Corrected bugs in <code class="xref py py-func docutils literal notranslate"><span class="pre">System.calculate_Efield()</span></code>
and added magnetic field option</p></li>
<li><p>Adapted <code class="xref py py-func docutils literal notranslate"><span class="pre">System.calculate_Efield()</span></code> to allow hand-defined,
irregular grid and a shorthand to compute only at layers interfaces.
Regular grid with fixed resolution is left as an option.</p></li>
</ul>
</div></blockquote>
<dl class="simple">
<dt><em>20-09-2019</em>:</dt><dd><ul class="simple">
<li><p>Added functions in the <a class="reference internal" href="#PDielec.GTMcore.System" title="PDielec.GTMcore.System"><code class="xref py py-class docutils literal notranslate"><span class="pre">System</span></code></a> class to compute in-plane
wavevector of guided modes and dispersion relation for such guided surface modes.
This is <em>highly prospective</em> as it depends on the robustness of the minimization
procedure (or the lack of thereoff)</p></li>
</ul>
</dd>
</dl>
</div></blockquote>
<section id="module-contents">
<h2>Module Contents<a class="headerlink" href="#module-contents" title="Permalink to this heading">#</a></h2>
<section id="classes">
<h3>Classes<a class="headerlink" href="#classes" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.CoherentLayer" title="PDielec.GTMcore.CoherentLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a></p></td>
<td><p>Define a coherent layer inherits from Layer class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentAveragePhaseLayer" title="PDielec.GTMcore.IncoherentAveragePhaseLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IncoherentAveragePhaseLayer</span></code></a></p></td>
<td><p>Define an incoherent layer using an average phase in the propagation matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentIntensityLayer" title="PDielec.GTMcore.IncoherentIntensityLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IncoherentIntensityLayer</span></code></a></p></td>
<td><p>Define an incoherent layer using intensity transfer matrices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentPhaseLayer" title="PDielec.GTMcore.IncoherentPhaseLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IncoherentPhaseLayer</span></code></a></p></td>
<td><p>Define an incoherent layer using Arteaga's modification of the phase in the propagation matrix.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentThickLayer" title="PDielec.GTMcore.IncoherentThickLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">IncoherentThickLayer</span></code></a></p></td>
<td><p>Define an incoherent layer using the thick slab approximation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.Layer" title="PDielec.GTMcore.Layer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Layer</span></code></a></p></td>
<td><p>Layer class. An instance is a single layer.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.SMatrix" title="PDielec.GTMcore.SMatrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SMatrix</span></code></a></p></td>
<td><p>A class for storing and manipulating scattering matrices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.ScatteringMatrixSystem" title="PDielec.GTMcore.ScatteringMatrixSystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ScatteringMatrixSystem</span></code></a></p></td>
<td><p>Define a system of layers which is described by a Scattering Matrix method.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.SemiInfiniteLayer" title="PDielec.GTMcore.SemiInfiniteLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SemiInfiniteLayer</span></code></a></p></td>
<td><p>Define a semi-infinite layer, inherits from CoherentLayer class.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.System" title="PDielec.GTMcore.System"><code class="xref py py-obj docutils literal notranslate"><span class="pre">System</span></code></a></p></td>
<td><p>System class. An instance is an optical system with substrate, superstrate, and layers.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.TransferMatrixSystem" title="PDielec.GTMcore.TransferMatrixSystem"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TransferMatrixSystem</span></code></a></p></td>
<td><p>Define a system of layers which is described by a Transfer Matrix method.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="functions">
<h3>Functions<a class="headerlink" href="#functions" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.exact_inv_2x2" title="PDielec.GTMcore.exact_inv_2x2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exact_inv_2x2</span></code></a>(M)</p></td>
<td><p>Calculate the inverse of 2x2 complex matrix, M.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.exact_inv_3x3" title="PDielec.GTMcore.exact_inv_3x3"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exact_inv_3x3</span></code></a>(M)</p></td>
<td><p>Calculate the inverse of a 3x3 complex matrix M.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.exact_inv_4x4" title="PDielec.GTMcore.exact_inv_4x4"><code class="xref py py-obj docutils literal notranslate"><span class="pre">exact_inv_4x4</span></code></a>(M)</p></td>
<td><p>Compute the 'exact' inverse of a 4x4 matrix using the analytical result.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.vacuum_eps" title="PDielec.GTMcore.vacuum_eps"><code class="xref py py-obj docutils literal notranslate"><span class="pre">vacuum_eps</span></code></a>(f)</p></td>
<td><p>Vacuum permittivity function.</p></td>
</tr>
</tbody>
</table>
</div>
</section>
<section id="attributes">
<h3>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading">#</a></h3>
<div class="table-wrapper autosummary longtable docutils container">
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#PDielec.GTMcore.c_const" title="PDielec.GTMcore.c_const"><code class="xref py py-obj docutils literal notranslate"><span class="pre">c_const</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#PDielec.GTMcore.eps0" title="PDielec.GTMcore.eps0"><code class="xref py py-obj docutils literal notranslate"><span class="pre">eps0</span></code></a></p></td>
<td><p></p></td>
</tr>
</tbody>
</table>
</div>
<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.CoherentLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">CoherentLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#CoherentLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.CoherentLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.Layer" title="PDielec.GTMcore.Layer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Layer</span></code></a></p>
<p>Define a coherent layer inherits from Layer class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.CoherentLayer.calculate_scattering_matrix">
<span class="sig-name descname"><span class="pre">calculate_scattering_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#CoherentLayer.calculate_scattering_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.CoherentLayer.calculate_scattering_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the scattering matrix of this layer with layer b.</p>
<p>This method calculates the scattering matrix based on equations 18-21 in the PyLama paper.
However, it’s important to note that the definition of a scattering matrix used here
differs from that in the paper.</p>
<section id="parameters">
<h4>Parameters<a class="headerlink" href="#parameters" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>b<span class="classifier">a pyGTM layer class</span></dt><dd><p>The second layer for which the scattering matrix will be calculated</p>
</dd>
</dl>
</section>
<section id="returns">
<h4>Returns<a class="headerlink" href="#returns" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
<section id="notes">
<h4>Notes<a class="headerlink" href="#notes" title="Permalink to this heading">#</a></h4>
<p>Explain any important details about the implementation, external references like the PyLama paper,
and any differences in definitions or approaches.</p>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentAveragePhaseLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">IncoherentAveragePhaseLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">percentage_incoherence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">100</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">number_of_samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentAveragePhaseLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentAveragePhaseLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.CoherentLayer" title="PDielec.GTMcore.CoherentLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a></p>
<p>Define an incoherent layer using an average phase in the propagation matrix.</p>
<p>Inherits from CoherentLayer</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentAveragePhaseLayer.calculate_propagation_exponents">
<span class="sig-name descname"><span class="pre">calculate_propagation_exponents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentAveragePhaseLayer.calculate_propagation_exponents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentAveragePhaseLayer.calculate_propagation_exponents" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the matrix Ki (or Pi depending on the paper).</p>
<p>A phase shift is included in the calculation.
The phase shift can vary between 0 and <span class="math notranslate nohighlight">\(\pi\)</span>.</p>
<section id="id1">
<h4>Parameters<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency</p>
</dd>
</dl>
</section>
<section id="id2">
<h4>Returns<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentIntensityLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">IncoherentIntensityLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentIntensityLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentIntensityLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.CoherentLayer" title="PDielec.GTMcore.CoherentLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a></p>
<p>Define an incoherent layer using intensity transfer matrices.</p>
<p>Inherits from the CoherentLayer class.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentPhaseLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">IncoherentPhaseLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentPhaseLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentPhaseLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.CoherentLayer" title="PDielec.GTMcore.CoherentLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a></p>
<p>Define an incoherent layer using Arteaga’s modification of the phase in the propagation matrix.</p>
<p>Inherits from CoherentLayer</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentPhaseLayer.calculate_propagation_exponents">
<span class="sig-name descname"><span class="pre">calculate_propagation_exponents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentPhaseLayer.calculate_propagation_exponents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentPhaseLayer.calculate_propagation_exponents" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the matrix Ki (or Pi) depending on the paper.</p>
<p>This routine is taken from Arteaga et al., Thin Solid Films 2014, 571, 701-705.
The propagation matrix is suitable for incoherent films. In Passler, the ordering is:
Arteaga:
0 p/o -&gt; p -&gt;
1 s/e -&gt; p &lt;-
2 p/o &lt;- s -&gt;
3 s/e &lt;- s &lt;-</p>
<section id="id3">
<h4>Parameters<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency</p>
</dd>
</dl>
</section>
<section id="id4">
<h4>Returns<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentThickLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">IncoherentThickLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentThickLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentThickLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.CoherentLayer" title="PDielec.GTMcore.CoherentLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a></p>
<p>Define an incoherent layer using the thick slab approximation.</p>
<p>Inherits from CoherentLayer</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentThickLayer.calculate_propagation_matrix">
<span class="sig-name descname"><span class="pre">calculate_propagation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentThickLayer.calculate_propagation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentThickLayer.calculate_propagation_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Routine to calculate the matrix Ki using the thick slab approximation.</p>
<section id="id5">
<h4>Parameters<a class="headerlink" href="#id5" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency</p>
</dd>
</dl>
</section>
<section id="id6">
<h4>Returns<a class="headerlink" href="#id6" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.IncoherentThickLayer.calculate_scattering_matrix">
<span class="sig-name descname"><span class="pre">calculate_scattering_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#IncoherentThickLayer.calculate_scattering_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.IncoherentThickLayer.calculate_scattering_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the scattering matrix of this layer with layer b.</p>
<p>This method calculates the scattering matrix based on equations 18-21 in the PyLama paper.
However, it’s important to note that the definition of a scattering matrix used here
differs from that in the paper.</p>
<section id="id7">
<h4>Parameters<a class="headerlink" href="#id7" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>b<span class="classifier">pyGTM layer</span></dt><dd><p>The second layer</p>
</dd>
</dl>
</section>
<section id="id8">
<h4>Returns<a class="headerlink" href="#id8" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">Layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thickness</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-06</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsilon</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer" title="Permalink to this definition">#</a></dt>
<dd><p>Layer class. An instance is a single layer.</p>
<p>The inherited layer classes wich are used in PDielec are:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#PDielec.GTMcore.CoherentLayer" title="PDielec.GTMcore.CoherentLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a></p></li>
<li><p><a class="reference internal" href="#PDielec.GTMcore.SemiInfiniteLayer" title="PDielec.GTMcore.SemiInfiniteLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">SemiInfiniteLayer</span></code></a></p></li>
<li><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentIntensityLayer" title="PDielec.GTMcore.IncoherentIntensityLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">IncoherentIntensityLayer</span></code></a></p></li>
<li><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentAveragePhaseLayer" title="PDielec.GTMcore.IncoherentAveragePhaseLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">IncoherentAveragePhaseLayer</span></code></a></p></li>
<li><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentPhaseLayer" title="PDielec.GTMcore.IncoherentPhaseLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">IncoherentPhaseLayer</span></code></a></p></li>
<li><p><a class="reference internal" href="#PDielec.GTMcore.IncoherentThickLayer" title="PDielec.GTMcore.IncoherentThickLayer"><code class="xref py py-class docutils literal notranslate"><span class="pre">IncoherentThickLayer</span></code></a></p></li>
</ul>
</div></blockquote>
<section id="id9">
<h4>Attributes<a class="headerlink" href="#id9" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>thickness<span class="classifier">float</span></dt><dd><p>Thickness of the layer in meters (m).</p>
</dd>
<dt>epsilon<span class="classifier">complex function</span></dt><dd><p>Function <cite>epsilon(frequency)</cite> representing the full dielectric constant tensor.</p>
</dd>
<dt>theta<span class="classifier">float</span></dt><dd><p>Euler angle theta (colatitude) in radians (rad).</p>
</dd>
<dt>phi<span class="classifier">float</span></dt><dd><p>Euler angle phi in radians (rad).</p>
</dd>
<dt>psi<span class="classifier">float</span></dt><dd><p>Euler angle psi in radians (rad).</p>
</dd>
</dl>
</section>
<section id="id10">
<h4>Notes<a class="headerlink" href="#id10" title="Permalink to this heading">#</a></h4>
<p>If instantiated with default values, it generates a 1 µm thick layer of air.
Properties can be checked/changed dynamically using the corresponding get/set methods.</p>
<dl class="py attribute">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.jk_shift">
<span class="sig-name descname"><span class="pre">jk_shift</span></span><a class="headerlink" href="#PDielec.GTMcore.Layer.jk_shift" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.qsd_thr">
<span class="sig-name descname"><span class="pre">qsd_thr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-10</span></em><a class="headerlink" href="#PDielec.GTMcore.Layer.qsd_thr" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.zero_thr">
<span class="sig-name descname"><span class="pre">zero_thr</span></span><em class="property"><span class="w"> </span><span class="p"><span class="pre">=</span></span><span class="w"> </span><span class="pre">1e-10</span></em><a class="headerlink" href="#PDielec.GTMcore.Layer.zero_thr" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_ai">
<span class="sig-name descname"><span class="pre">calculate_ai</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_ai"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_ai" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate A_i.</p>
<p>Boundary matrix <span class="math notranslate nohighlight">\(A_i\)</span> of the layer.</p>
<section id="id11">
<h5>Parameters<a class="headerlink" href="#id11" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>zeta<span class="classifier">float</span></dt><dd><p>Reduced in-plane wavevector kx/k0.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_epsilon">
<span class="sig-name descname"><span class="pre">calculate_epsilon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f_in</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_epsilon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_epsilon" title="Permalink to this definition">#</a></dt>
<dd><p>Set the value of epsilon in the (rotated) lab frame.</p>
<section id="id12">
<h5>Parameters<a class="headerlink" href="#id12" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f_in<span class="classifier">float</span></dt><dd><p>frequency (in Hz)</p>
</dd>
</dl>
</section>
<section id="id13">
<h5>Returns<a class="headerlink" href="#id13" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id14">
<h5>Notes<a class="headerlink" href="#id14" title="Permalink to this heading">#</a></h5>
<p>The values are set according to the epsilon_fi (i=1..3) functions
defined using the <a class="reference internal" href="#PDielec.GTMcore.Layer.set_epsilon" title="PDielec.GTMcore.Layer.set_epsilon"><code class="xref py py-func docutils literal notranslate"><span class="pre">set_epsilon()</span></code></a> method, at the given frequency f.
The rotation with respect to the lab frame is computed using the Euler angles.</p>
<p>Use explicitly if you <em>don’t</em> use the <code class="xref py py-func docutils literal notranslate"><span class="pre">Layer.update()</span></code> function!
Modification by JK to allow the use of a full dielectric tensor.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_gamma">
<span class="sig-name descname"><span class="pre">calculate_gamma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_gamma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_gamma" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the gamma matrix.</p>
<section id="id15">
<h5>Parameters<a class="headerlink" href="#id15" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>zeta<span class="classifier">complex</span></dt><dd><p>In-plane reduced wavevector kx/k0.</p>
</dd>
</dl>
</section>
<section id="id16">
<h5>Returns<a class="headerlink" href="#id16" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_matrices">
<span class="sig-name descname"><span class="pre">calculate_matrices</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_matrices" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the principal matrices necessary for the GTM algorithm.</p>
<section id="id17">
<h5>Parameters<a class="headerlink" href="#id17" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>zeta<span class="classifier">complex</span></dt><dd><p>In-plane reduced wavevector kx/k0 in the system.</p>
</dd>
</dl>
</section>
<section id="id18">
<h5>Returns<a class="headerlink" href="#id18" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id19">
<h5>Notes<a class="headerlink" href="#id19" title="Permalink to this heading">#</a></h5>
<p>Note that zeta is conserved through the whole system and set externally
using the angle of incidence and <cite>System.superstrate.epsilon[0,0]</cite> value.</p>
<p>Requires prior execution of <a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_epsilon" title="PDielec.GTMcore.Layer.calculate_epsilon"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_epsilon()</span></code></a>.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_propagation_exponents">
<span class="sig-name descname"><span class="pre">calculate_propagation_exponents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_propagation_exponents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_propagation_exponents" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the propagation exponents.</p>
<section id="id20">
<h5>Parameters<a class="headerlink" href="#id20" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>The frequency</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_propagation_matrix">
<span class="sig-name descname"><span class="pre">calculate_propagation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_propagation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_propagation_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the matrix Ki (or Pi depending on the paper).</p>
<section id="id21">
<h5>Parameters<a class="headerlink" href="#id21" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency</p>
</dd>
</dl>
</section>
<section id="id22">
<h5>Returns<a class="headerlink" href="#id22" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>Ki<span class="classifier">ndarray</span></dt><dd><p>A 4x4-array representing the boundary matrix <span class="math notranslate nohighlight">\(K_i\)</span> of the layer.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_q">
<span class="sig-name descname"><span class="pre">calculate_q</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_q"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_q" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the 4 out-of-plane wavevectors for the current layer.</p>
<section id="id23">
<h5>Parameters<a class="headerlink" href="#id23" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id24">
<h5>Returns<a class="headerlink" href="#id24" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id25">
<h5>Notes<a class="headerlink" href="#id25" title="Permalink to this heading">#</a></h5>
<p>From this we also get the Poynting vectors. Wavevectors are sorted according
to (trans-p, trans-s, refl-p, refl-s). Birefringence is determined according
to a threshold value <cite>qsd_thr</cite> set at the beginning of the script.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.calculate_transfer_matrix">
<span class="sig-name descname"><span class="pre">calculate_transfer_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.calculate_transfer_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.calculate_transfer_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the transfer matrix of the whole layer <span class="math notranslate nohighlight">\(T_i=A_iP_iA_i^{-1}\)</span>.</p>
<section id="id26">
<h5>Parameters<a class="headerlink" href="#id26" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency (in Hz).</p>
</dd>
<dt>zeta<span class="classifier">complex</span></dt><dd><p>Reduced in-plane wavevector kx/k0.</p>
</dd>
</dl>
</section>
<section id="id27">
<h5>Returns<a class="headerlink" href="#id27" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.isCoherent">
<span class="sig-name descname"><span class="pre">isCoherent</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.isCoherent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.isCoherent" title="Permalink to this definition">#</a></dt>
<dd><p>Return True if the layer is a coherent layer.</p>
<section id="id28">
<h5>Parameters<a class="headerlink" href="#id28" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id29">
<h5>Returns<a class="headerlink" href="#id29" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>bool</dt><dd><p>True if the layer is coherent, False if not.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.set_epsilon">
<span class="sig-name descname"><span class="pre">set_epsilon</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">epsilon_function</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.set_epsilon"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.set_epsilon" title="Permalink to this definition">#</a></dt>
<dd><p>Set the dielectric function.</p>
<section id="id30">
<h5>Parameters<a class="headerlink" href="#id30" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>epsilon_function<span class="classifier">complex function</span></dt><dd><p>A function representing the complex dielectric function.</p>
</dd>
</dl>
</section>
<section id="id31">
<h5>Returns<a class="headerlink" href="#id31" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.set_euler">
<span class="sig-name descname"><span class="pre">set_euler</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">theta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.set_euler"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.set_euler" title="Permalink to this definition">#</a></dt>
<dd><p>Set the values for the Euler rotations angles.</p>
<section id="id32">
<h5>Parameters<a class="headerlink" href="#id32" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>theta<span class="classifier">float</span></dt><dd><p>Euler angle theta (colatitude) in rad.</p>
</dd>
<dt>phi<span class="classifier">float</span></dt><dd><p>Euler angle phi in rad.</p>
</dd>
<dt>psi<span class="classifier">float</span></dt><dd><p>Euler angle psi in rad.</p>
</dd>
</dl>
</section>
<section id="id33">
<h5>Returns<a class="headerlink" href="#id33" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.set_thickness">
<span class="sig-name descname"><span class="pre">set_thickness</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">thickness</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.set_thickness"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.set_thickness" title="Permalink to this definition">#</a></dt>
<dd><p>Set the layer thickness.</p>
<section id="id34">
<h5>Parameters<a class="headerlink" href="#id34" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>thickness<span class="classifier">float</span></dt><dd><p>The layer thickness (in m).</p>
</dd>
</dl>
</section>
<section id="id35">
<h5>Returns<a class="headerlink" href="#id35" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.update_sm">
<span class="sig-name descname"><span class="pre">update_sm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.update_sm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.update_sm" title="Permalink to this definition">#</a></dt>
<dd><p>Shortcut to recalculate all layer properties for scattering method.</p>
<p>Appropriate for a scattering matrix method.
This avoids the calculation of the exponential; it just calculates the exponents.</p>
<section id="id36">
<h5>Parameters<a class="headerlink" href="#id36" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>frequency (in Hz)</p>
</dd>
<dt>zeta<span class="classifier">complex</span></dt><dd><p>reduced in-plane wavevector kx/k0</p>
</dd>
</dl>
</section>
<section id="calculates">
<h5>Calculates<a class="headerlink" href="#calculates" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>Ai<span class="classifier">array_like, shape (4, 4)</span></dt><dd><p>Boundary matrix <span class="math notranslate nohighlight">\(A_i\)</span> of the layer.</p>
</dd>
<dt>Ki<span class="classifier">array_like, shape (4, 4)</span></dt><dd><p>Propagation matrix <span class="math notranslate nohighlight">\(K_i\)</span> of the layer.</p>
</dd>
<dt>Ai_inv<span class="classifier">array_like, shape (4, 4)</span></dt><dd><p>Inverse of the <span class="math notranslate nohighlight">\(A_i\)</span> matrix.</p>
</dd>
<dt>Ti<span class="classifier">array_like, shape (4, 4)</span></dt><dd><p>Transfer matrix of the whole layer.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.Layer.update_tm">
<span class="sig-name descname"><span class="pre">update_tm</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#Layer.update_tm"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.Layer.update_tm" title="Permalink to this definition">#</a></dt>
<dd><p>Shortcut to recalculate all layer properties.</p>
<p>Appropriate for a transfer matrix method</p>
<section id="id37">
<h5>Parameters<a class="headerlink" href="#id37" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>frequency (in Hz)</p>
</dd>
<dt>zeta<span class="classifier">complex</span></dt><dd><p>reduced in-plane wavevector kx/k0</p>
</dd>
</dl>
</section>
<section id="id38">
<h5>Returns<a class="headerlink" href="#id38" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>Ai<span class="classifier">4x4-array</span></dt><dd><p>Boundary matrix <span class="math notranslate nohighlight">\(A_i\)</span> of the layer</p>
</dd>
<dt>Ki<span class="classifier">4x4-array</span></dt><dd><p>Propagation matrix <span class="math notranslate nohighlight">\(K_i\)</span> of the layer</p>
</dd>
<dt>Ai_inv<span class="classifier">4x4-array</span></dt><dd><p>Inverse of the <span class="math notranslate nohighlight">\(A_i\)</span> matrix</p>
</dd>
<dt>Ti<span class="classifier">4x4-array</span></dt><dd><p>Transfer matrix of the whole layer</p>
</dd>
</dl>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.SMatrix">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">SMatrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">S</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#SMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.SMatrix" title="Permalink to this definition">#</a></dt>
<dd><p>A class for storing and manipulating scattering matrices.</p>
<p>S-matrices are square matrices used in physics and engineering to describe the
scattering and reflection of waves or particles. They are especially useful in the
field of microwave engineering, quantum mechanics, and optical physics.</p>
<section id="id39">
<h4>Attributes<a class="headerlink" href="#id39" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>S11<span class="classifier">np.ndarray</span></dt><dd><p>The top-left 2x2 submatrix of the S-matrix, representing input to input scattering.</p>
</dd>
<dt>S22<span class="classifier">np.ndarray</span></dt><dd><p>The bottom-right 2x2 submatrix of the S-matrix, representing output to output scattering.</p>
</dd>
<dt>S21<span class="classifier">np.ndarray</span></dt><dd><p>The bottom-left 2x2 submatrix of the S-matrix, representing input to output transmission.</p>
</dd>
<dt>S12<span class="classifier">np.ndarray</span></dt><dd><p>The top-right 2x2 submatrix of the S-matrix, representing output to input transmission.</p>
</dd>
<dt>S<span class="classifier">np.ndarray</span></dt><dd><p>A 4x4 composite S-matrix combining S11, S22, S21, and S12.</p>
</dd>
</dl>
</section>
<section id="methods">
<h4>Methods<a class="headerlink" href="#methods" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>unitMatrix()</dt><dd><p>Initializes the S-matrix to a unit matrix with appropriate S11, S22, S21, and S12.</p>
</dd>
<dt>redheffer(b)</dt><dd><p>Performs the Redheffer star product, a specialized matrix multiplication for S-matrices,
with another SMatrix instance <cite>b</cite>.</p>
</dd>
<dt>calculateS()</dt><dd><p>Reconstructs the composite 4x4 S-matrix from its constituent submatrices (S11, S22, S21, S12).</p>
</dd>
</dl>
</section>
<section id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this heading">#</a></h4>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">smatrix</span> <span class="kn">import</span> <span class="n">SMatrix</span>  <span class="c1"># Assuming this class is saved in smatrix.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s_matrix_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">11</span><span class="p">],</span> <span class="p">[</span><span class="mi">12</span><span class="p">,</span> <span class="mi">13</span><span class="p">,</span> <span class="mi">14</span><span class="p">,</span> <span class="mi">15</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">smatrix</span> <span class="o">=</span> <span class="n">SMatrix</span><span class="p">(</span><span class="n">S</span><span class="o">=</span><span class="n">s_matrix_data</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">smatrix</span><span class="o">.</span><span class="n">S</span><span class="p">)</span>  <span class="c1"># This displays the initialized S-matrix</span>
</pre></div>
</div>
</section>
<section id="id40">
<h4>Notes<a class="headerlink" href="#id40" title="Permalink to this heading">#</a></h4>
<p>The Redheffer star product is particularly useful for cascading two-port networks in
microwave engineering and quantum physics. It allows for the efficient calculation of
the overall scattering matrix of the combined system.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.SMatrix.calculateS">
<span class="sig-name descname"><span class="pre">calculateS</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#SMatrix.calculateS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.SMatrix.calculateS" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate and assign the scattering parameter matrix, S.</p>
<p>Fills a 4 by 4 matrix, <cite>S</cite>, with the sub-matrices <cite>S11</cite>, <cite>S22</cite>, <cite>S12</cite>, and <cite>S21</cite> representing the scattering parameters of a two-port network. The <cite>S</cite> matrix combines these sub-matrices as follows:</p>
<ul class="simple">
<li><p><cite>S11</cite> is placed in the top-left quadrant.</p></li>
<li><p><cite>S22</cite> is placed in the bottom-right quadrant.</p></li>
<li><p><cite>S12</cite> is placed in the top-right quadrant.</p></li>
<li><p><cite>S21</cite> is placed in the bottom-left quadrant.</p></li>
</ul>
<section id="id41">
<h5>Parameters<a class="headerlink" href="#id41" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id42">
<h5>Returns<a class="headerlink" href="#id42" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>S<span class="classifier">ndarray, shape (4, 4), dtype=np.clongdouble</span></dt><dd><p>The complete scattering parameter matrix of the two-port network.</p>
</dd>
</dl>
</section>
<section id="id43">
<h5>Notes<a class="headerlink" href="#id43" title="Permalink to this heading">#</a></h5>
<p>The scattering parameters (<cite>S11</cite>, <cite>S22</cite>, <cite>S12</cite>, <cite>S21</cite>) must be defined as attributes of the instance before calling this method.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.SMatrix.redheffer">
<span class="sig-name descname"><span class="pre">redheffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">b</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#SMatrix.redheffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.SMatrix.redheffer" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the product of S-matrices.</p>
<section id="id44">
<h5>Parameters<a class="headerlink" href="#id44" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>b<span class="classifier">ScatteringMatrix</span></dt><dd><p>The second scattering matrix to be used the the multiplication</p>
</dd>
</dl>
</section>
<section id="id45">
<h5>Returns<a class="headerlink" href="#id45" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>Sab<span class="classifier">ScatteringMatrix</span></dt><dd><p>The product of Sa and Sb</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.SMatrix.unitMatrix">
<span class="sig-name descname"><span class="pre">unitMatrix</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#SMatrix.unitMatrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.SMatrix.unitMatrix" title="Permalink to this definition">#</a></dt>
<dd><p>Reset the scattering parameters to form a unit matrix.</p>
<p>Resets the scattering parameters S11, S22, S21, and S12 of the instance to represent a unit matrix, where S11 and S22 are set to zero matrices and S21 and S12 are set to identity matrices. After the reset, calculates the scattering parameters through <cite>calculateS</cite>.</p>
<section id="id46">
<h5>Parameters<a class="headerlink" href="#id46" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id47">
<h5>Returns<a class="headerlink" href="#id47" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id48">
<h5>Notes<a class="headerlink" href="#id48" title="Permalink to this heading">#</a></h5>
<p>This method is typically used to initialize or reset the scattering parameters in a two-port network representation to a known state before performing further operations or calculations.</p>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.ScatteringMatrixSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">ScatteringMatrixSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superstrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#ScatteringMatrixSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.ScatteringMatrixSystem" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.System" title="PDielec.GTMcore.System"><code class="xref py py-obj docutils literal notranslate"><span class="pre">System</span></code></a></p>
<p>Define a system of layers which is described by a Scattering Matrix method.</p>
<p>This implements additional routines needed for the scattering matrix method</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.ScatteringMatrixSystem.calculate_GammaStar">
<span class="sig-name descname"><span class="pre">calculate_GammaStar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta_sys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#ScatteringMatrixSystem.calculate_GammaStar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.ScatteringMatrixSystem.calculate_GammaStar" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the whole system’s scattering matrix.</p>
<p>This replaces the equivalent routine used in the transfer matrix method.</p>
<section id="id49">
<h4>Parameters<a class="headerlink" href="#id49" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency (Hz)</p>
</dd>
<dt>zeta_sys<span class="classifier">complex</span></dt><dd><p>In-plane wavevector kx/k0</p>
</dd>
</dl>
</section>
<section id="id50">
<h4>Returns<a class="headerlink" href="#id50" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>Stotal<span class="classifier">ndarray</span></dt><dd><p>System scattering matrix <span class="math notranslate nohighlight">\(S\)</span></p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.ScatteringMatrixSystem.calculate_r_t">
<span class="sig-name descname"><span class="pre">calculate_r_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zeta_sys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#ScatteringMatrixSystem.calculate_r_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.ScatteringMatrixSystem.calculate_r_t" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the reflectance and transmittance coefficients using scattering matrix information.</p>
<p>Calculate various field and intensity reflection and transmission coefficients, as well as the 4-valued vector of transmitted field.</p>
<section id="id51">
<h4>Parameters<a class="headerlink" href="#id51" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>zeta_sys<span class="classifier">complex</span></dt><dd><p>Incident in-plane wavevector</p>
</dd>
</dl>
</section>
<section id="id52">
<h4>Returns<a class="headerlink" href="#id52" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>r_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Complex <em>field</em> reflection coefficients (r_out=([rpp,rps,rss,rsp])).</p>
</dd>
<dt>R_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Real <em>intensity</em> reflection coefficients (R_out=([Rpp,Rss,Rsp,Tps])).</p>
</dd>
<dt>t_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Complex <em>field</em> transmission coefficients (t=([tpp, tps, tsp, tss])).</p>
</dd>
<dt>T_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Real <em>intensity</em> transmission coefficients (T_out=([Tp,Ts])) (mode-inselective).</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.ScatteringMatrixSystem.calculate_scattering_matrices">
<span class="sig-name descname"><span class="pre">calculate_scattering_matrices</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#ScatteringMatrixSystem.calculate_scattering_matrices"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.ScatteringMatrixSystem.calculate_scattering_matrices" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the scattering matrices in every layer.</p>
<p>Loop through all the layers calculating the scattering matrix of this layer with the next.
Care is taken when dealing with the superstrate and the substrate</p>
<section id="id53">
<h4>Parameters<a class="headerlink" href="#id53" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
<section id="id54">
<h4>Returns<a class="headerlink" href="#id54" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
<section id="note">
<h4>Note<a class="headerlink" href="#note" title="Permalink to this heading">#</a></h4>
<p>The scattering matrix is stored as an attribute
If the layer system is changed in anyway all the scattering matrices must be recomputed</p>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.SemiInfiniteLayer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">SemiInfiniteLayer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">theta</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">phi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">psi</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">exponent_threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">700</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#SemiInfiniteLayer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.SemiInfiniteLayer" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.CoherentLayer" title="PDielec.GTMcore.CoherentLayer"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a></p>
<p>Define a semi-infinite layer, inherits from CoherentLayer class.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.SemiInfiniteLayer.calculate_propagation_exponents">
<span class="sig-name descname"><span class="pre">calculate_propagation_exponents</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#SemiInfiniteLayer.calculate_propagation_exponents"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.SemiInfiniteLayer.calculate_propagation_exponents" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the propagation exponents.</p>
<p>For the semi-infinite case the propagation exponents are set to 0</p>
<section id="id55">
<h4>Parameters<a class="headerlink" href="#id55" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>The frequency (ignored for this object)</p>
</dd>
</dl>
</section>
<section id="id56">
<h4>Returns<a class="headerlink" href="#id56" title="Permalink to this heading">#</a></h4>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.SemiInfiniteLayer.calculate_propagation_matrix">
<span class="sig-name descname"><span class="pre">calculate_propagation_matrix</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#SemiInfiniteLayer.calculate_propagation_matrix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.SemiInfiniteLayer.calculate_propagation_matrix" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the matrix Ki (or Pi) depending on the paper.</p>
<p>This routine makes the material transparent. It is therefore suitable for
a semi-infinite layer.</p>
<section id="id57">
<h4>Parameters<a class="headerlink" href="#id57" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency</p>
</dd>
</dl>
</section>
<section id="id58">
<h4>Returns<a class="headerlink" href="#id58" title="Permalink to this heading">#</a></h4>
<p>Ki : tensor (3x3)</p>
</section>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.System">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">System</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superstrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System" title="Permalink to this definition">#</a></dt>
<dd><p>System class. An instance is an optical system with substrate, superstrate, and layers.</p>
<blockquote>
<div><p>Derived classes used by PDielec are:</p>
<blockquote>
<div><ul class="simple">
<li><p><a class="reference internal" href="#PDielec.GTMcore.TransferMatrixSystem" title="PDielec.GTMcore.TransferMatrixSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">TransferMatrixSystem</span></code></a></p></li>
<li><p><a class="reference internal" href="#PDielec.GTMcore.ScatteringMatrixSystem" title="PDielec.GTMcore.ScatteringMatrixSystem"><code class="xref py py-class docutils literal notranslate"><span class="pre">ScatteringMatrixSystem</span></code></a></p></li>
</ul>
</div></blockquote>
</div></blockquote>
<section id="id59">
<h4>Attributes<a class="headerlink" href="#id59" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>theta<span class="classifier">float</span></dt><dd><p>Angle of incidence, in radians.</p>
</dd>
<dt>substrate<span class="classifier">Layer</span></dt><dd><p>The substrate layer. Defaults to vacuum (an empty layer instance).</p>
</dd>
<dt>superstrate<span class="classifier">Layer</span></dt><dd><p>The superstrate layer, defaults to vacuum (an empty layer instance).</p>
</dd>
<dt>layers<span class="classifier">list of Layer</span></dt><dd><p>List of the layers in the system.</p>
</dd>
</dl>
</section>
<section id="id60">
<h4>Notes<a class="headerlink" href="#id60" title="Permalink to this heading">#</a></h4>
<p>Layers can be added and removed (not inserted).</p>
<p>The whole system’s transfer matrix is computed using <a class="reference internal" href="#PDielec.GTMcore.System.calculate_GammaStar" title="PDielec.GTMcore.System.calculate_GammaStar"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_GammaStar()</span></code></a>, which calls <code class="xref py py-func docutils literal notranslate"><span class="pre">Layer.update()</span></code> for each layer. General reflection and transmission coefficient functions are given; they require the prior execution of <a class="reference internal" href="#PDielec.GTMcore.System.calculate_GammaStar" title="PDielec.GTMcore.System.calculate_GammaStar"><code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_GammaStar()</span></code></a>. The electric fields can be visualized in the case of an incident plane wave using <code class="xref py py-func docutils literal notranslate"><span class="pre">calculate_Efield()</span></code>.</p>
<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.add_layer">
<span class="sig-name descname"><span class="pre">add_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">layer</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.add_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.add_layer" title="Permalink to this definition">#</a></dt>
<dd><p>Add a layer instance.</p>
<section id="id61">
<h5>Parameters<a class="headerlink" href="#id61" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>layer<span class="classifier">Layer</span></dt><dd><p>The layer to be added on the stack.</p>
</dd>
</dl>
</section>
<section id="id62">
<h5>Returns<a class="headerlink" href="#id62" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id63">
<h5>Notes<a class="headerlink" href="#id63" title="Permalink to this heading">#</a></h5>
<p>The layers are added in <em>from superstrate to substrate</em> order.
Light is incident <em>from the superstrate</em>.</p>
<p>Note that this function adds a reference to <cite>layer</cite> to the list.
If you are adding the same layer several times, be aware that if you
change something for one of them, it changes for all of them.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.calculate_GammaStar">
<span class="sig-name descname"><span class="pre">calculate_GammaStar</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zeta_sys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.calculate_GammaStar"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.calculate_GammaStar" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the whole system’s transfer matrix.</p>
<p>If one layer is incoherent then intensities rather than amplitudes are used</p>
<section id="id64">
<h5>Parameters<a class="headerlink" href="#id64" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency (Hz)</p>
</dd>
<dt>zeta_sys<span class="classifier">complex</span></dt><dd><p>In-plane wavevector kx/k0</p>
</dd>
</dl>
</section>
<section id="id65">
<h5>Returns<a class="headerlink" href="#id65" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>GammaStar<span class="classifier">complex ndarray</span></dt><dd><p>4x4 complex matrix representing the system transfer matrix <span class="math notranslate nohighlight">\(\Gamma^{*}\)</span></p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.calculate_r_t">
<span class="sig-name descname"><span class="pre">calculate_r_t</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">zeta_sys</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.calculate_r_t"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.calculate_r_t" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate various field and intensity reflection and transmission coefficients, as well as the 4-valued vector of transmitted field.</p>
<section id="id66">
<h5>Parameters<a class="headerlink" href="#id66" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>zeta_sys<span class="classifier">complex</span></dt><dd><p>Incident in-plane wavevector</p>
</dd>
</dl>
</section>
<section id="id67">
<h5>Returns<a class="headerlink" href="#id67" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>r_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Complex <em>field</em> reflection coefficients <cite>r_out=([rpp,rps,rss,rsp])</cite></p>
</dd>
<dt>R_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Real <em>intensity</em> reflection coefficients <cite>R_out=([Rpp,Rss,Rsp,Tps])</cite></p>
</dd>
<dt>t_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Complex <em>field</em> transmission coefficients <cite>t=([tpp, tps, tsp, tss])</cite></p>
</dd>
<dt>T_out<span class="classifier">array_like, shape (4,)</span></dt><dd><p>Real <em>intensity</em> transmission coefficients <cite>T_out=([Tp,Ts])</cite> (mode-inselective)</p>
</dd>
</dl>
</section>
<section id="id68">
<h5>Notes<a class="headerlink" href="#id68" title="Permalink to this heading">#</a></h5>
<p><strong>IMPORTANT</strong></p>
<ul class="simple">
<li><p>As of version 19-03-2020: All intensity coefficients are now well defined. Transmission is defined mode-independently. It could be defined mode-dependently for non-birefringent substrates in future versions. The new definition of this function <strong>BREAKS compatibility</strong> with the previous one.</p></li>
<li><p>As of version 13-09-2019: Note that the field reflectivity and transmission coefficients r and t are well defined. The intensity reflection coefficient is also correct. However, the intensity transmission coefficients T are ill-defined so far. This will be corrected upon future publication of the correct intensity coefficients.</p></li>
</ul>
<p>Note also the different ordering of the coefficients, for consistency with Passler’s matlab code.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.del_layer">
<span class="sig-name descname"><span class="pre">del_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.del_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.del_layer" title="Permalink to this definition">#</a></dt>
<dd><p>Remove a layer at given position. Does nothing for invalid position.</p>
<section id="id69">
<h5>Parameters<a class="headerlink" href="#id69" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>pos<span class="classifier">int</span></dt><dd><p>Index of layer to be removed.</p>
</dd>
</dl>
</section>
<section id="id70">
<h5>Returns<a class="headerlink" href="#id70" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.get_all_layers">
<span class="sig-name descname"><span class="pre">get_all_layers</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.get_all_layers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.get_all_layers" title="Permalink to this definition">#</a></dt>
<dd><p>Return the list of all layers in the system.</p>
<section id="id71">
<h5>Returns<a class="headerlink" href="#id71" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>self.layers<span class="classifier">list</span></dt><dd><p>A list of all layers.</p>
</dd>
</dl>
</section>
<section id="id72">
<h5>Returns<a class="headerlink" href="#id72" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.get_layer">
<span class="sig-name descname"><span class="pre">get_layer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">pos</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.get_layer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.get_layer" title="Permalink to this definition">#</a></dt>
<dd><p>Get the layer at a given position.</p>
<section id="id73">
<h5>Parameters<a class="headerlink" href="#id73" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>pos<span class="classifier">int</span></dt><dd><p>Position in the stack.</p>
</dd>
</dl>
</section>
<section id="id74">
<h5>Returns<a class="headerlink" href="#id74" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>self.layers[pos]<span class="classifier">Layer</span></dt><dd><p>The layer at the position <cite>pos</cite>.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.get_substrate">
<span class="sig-name descname"><span class="pre">get_substrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.get_substrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.get_substrate" title="Permalink to this definition">#</a></dt>
<dd><p>Return the System’s substrate.</p>
<section id="id75">
<h5>Parameters<a class="headerlink" href="#id75" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id76">
<h5>Returns<a class="headerlink" href="#id76" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>self.substrate<span class="classifier">Layer</span></dt><dd><p>The system substrate.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.get_superstrate">
<span class="sig-name descname"><span class="pre">get_superstrate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.get_superstrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.get_superstrate" title="Permalink to this definition">#</a></dt>
<dd><p>Return the System’s superstrate.</p>
<section id="id77">
<h5>Parameters<a class="headerlink" href="#id77" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id78">
<h5>Returns<a class="headerlink" href="#id78" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>self.superstrate<span class="classifier">Layer</span></dt><dd><p>The system superstrate.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.initialize_sys">
<span class="sig-name descname"><span class="pre">initialize_sys</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.initialize_sys"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.initialize_sys" title="Permalink to this definition">#</a></dt>
<dd><p>Set the values of epsilon at the given frequency in all the layers.</p>
<section id="id79">
<h5>Parameters<a class="headerlink" href="#id79" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>f<span class="classifier">float</span></dt><dd><p>Frequency (Hz)</p>
</dd>
</dl>
</section>
<section id="id80">
<h5>Returns<a class="headerlink" href="#id80" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id81">
<h5>Notes<a class="headerlink" href="#id81" title="Permalink to this heading">#</a></h5>
<p>This function allows to define the in-plane wavevector (<span class="math notranslate nohighlight">\(zeta\)</span>)
outside of the class, and thus to explore also guided modes of the system.</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.overflowErrors">
<span class="sig-name descname"><span class="pre">overflowErrors</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.overflowErrors"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.overflowErrors" title="Permalink to this definition">#</a></dt>
<dd><p>Return the total number of overflow errors encountered.</p>
<section id="id82">
<h5>Parameters<a class="headerlink" href="#id82" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
<section id="id83">
<h5>Returns<a class="headerlink" href="#id83" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>int</dt><dd><p>The total number of overflow errors encountered.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.set_substrate">
<span class="sig-name descname"><span class="pre">set_substrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sub</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.set_substrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.set_substrate" title="Permalink to this definition">#</a></dt>
<dd><p>Set the substrate.</p>
<section id="id84">
<h5>Parameters<a class="headerlink" href="#id84" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>sub<span class="classifier">Layer</span></dt><dd><p>Instance of the Layer class, serving as the substrate.</p>
</dd>
</dl>
</section>
<section id="id85">
<h5>Returns<a class="headerlink" href="#id85" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="PDielec.GTMcore.System.set_superstrate">
<span class="sig-name descname"><span class="pre">set_superstrate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sup</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#System.set_superstrate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.System.set_superstrate" title="Permalink to this definition">#</a></dt>
<dd><p>Set the superstrate.</p>
<section id="id86">
<h5>Parameters<a class="headerlink" href="#id86" title="Permalink to this heading">#</a></h5>
<dl class="simple">
<dt>sup<span class="classifier">Layer</span></dt><dd><p>Instance of the layer class, superstrate</p>
</dd>
</dl>
</section>
<section id="id87">
<h5>Returns<a class="headerlink" href="#id87" title="Permalink to this heading">#</a></h5>
<p>None</p>
</section>
</dd></dl>

</section>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="PDielec.GTMcore.TransferMatrixSystem">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">TransferMatrixSystem</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">substrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">superstrate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#TransferMatrixSystem"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.TransferMatrixSystem" title="Permalink to this definition">#</a></dt>
<dd><p>Bases: <a class="reference internal" href="#PDielec.GTMcore.System" title="PDielec.GTMcore.System"><code class="xref py py-obj docutils literal notranslate"><span class="pre">System</span></code></a></p>
<p>Define a system of layers which is described by a Transfer Matrix method.</p>
<p>This is basically a place holder for the original pyGTM methods and it is used
to distinguish itself from a system which uses the scattering matrix method</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PDielec.GTMcore.exact_inv_2x2">
<span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">exact_inv_2x2</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#exact_inv_2x2"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.exact_inv_2x2" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the inverse of 2x2 complex matrix, M.</p>
<section id="id88">
<h4>Parameters<a class="headerlink" href="#id88" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>M<span class="classifier">complex 2x2 array</span></dt><dd><p>The matrix of which to find the inverse.</p>
</dd>
</dl>
</section>
<section id="id89">
<h4>Returns<a class="headerlink" href="#id89" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>ndarray</dt><dd><p>The inverse of M as a 2x2 complex numpy array.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PDielec.GTMcore.exact_inv_3x3">
<span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">exact_inv_3x3</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#exact_inv_3x3"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.exact_inv_3x3" title="Permalink to this definition">#</a></dt>
<dd><p>Calculate the inverse of a 3x3 complex matrix M.</p>
<section id="id90">
<h4>Parameters<a class="headerlink" href="#id90" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>M<span class="classifier">complex 3x3 array</span></dt><dd><p>The matrix to be inverted.</p>
</dd>
</dl>
</section>
<section id="id91">
<h4>Returns<a class="headerlink" href="#id91" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>numpy.ndarray</dt><dd><p>The inverse of M as a 3x3 complex numpy array.</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PDielec.GTMcore.exact_inv_4x4">
<span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">exact_inv_4x4</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">M</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#exact_inv_4x4"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.exact_inv_4x4" title="Permalink to this definition">#</a></dt>
<dd><p>Compute the ‘exact’ inverse of a 4x4 matrix using the analytical result.</p>
<section id="id92">
<h4>Parameters<a class="headerlink" href="#id92" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>M<span class="classifier">array-like, shape (4, 4)</span></dt><dd><p>Matrix to be inverted, consisting of float or complex numbers.</p>
</dd>
</dl>
</section>
<section id="id93">
<h4>Returns<a class="headerlink" href="#id93" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>array-like, shape (4, 4), complex</dt><dd><p>Inverse of this matrix or Moore-Penrose approximation if matrix cannot be inverted.</p>
</dd>
</dl>
</section>
<section id="id94">
<h4>Notes<a class="headerlink" href="#id94" title="Permalink to this heading">#</a></h4>
<p>This should give a higher precision and speed at a reduced noise, following D.Dietze’s implementation in FSRStools. Modified to work with clongdouble by JK.</p>
</section>
<section id="see-also">
<h4>See Also<a class="headerlink" href="#see-also" title="Permalink to this heading">#</a></h4>
<p><a class="reference external" href="http://www.cg.info.hiroshima-cu.ac.jp/~miyazaki/knowledge/teche23.html">http://www.cg.info.hiroshima-cu.ac.jp/~miyazaki/knowledge/teche23.html</a> : For mathematical background related to this computation.</p>
</section>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="PDielec.GTMcore.vacuum_eps">
<span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">vacuum_eps</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">f</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/PDielec/GTMcore.html#vacuum_eps"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#PDielec.GTMcore.vacuum_eps" title="Permalink to this definition">#</a></dt>
<dd><p>Vacuum permittivity function.</p>
<section id="id95">
<h4>Parameters<a class="headerlink" href="#id95" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>f<span class="classifier">float or 1D-array</span></dt><dd><p>Frequency (in Hz)</p>
</dd>
</dl>
</section>
<section id="id96">
<h4>Returns<a class="headerlink" href="#id96" title="Permalink to this heading">#</a></h4>
<dl class="simple">
<dt>eps<span class="classifier">complex or 1D-array of complex</span></dt><dd><p>Complex value of the vacuum permittivity (1.0 + 0.0j)</p>
</dd>
</dl>
</section>
</dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="PDielec.GTMcore.c_const">
<span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">c_const</span></span><a class="headerlink" href="#PDielec.GTMcore.c_const" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

<dl class="py data">
<dt class="sig sig-object py" id="PDielec.GTMcore.eps0">
<span class="sig-prename descclassname"><span class="pre">PDielec.GTMcore.</span></span><span class="sig-name descname"><span class="pre">eps0</span></span><a class="headerlink" href="#PDielec.GTMcore.eps0" title="Permalink to this definition">#</a></dt>
<dd></dd></dl>

</section>
</section>
</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          <a class="next-page" href="../GenericOutputReader/index.html">
              <div class="page-info">
                <div class="context">
                  <span>Next</span>
                </div>
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GenericOutputReader</span></code></div>
              </div>
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
            </a>
          <a class="prev-page" href="../ExperimentOutputReader/index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.ExperimentOutputReader</span></code></div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2024, John Kendrick and Andrew Burnett
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#"><code class="xref py py-mod docutils literal notranslate"><span class="pre">PDielec.GTMcore</span></code></a><ul>
<li><a class="reference internal" href="#module-contents">Module Contents</a><ul>
<li><a class="reference internal" href="#classes">Classes</a></li>
<li><a class="reference internal" href="#functions">Functions</a></li>
<li><a class="reference internal" href="#attributes">Attributes</a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.CoherentLayer"><code class="docutils literal notranslate"><span class="pre">CoherentLayer</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.CoherentLayer.calculate_scattering_matrix"><code class="docutils literal notranslate"><span class="pre">CoherentLayer.calculate_scattering_matrix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentAveragePhaseLayer"><code class="docutils literal notranslate"><span class="pre">IncoherentAveragePhaseLayer</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentAveragePhaseLayer.calculate_propagation_exponents"><code class="docutils literal notranslate"><span class="pre">IncoherentAveragePhaseLayer.calculate_propagation_exponents()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentIntensityLayer"><code class="docutils literal notranslate"><span class="pre">IncoherentIntensityLayer</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentPhaseLayer"><code class="docutils literal notranslate"><span class="pre">IncoherentPhaseLayer</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentPhaseLayer.calculate_propagation_exponents"><code class="docutils literal notranslate"><span class="pre">IncoherentPhaseLayer.calculate_propagation_exponents()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentThickLayer"><code class="docutils literal notranslate"><span class="pre">IncoherentThickLayer</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentThickLayer.calculate_propagation_matrix"><code class="docutils literal notranslate"><span class="pre">IncoherentThickLayer.calculate_propagation_matrix()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.IncoherentThickLayer.calculate_scattering_matrix"><code class="docutils literal notranslate"><span class="pre">IncoherentThickLayer.calculate_scattering_matrix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer"><code class="docutils literal notranslate"><span class="pre">Layer</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.jk_shift"><code class="docutils literal notranslate"><span class="pre">Layer.jk_shift</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.qsd_thr"><code class="docutils literal notranslate"><span class="pre">Layer.qsd_thr</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.zero_thr"><code class="docutils literal notranslate"><span class="pre">Layer.zero_thr</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_ai"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_ai()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_epsilon"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_epsilon()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_gamma"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_gamma()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_matrices"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_matrices()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_propagation_exponents"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_propagation_exponents()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_propagation_matrix"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_propagation_matrix()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_q"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_q()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.calculate_transfer_matrix"><code class="docutils literal notranslate"><span class="pre">Layer.calculate_transfer_matrix()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.isCoherent"><code class="docutils literal notranslate"><span class="pre">Layer.isCoherent()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.set_epsilon"><code class="docutils literal notranslate"><span class="pre">Layer.set_epsilon()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.set_euler"><code class="docutils literal notranslate"><span class="pre">Layer.set_euler()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.set_thickness"><code class="docutils literal notranslate"><span class="pre">Layer.set_thickness()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.update_sm"><code class="docutils literal notranslate"><span class="pre">Layer.update_sm()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.Layer.update_tm"><code class="docutils literal notranslate"><span class="pre">Layer.update_tm()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.SMatrix"><code class="docutils literal notranslate"><span class="pre">SMatrix</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.SMatrix.calculateS"><code class="docutils literal notranslate"><span class="pre">SMatrix.calculateS()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.SMatrix.redheffer"><code class="docutils literal notranslate"><span class="pre">SMatrix.redheffer()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.SMatrix.unitMatrix"><code class="docutils literal notranslate"><span class="pre">SMatrix.unitMatrix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.ScatteringMatrixSystem"><code class="docutils literal notranslate"><span class="pre">ScatteringMatrixSystem</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.ScatteringMatrixSystem.calculate_GammaStar"><code class="docutils literal notranslate"><span class="pre">ScatteringMatrixSystem.calculate_GammaStar()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.ScatteringMatrixSystem.calculate_r_t"><code class="docutils literal notranslate"><span class="pre">ScatteringMatrixSystem.calculate_r_t()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.ScatteringMatrixSystem.calculate_scattering_matrices"><code class="docutils literal notranslate"><span class="pre">ScatteringMatrixSystem.calculate_scattering_matrices()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.SemiInfiniteLayer"><code class="docutils literal notranslate"><span class="pre">SemiInfiniteLayer</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.SemiInfiniteLayer.calculate_propagation_exponents"><code class="docutils literal notranslate"><span class="pre">SemiInfiniteLayer.calculate_propagation_exponents()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.SemiInfiniteLayer.calculate_propagation_matrix"><code class="docutils literal notranslate"><span class="pre">SemiInfiniteLayer.calculate_propagation_matrix()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.System"><code class="docutils literal notranslate"><span class="pre">System</span></code></a><ul>
<li><a class="reference internal" href="#PDielec.GTMcore.System.add_layer"><code class="docutils literal notranslate"><span class="pre">System.add_layer()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.calculate_GammaStar"><code class="docutils literal notranslate"><span class="pre">System.calculate_GammaStar()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.calculate_r_t"><code class="docutils literal notranslate"><span class="pre">System.calculate_r_t()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.del_layer"><code class="docutils literal notranslate"><span class="pre">System.del_layer()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.get_all_layers"><code class="docutils literal notranslate"><span class="pre">System.get_all_layers()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.get_layer"><code class="docutils literal notranslate"><span class="pre">System.get_layer()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.get_substrate"><code class="docutils literal notranslate"><span class="pre">System.get_substrate()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.get_superstrate"><code class="docutils literal notranslate"><span class="pre">System.get_superstrate()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.initialize_sys"><code class="docutils literal notranslate"><span class="pre">System.initialize_sys()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.overflowErrors"><code class="docutils literal notranslate"><span class="pre">System.overflowErrors()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.set_substrate"><code class="docutils literal notranslate"><span class="pre">System.set_substrate()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.System.set_superstrate"><code class="docutils literal notranslate"><span class="pre">System.set_superstrate()</span></code></a></li>
</ul>
</li>
<li><a class="reference internal" href="#PDielec.GTMcore.TransferMatrixSystem"><code class="docutils literal notranslate"><span class="pre">TransferMatrixSystem</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.exact_inv_2x2"><code class="docutils literal notranslate"><span class="pre">exact_inv_2x2()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.exact_inv_3x3"><code class="docutils literal notranslate"><span class="pre">exact_inv_3x3()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.exact_inv_4x4"><code class="docutils literal notranslate"><span class="pre">exact_inv_4x4()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.vacuum_eps"><code class="docutils literal notranslate"><span class="pre">vacuum_eps()</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.c_const"><code class="docutils literal notranslate"><span class="pre">c_const</span></code></a></li>
<li><a class="reference internal" href="#PDielec.GTMcore.eps0"><code class="docutils literal notranslate"><span class="pre">eps0</span></code></a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js?v=9234fd31"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=4825356b"></script>
    <script src="../../../_static/scripts/furo.js?v=32e29ea5"></script>
    <script type="text/x-mathjax-config">MathJax.Hub.Config({"extensions": ["AMSmath.js"], "TeX": {"Macros": {"tensor": ["{\\bar{\\bar{#1}}}", 1], "tensorbs": ["{\\bar{\\bar{\\boldsymbol{#1}}}}", 1], "tensorbf": ["{\\bar{\\bar{\\boldsymbol{#1}}}}", 1], "fieldbf": ["{\\bar{\\boldsymbol{#1}}}", 1], "water": "\\H_{2}O"}}})</script>
    <script async="async" src="https://cdn.jsdelivr.net/npm/mathjax@2/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    </body>
</html>